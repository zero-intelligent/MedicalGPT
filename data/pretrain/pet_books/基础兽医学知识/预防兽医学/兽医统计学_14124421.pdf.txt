兽医统计学
SHOUYI TONGJI XUE
孙向东王幼明主编
宇传华黄保续主审
中国农业出版社
兽医统计学
孙向东王幼明主编
宇传华黄保续主审
中国农业出版社
图书在版编目（CIP）数据
兽医统计学/孙向东，王幼明主编，一北京：中
国农业出版社，2015.7
ISBN978-7-109-20694-6
I.①兽.·Ⅱ.①孙②王·Ⅲ.①家畜卫生-卫
生统计IV.①S851.67
中国版本图书馆CIP数据核字（2015）第163892号
中国农业出版社出版
（北京市朝阳区麦子店街18号楼）
（邮政编码100125）
责任编辑邱利伟神翠翠
文字编辑赵淑新
北京中兴印刷有限公司印刷
新华书店北京发行所发行
2016年3月第1版
2016年3月北京第1次印刷
开本：720mm×960mm1/16印张：22
字数：360千字
定价：65.00元
（凡本版图书出现印刷、装订错误，请向出版社发行部调换）
编委会
主编：孙向东王幼明
主审：宇传华黄保续
参编人员（以姓名笔画为序）：
于丽萍王震坤韦欣捷刘爱玲刘丽荣李妍李金花李印
沈朝建杨吉星张毅贾智宁洪希成姚雪梅赵雯徐全刚
康京丽崔芳芳章亚男曾倩鲍俊哲廖祺潘涛
前言
本书是对应用于兽医实验室数据分析和兽医流行病学中统计学方法的概述。
统计学厂泛应用于多个领域，是进行数据分析的重要工具。然而，我国当前兽
医工作者，特别是工作在动物疫病防控领域的学者，对于统计学方法的运用水
平还有待提高。为了提高工作在动物疫病防控第一线的广大技术人员统计学运
用水平，根据农业部兽医局领导的安排，针对目前统计学应用的现状编写本书。
本书的目标读者群是工作在动物疫病检测实验室的技术人员和进行流行病
学调查与分析的工作人员。撰写本书前，编者进行了需求调研，在内容的设计
上，充分考虑了当前兽医工作者对于统计学工具和方法的实际需求。对难度较
大的和不常用的统计学方法，本书并未进行阐述，读者如果希望进行更深入的
学习和研究，可以参照其他统计学书籍。
为了便于读者学习相关统计学知识，编者通过实际例子引出问题，并逐步展开
阐述，将原理性内容和有关公式放在后面。这么做的目的，一是希望能够使读者以
实际问题为导向进行理解和学习；二是希望能够由浅人深，引导读者逐步领会统计
学方法；三是希望读者不要刚开始阅读本书就产生为难情绪，能够坚持将本书读完。
本书共包含18章内容，包括统计学术语总体介绍（第一章）、基本统计学方
研究设计技术（第十六章、第十七章）和诊断试验评价（第十八章）本书中所
用的例子，除个别是为了说明问题而人为设计数据外，绝大部分都是实际工作
中的实例。坚持用实际例子说明问题是编者设计本书的初衷。
本书在编写过程中得到很多人的支持。在需求调研阶段和初稿完成后很多
人提出了宝贵意见，特别是陈继明博士和韩雪博士提出了很好的意见，再次表
示诚挚的感谢！
本书的编写由孙向东和王幼明总体设计，宇传华和黄保续总体审校。由于
作者水平有限，书中难免有不妥之处，敬请读者给予批评指正。
孙向东
2015年5月
目录
contents
前言
绪论
第一节
兽医统计学与学习要求
3
第一章
第二节
兽医统计学的常用术语
4
Chapter1
第三节
兽医统计学的基本步骤
9
第四节
统计分析方法概述
12
资料的统计描述
17
第一节
资料的采集
19
第二章
第二节
定量资料描述
30
Chapter2
第三节
定性资料描述
34
第四节
参考值范围的确定
41
统计表与统计图
45
第三章
第一节常用统计表
48
Chapter3
第二节常用统计图
53
变量的分布及应用
61
第一节正态分布
63
第四章
第二节
二项分布
66
Chapter4
第三节Poisson分布
70
第四节
负二项分布
73
2
兽医统计学
总体均数的估计及假设检验
77
第一节抽样误差与标准误
79
第五章
第二节t分布
80
Chapter5
第三节
总体均数的估计
82
第四节
假设检验概述
86
检验
93
第一节
检验的应用条件
95
第六章
第二节
单样本检验
95
Chapter6
第三节
两独立样本资料的检验
96
第四节
配对资料的检验
99
方差分析
103
第一节
方差分析的基本思想及应用条件
105
第二节
两样本方差齐性的F检验
108
第三节
完全随机设计资料的方差分析
109
第七章
第四节
随机区组设计资料的方差分析
110
Chapter7
第五节
析因设计资料的方差分析
113
第六节
重复测量资料的方差分析
116
第七节
多样本均数间的比较
119
第八节
多样本方差比较
120
卡方检验
123
第一节
卡方检验的原理
125
第八章
第二节
四格表资料的卡方检验
127
Chapter8
第三节
RxC列联表的卡方检验
134
第四节
Fisher确切概率检验
137
目录
3
非参数检验
139
第一节配对样本的Wilcoxon符号秩检验
141
第九章
第二节两个独立样本的Wilcoxon秩和检验
144
Chapter9
第三节
完全随机设计多个样本比较的
Kruskal-WallisH检验
147
简单相关与回归
151
第一节
直线相关
153
第十章
第二节
直线回归
157
Chapter 10
第三节
Spearman等级相关
166
第四节
曲线回归
170
多重回归
177
第一节
多重线性回归
179
第十一章
第二节
自变量的选择
183
Chapter 11
第三节
多重线性回归的应用与注意事项
185
第四节
Logistic回归
190
第五节
Logistic回归的应用与注意事项
196
判别分析
199
第一节
判别分析的基本思想
201
第二节
Fisher判别
203
第十二章
Chapter 12
第三节
Bayes判别
207
第四节
逐步判别
210
第五节
判别分析中应注意的问题
213
4
兽医统计学
聚类分析
215
第一节
聚类分析基本思想
216
第十三章
第二节
相似系数
217
Chapter13
第三节
系统聚类
219
第四节
注意事项
232
主成分与因子分析
233
第一节
主成分分析
235
第二节
主成分分析的数学模型
236
第三节
主成分分析的求法及性质
236
第四节
主成分分析的应用
241
第十四章
第五节
因子分析的基本思想
241
Chapter14
第六节
因子分析数学模型
242
第七节
因子分析的性质
243
第八节
因子载荷的求解
244
第九节
因子旋转
248
第十节
因子分析注意事项
250
时间序列分析
253
第一节
时间序列分析概述
255
第十五章
Chapter15
第二节
指数平滑法
256
第三节
ARIMA模型
261
抽样调查
273
第一节
抽样调查概述
275
第十六章
第二节
抽样方法
277
Chapter16
第三节
样本量估算
284
第四节
案例分析和示范
288
目录
5
研究设计
297
第十七章
第一节观察性研究设计
298
Chapter17
第二节实验研究设计
307
诊断试验评价与ROC分析
315
第十八章
第一节常用的诊断试验评价指标
316
Chapter18
第二节ROC曲线
326
名词术语
332
参考文献
335
第一章
绪论
2兽医统计学
【例1-1】
为研究中药对奶牛乳房炎的治疗作用，从中随机抽取65头临床型乳房
炎患牛进行实验。将抽到的牛随机分为2组，试验组奶牛用中药复方治疗，
对照组用青霉素和链霉素治疗，观察临床效果。结果中药复方治疗患牛32
例，治愈27例，治愈率为84.3%；对照组治疗33例，治愈26例，治愈率为
78.8%。据此认为用中药治疗奶牛乳房炎的疗效高于西药；将相关资料及结
论撰写成文，投稿至某杂志编辑部，但被拒，理由是该文未经统计学处理。
【问题1-1】
（1）上表中的资料属于何种类型？
（2）该试验属于何种设计方案？
（3）为何杂志编辑部编辑要求用统计学处理该资料？
（4）该资料需要用何种统计学方法处理？
【分析】
（1）研究的结果分为治愈和未治愈两种，属于二分类定性资料；
（2）实验采用随机抽样和随机分组，属于完全随机实验设计；
（3）研究总体是所有临床型乳房炎患牛，而研究对象是65头临床型乳
房炎患牛，使研究结果不可避免地存在抽样误差，故需要作统计学处理；
（4）根据资料的类型及其设计方案，应采用四格表X检验。
该资料在统计描述的基础上，运用SPSS软件进行四格表X检验。结果
p>0.05，差异无统计学意义，说明用中药复方治疗奶牛乳房炎与常用抗生素
的治疗效果基本相同。虽然试验结果显示差异无统计学意义，但是由于中
药成本较低、副作用较小且使奶牛乳汁无药物残留等优点，其仍具有很大
的推广价值；经统计分析后的论文很快就被录用。如果没有统计学的帮忙，
不仅会使精心撰写的论文失去发表、交流的机会，还可能导致辛苦的研究
工作得不到相应的价值体现。
第一章绪论3
第一节兽医统计学与学习要求
一、兽医统计学
统计学（statistics）是在相对有限的样本数据上，对特定的随机现象作推
断的学科。统计学的范围可分为两个主要的领域：数理统计学和应用统计学。
数理统计学更关注统计推断中新方法的发展，同时需要运用多种数学工具。应
用统计学则把数理统计学方法应用到特定的领域，比如经济学、心理学、公共
卫生及动物卫生等。
兽医学（veterinarymedicine）是一门研究预防和治疗畜禽疫病的科学。
家畜、家禽、伴随动物（如犬、猫等）经济野生动物、实验动物、观赏动物、
经济昆虫（如蜜蜂、蚕等）和鱼类的保健和疫病防治工作均属兽医学范畴。
通过上述统计学和兽医学的概念，可界定出兽医统计学的基本定义：兽医
统计学（veterinarystatistics）作为应用统计学的分支，是一门运用统计学的
原理和方法，进行兽医学科学研究与临床实践中有关数据的搜集、整理、分析
和推断的应用科学。它通过对偶然性（不确定性）剖析、研究，发现事物的必
然性（确定性），并用以指导兽医学的理论和实践。
兽医统计学作为一门科学，不论从执行统计方法的角度，还是进行科学研
究的角度，必须如实地反映现状。科学研究的目的在于得到真实、可靠的结果，
这也是兽医统计学的求实性。兽医统计学必须在统计理论的指导下，正确运用
统计学思维，针对数据特点，巧妙地选用恰当、高效的统计分析方法，从而得
到可靠的结果和科学的结论。
4
兽医统计学
二、学习要求
统计学方法很多，对每一种方法的学习要求可以概括为如下三个要点：
（1）这个统计学方法是什么？即需要掌握该法的基本思想、原理和有关
概念；
（2）这个统计学方法是怎么来的？即需要初步了解该法的具体证明方法和
推导过程；
（3）这个统计学方法能够用来干什么？即需要掌握该法的相关用途和适用
条件。
数学基础较为薄弱的基层兽医工作者不大可能也没有必要对每一种统计学
方法的证明推导、来龙去脉都一一深入学习。所以学习重点应放在1和3上。对
于绝大多数学习兽医统计学的有关人员，在经过一定的统计学培训后，能知晓
统计学的术语、懂得运用各类统计学方法为自身服务，并能看懂、理解和正确
解释统计学的结果，那就达到了本书的学习要求。
第二节兽医统计学的常用术语
一、总体与样本
任何统计研究都必须先确定观察单位（observedunit），亦称研究单位
（studyunit）。观察单位是统计研究中最基本的单位，可以是一个人，一头动
物，也可以是某一特定的动物群体；还可以是一个器官、一个细胞、一个采样
点等。
总体（population）是根据研究目的而确定的同质观察单位的全体，也就
第一章绪论5
是性质相同的研究对象中所有观察单位某种变量值的集合。例如研究某奶牛场
2013年成年母牛的血压值，则研究对象是该奶牛场该年的所有成年母牛，观察
单位是母牛个体，变量是血压，变量值是测得的血压值，该奶牛场2013年全部
成年母牛的血压值构成一个总体。它的同质基础是同一地区，同一年份，同为
成年母牛。这里的总体只包括有限个观察单位，称为有限总体。有时总体是设
想的，如研究某新型抗生素对奶牛乳房炎的治疗效果，这里总体同质基础是同
为患乳房炎的病牛，同用某新型抗生素治疗，包括设想用该抗生素治疗的所有
患乳房炎的病牛，其观察单位数显然是不确定的、无限的，称为无限总体。
正常情形下，为节省人力、物力、财力和时间，许多医学研究都采取从
总体中抽取样本（sample），根据样本信息来推断总体特征的方法，即运用抽
样研究（samplingresearch）的方法来实现，这种从总体中抽取部分观察单位
的过程称为抽样（sampling）。为保证样本的代表性，抽样时，必须遵循随机
（randomization）原则，因而从总体中随机抽得的部分观察单位，其实测值的集
合，就称为样本（sample）。该样本中所包含的观察单位数称为该样本的样本
量（samplesizes）。如上例，可从某奶牛场2013年成年母牛中，随机抽取100头
成年母牛，逐个进行血压测量，得到100头成年母牛的血压测量值，组成样本；
也可从就诊的患乳房炎的病牛中，随机抽取100名头病牛，并观察该新型抗生素
治疗前和治疗一段时期后的病情变化。例如，实验室诊断的体细胞计数变化，
组成反映治疗结果的样本。应当强调，获取样本仅仅是手段，而通过样本信息
来推断总体特征才是研究的目的。
二、变量与资料
确定总体之后，应对每个观察单位的某项特征进行测量和观察，这种特征，
能表现观察单位的变异性，称为变量（variable）。对变量的测得值称为变量值
（valueofvariable）或观察值（observedvalue），由变量值构成资料（data）。例
如，以人为观察单位调查某牧区某年7岁正常儿童的生长发育状况，性别、身
高、体重等都可视为变量，性别有男有女，身高可高可矮，体重可轻可重，不
6兽医统计学
同个体不尽相同，这种个体间的差异称为变异。这些变异来源于一些已知的或
未知的，甚至是某些不可控制的因素所导致的随机误差。变量的观察结果可以
是定量的，例如身高（厘米）；也可以是定性的，例如性别（男或女）。按变量
的值是定量的、还是定性的，可将变量分为以下几种类型：
1.定量资料（quantitativedata）又称定量资料（measurementdata）或
数值变量资料（numericalvariable）。是为测定每个观察单位某项指标的大小而
获得的资料。其变量值是定量的，表现为数值大小，一般有度量衡单位。如调
查某养殖场某年成年肉牛的生长发育状况，以个体为观察单位，肉牛的胸围
（cm）、体重（kg）、血压（kPa）等资料均属此类资料。
2.定性资料（qualitativedata）又称计数资料或无序分类资料。为将观
察单位按某种属性或类别分组计数，分组汇总各组观察单位数后而得到的资料。
其变量值是定性的，表现为互不相容的属性或类别，如试验结果的阳性、阴性，
某症状的有、无等。分两种情形：
（1）二分类：如检查某养殖场猪仔粪便中的虫，以每只猪仔为观察单位，
结果可报告为猪虫卵阴性或阳性两类；如观察某药治疗某病畜的疗效，以每头
病畜为观察单位，结果可归纳为治愈与未愈两类。两类间相互对立，互不相容
（2）多分类：如口蹄疫病毒目前有O、A、C、SAT1、SAT2、SAT3（即南
非1、2、3型）和Asia1（亚洲1型）7个血清型。
3.等级资料（rankeddata）又称半定量资料或有序分类资料。为将观察
单位按某种属性的不同程度分成等级后分组计数，分类汇总各组观察单位数后
而得到的资料。其变量值具有半定量性质，表现为等级大小或属性程度。如观
察禽类某血清反应，以每只禽类为观察单位，根据反应强度，结果可分一、±、
十、十十、+++、++++六级；又如观察用某药治疗某病畜的疗效，以每头病畜为
观察单位，结果可分为治愈、显效、好转、无效四级等。
统计分析方法的选用与资料类型密切联系。在资料分析过程中，在有关专
业理论指导下，各类资料间可以互相转化，以满足不同统计分析方法的要求。
例如，以人为观察单位观察某人群脉搏数（次/min），属定量资料；若根据医学
专业理论，定义脉搏数在60～100次/min为正常，<60次/min或>100次/min为异
第一章绪论7
常，按“正常”与“异常”两种属性进行分类，此时资料就转化为定性资料；
若进一步定义脉搏数<60次/min为缓脉，>100次/min为速脉，按“缓脉”、“正
常”与“速脉”三个等级进行分类，此时的资料就是等级资料。以上的例子是
先获取定量资料，再将定量资料转化为定性资料或等级资料。在专业理论的支
持下，确定不同属性或不同等级的数量界限，这种转化是不难实现的。在研究
设计中，对于能测量的指标，应尽可能设计为定量指标，这将为分析中的资料
转化带来了方便。相反，定性资料是不能逆转化成等级资料或定量资料的。所
以我们在收集资料时能定量应尽可能定量，定量资料所含有的信息量大于等级
资料，等级资料所含有的信息量大于定性资料。
三、误差
误差（error）泛指实测值与真值之差。按其产生原因和性质可粗分为随
机误差（randomerror）与非随机误差（nonrandomerror）两大类，后者文可分
为系统误差（systematicerror）与非系统误差（nonsystematicerror）两类。
1.随机误差是一类由多种无法控制的因素引起的、不恒定的、随机变化
的误差。例如，在实验过程中，在同一条件下对同一对象反复进行测量，虽极
力控制或消除系统误差后，每次测量结果仍会出现一些随机变化，即出现了随
机测量误差（randomerrorofmeasurement）。在抽样过程中由于抽样的偶然性而
出现的抽样误差（samplingerror）也是随机误差。
随机误差是不可避免的，在大量重复测量中，它可出现或大或小、或正或
负，呈一定规律性的变化。由于造成随机误差的影响因素太多太复杂，其具体
规律难以掌握，但随机误差呈正态分布，可用统计学的方法进行分析。
2.系统误差是实验过程中产生的误差，它的值恒定不变，或遵循一定的
变化规律，其产生原因往往是可知的或可能掌握的。这种误差一是可能来自于
受试者抽样不均匀，分配不随机；二是可能来自于不同实验者个人感觉或操作
上的差异；三是可能来自于不标准的仪器；四是可能来自于外环境非实验因素
的不平衡等。在实际工作中应尽可能设法预见到各种系统误差的具体来源，力
8兽医统计学
求通过周密的研究设计和严格的技术措施加以消除或控制。
3.非系统误差在实验过程中由研究者偶然失误而造成的误差。例如，仪
器失灵、抄错数字、点错小数点、写错单位等。这类误差应当通过认真检查核
对予以清除，否则将会影响研究结果的准确性。
四、参数和统计量
统计学中把总体的指标称为参数（parameter）。例如，正态分布有两个参
数，即总体均数和方差。一且知道这两个参数值，就了解了相应的正态分布。
通过观察样本中的个体，可以获得样本均数。这种由观察资料计算出来的量称
为统计量（statistic）。如研究某养鸡场成年母鸡的平均体重，并从中抽取100只
成年母鸡进行测量，所得的样本平均数即为统计量，用样本均数这个统计量来
近似地反映总体均数这个参数。统计学常常关注的是总体参数的大小，其依据
是统计量及其性质。
五、概率与频率
概率（probability）是描述随机事件发生可能性大小的取值，常用P表示。
随机事件概率的大小在0与1之间。P越接近1，表示某事件发生的可能性越大；P
越接近0，表示某事件发生的可能性越小。习惯上将P≤0.05的事件称为小概率事
件，表示在一次实验或观察中该事件发生的可能性很小，可视为不发生。在实际
工作中，当概率不易求得时，只要观察单位数足够多，可将频率作为概率的估计
值。但在观察单位数较少时，频率的波动性很大，用于估计概率是不可靠的。
二个随机试验有儿种可能结果，在重复进行试验时，个别结果看来是偶然
发生的，但当重复试验次数相当大时，总有某种规律性出现。例如，投掷一枚
硬币，试验结果为“正面”或“反面”虽不能事先断定，但试验的所有可能结
果只有两种。在重复多次后，出现“正面”（或“反面”）这个结果的比例称之
为频率（relativefrequency）
第一章绪论
9
第三节兽医统计学的基本步骤
统计学是统计工作实践的经验总结，又对统计工作全过程起指导作用，这
个全过程可分为以下四个基本步骤：研究设计（researchdesign）、资料搜集
（collectionofdata）、资料整理（sortingdata）和资料分析（analysisofdata）。兽
医统计学是统计学在兽医领域应用的分支，其基本步骤亦是如此：例1-1中研究
工作可分为研究设计→资料搜集→资料整理→资料分析→撰写论文，前四步即
为兽医统计学的基本步骤。
一、研究设计
这里所称的设计（design）指统计设计，它是影响研究能否成功的最关键
环节，也是提高观察或实验质量的重要保证。根据在研究过程中是否对研究对
象施加干预将统计设计分为观察性研究设计（observationalstudydesign）和
实验研究设计（experimentdesign），后者又可根据研究对象的不同分为实验
研究和临床试验（clinicaltrial）两类。
若研究者旨在客观地描述研究总体，不对研究对象施加任何干预，例如了
解某地某年某羊群布鲁氏发病率，某地某年成年肉牛的生长发育状况等，其目
的在于摸清某一事物的水平和分布现状，属于调查研究设计；实验研究设计以
动物或生物材料为研究对象，在研究实施过程中研究者可对研究对象施加各种
干预，例如根据研究假设喂以某种特殊饲料，以某种方式给动物接种病毒等；
临床试验设计以人为研究对象，在研究过程中也可施加十预，例如对某病患者
给以某种治疗药物，辅以某种治疗手段，测定某项疗效指标等。
统计设计的内容包括对资料搜集、整理和分析全过程的设想与安排，在设
计前，研究者必须查阅文献、了解情况，对于研究目的是什么、假设是什么、
什么是研究总体、研究对象和观察单位、对研究对象是否施加干预和如何施加
10兽医统计学
干预、需要搜集哪些原始资料和如何获取这些资料、需要设置哪些指标来观察
研究结果、如何对资料进行整理汇总和计算有关统计指标、如何控制误差和偏
倚、预测会得到什么结果、需要多少经费与时间等问题都要周密考虑、统筹安
排，力求科学、实用、可行。研究设计极其重要，本书将在第十七章研究设计
中进行专门讨论。在此先简要介绍实验设计的三个基本原则。
在对研究设计构思过程中，有以下几个问题最为关键：①如何进行抽样？
抽取多少个观察单位？③如何在诸多的影响因素中，分离出研究因素对结果的
1.随机化原则随机化原则，即机会均等的原则，它回答如何抽样和
如何安排处理的问题，包括随机抽样（randomizedsampling）和随机分配
（randomizedallocation）两个方面。前者指总体中的每一个观察单位都有同等机
会进人样本；后者指本次研究所选定的实验受试对象都有同等机会进入根据研
究目的而设定的处理组和对照组。实验研究设计中常用的随机化方法有抽签、
随机数字表法；调查研究设计中除用到以上的单纯随机抽样方法外，还可用系
统抽样、分层抽样、整群抽样等方法。
2.重复原则重复（replication）原则，即确定样本量的原则，它回答至
少应抽取多少个观察单位的问题。通常情形下，在预备实验（或调查）了解到
有关研究总体的某些信息的基础上，在进行正式实验（或调查）时，需要按研
究目的，确定以规定的检验水准和检验效能（poweroftest）达到预期结果所需
要的最少观察单位数，即所需要的样本量。常用的样本量估计方法有经验法、
计算法与查表法等。
3.对照原则对照（control）原则，即在均衡条件下实现实验组与对照组
间科学对比的原则，它回答如何从诸多影响因素中，分离出研究因素对实验结
果的效应问题。所谓均衡性，即可比性，是指在对比组中，除研究因素不同外，
或施加的处理不同外，其他影响实验结果的非研究因素，包括实验过程中的实
验条件和辅助措施都应相同。只有这样，才能使其他非研究因素对对比组之间
差异的影响相互抵消，才能把对比组之间的差异归因于研究因素的影响，从而
第一章绪论11
分离出研究因素的效应。常用的对照方法有空白对照、安慰剂对照、实验对照、
标准对照、相互对照、历史对照、自身对照等。
二、资料搜集
资料搜集（collectionofdata）指应采取措施使能取得准确可靠的原始数
据。动物卫生工作中的统计资料主要来自以下方面：①统计报表。如全国动
物疫病监测与疫情信息系统填报疫情和监测报表等；②经常性工作记录。如
经常性的消毒、检疫、监测等基础性工作资料等；③专题调查或实验研究。
搜集资料的方法和要求，可参阅本书第十七章。有关的同类资料还可在有关
文献中查阅；④各类动物统计年鉴和统计数据专辑，可在各种相关出版物中
查阅。
三、资料整理
资料整理（sortingdata）是将原始数据净化，系统化和条理化，以便为下
一步计算和分析打好基础的过程。所谓净化，是指对原始数据的清理、检查、核
对和纠正错误等；所谓系统化和条理化，是指根据研究自的，将原始数据合理分
组并归纳汇总等。例如，如果要分析对比某动物疫病发病率的性别差异，应该将
原始数据分雌雄两组归纳汇总；如果还要分析对比该病发病率的年龄差异，应该
将原始数据在按性别分组的基础上，再按不同年龄分组汇总。分组可按质分组与
量分组，或界于两者之间的等级分组等方式，分别获取相应类型的资料。
四、资料分析
资料分析（analysisofdata）又称统计分析，包括有关统计指标的选择与
计算，统计图表的绘制，有关统计方法的选用与统计软件的应用等，自的是在
表达数据特征的基础上，阐明事物的内在联系和规律性。统计分析包括两个方
12兽医统计学
面：①统计描述（statisticaldescription）。指选用恰当的统计指标，并选用合
适的统计表与统计图，对资料的数量特征及其分布规律进行测定和描述。②统
计推断（statisticalinference）。指如何在一定的可信程度下由样本信息推断总
体特征，包括参数估计与假设检验（详见第五章第三、四节）
需要注意的是，虽然人为地将统计/兽医统计工作分为以上四个基本步骤，
但它们是紧密联系，不可分割的整体，缺少或忽视任何一步，都会影响整个研
究的结果。
第四节统计分析方法概述
一、单变量定量资料
对于单变量定量资料，常用的分析方法有t检验、非参数检验以及方差
分析。
（1）当进行单样本均数与总体均数的比较时，若资料服从正态性，则使用
样本均数与总体均数的检验；反之，则使用非参数检验。
（2）当进行两样本均数比较时，若资料服从独立性、正态性以及方差齐性，
则使用成组设计检验；若不服从方差齐性，使用r检验；若不服从正态性，使
用wilcoxon秩和检验；若不服从独立性，均数差值服从正态分布时，用配对检
验；均数差值不服从正态分布时，用Wilcoxon符号秩和检验。
（3）对于多样本均数比较，若资料服从独立性、正态性，当因素个数为单
个时，使用单因素方差分析；因素个数为2个或多个时，使用二因素或其他方差
分析。若资料服从独立性、不服从正态性，使用Kruskal-Wails检验。若资料不
服从独立性，但服从正态性时，使用重复测量方差分析；若均不服从，则使用
Friedman秩和检验。详见图1-1。
第一章绪论
13
是
样本均数与总体均数的
单样本均数
检验（第六章）
正态
与总体均数比较
否
非参数检验（第九章）
是
成组设计检验
是
（第六章）
齐性
否
检验（第六章）
是
正态
Wilcoxon秩和检验
否
（第九章）
两样本均数比较
独立
是
配对t检验（第六章）
否
均数差值正态
Wilcoxon符号秩和检验
否
（第九章）
单因素方差分析
单个
（第七章）
是因素
个数
2个或
因素或其他方差分析
多个
（第七章）
是
正态
否
Kruskal-Wallis检验
（第九章）
多样本均数比较
独立
是
重复测量的方差分析
（第七章）
否
正态
否
Friedman秩和检验
（第九章）
图1-1单变量定量资料分析路径图
二、单变量定性资料
对于单变量定性资料，常用卡方检验、Z检验以及确切概率法。
14
兽医统计学
（1）当进行两样本率和构成比的比较时，若进行样本与总体间的比较，np
及n（1-p）≥5时，用z检验；反之，则用二项分布的确切概率法。
（2）若进行两样本间的比较，样本独立时，可根据适用条件使用卡方检验
确切概率法或Z检验；样本不独立则使用McNemar配对卡方检验。
（3）当进行多行或多列样本率和构成比比较时，若样本独立，则使用多个
独立样本R×C表卡方检验；否则使用配对样本RxC表卡方检验。详见图1-2。
是
Z检验（第五章）
np且
样本与总体
n(1-p）≥5
否
二项分布的确切概
率法（第八章）
两样本率
和构成比
*卡方检验、确切概
是
率法（第八章）、Z
检验（第五章）
两样本
独立
否
McNemar配对卡方
检验（第八章）
是
多个独立样本RxC
表卡方检验（第
八章）
RxC表
多行和（或）多列一独立
否
配对样本RxC表卡
方检验（第八章）
*四格表卡方检验：当例数n40且所有理论频数T5时，用普通卡方检验，若所得
p=α，则改用确切概率法；当n40但有1≤T<5时，用校正的卡方检验。
确切概率法：当n<40或有T<1时，用确切概率法。
Z检验：当np和n（1-p）.5，且同时满足np和n（1-p2）5时，用Z检验。
图1-2单变量定性资料分析路径图
三、相关与回归分析
（1）在进行相关分析时若变量服从正态性，则使用Pearson积矩相关分析；
第一章绪论
15
若变量不服从正态性，则使用Spearman秩相关分析。
（2）在进行回归分析时，若变量服从线性及正态性，使用简单回归或多元
回归：若变量服从线性但不服从正态性，使用秩回归或变量转换。若变量不服
从线性，则使用曲线回归或非线性回归。详见图1-3。
是
Pearson积矩相关分析
（第十章）
相关分析
正态
否
Spearman秩相关分析
（第十章）
是
简单回归或多元回归
（第十、十一章）
是
正态
否
秩回归（第十章）或变
量转换
回归分析
线性
否
曲线回归或非线性回归
（第十章）
图1-3相关与回归分析路径图
四、其他资料的统计学方法选择
可根据研究目的的不同选择不同的统计学方法：
（1）需要绘制统计学图表时，可参见本书第三章统计图及统计表的绘制：
（2）进行灵敏度等诊断试验评价时，可采用ROC曲线：
（3）希望减少指标变量个数时，可使用主成分分析；
（4）要寻找潜在的影响因子时，可使用因子分析；
（5）要将若干个对象按其属性相似的程度进行归类，可使用聚类分析。
具体方法总结，详见图1-4。
16
兽医统计学
了解并认识兽医统计学
常用术语与基本步骤（第一章）
区分动物某一指标或含
确定参考值范围（第二章）
量正常与异常的界限
采集与描述资料
资料的统计描述（第二章）
绘制统计学图表
统计图与统计表（第三章）
了解并认识常见的四种
分布
变量的分布及应用（第四章）
根据已知分类建立判别
方程，然后对样本个体
判别分析（第十二章）
进行分类
将若干个对象按其属性
研究目的
聚类分析（第十三章）
相似的程度进行归类
寻找潜在的影响因子
因子分析（第十四章）
减少指标变量的个数
主成分分析（第十四章）
分析随时间变换的趋势
时间序列分析（第十五章）
选择抽样方法并估算样
抽样调查（第十六章）
本量
根据研究目的选择研究
研究设计（第十七章）
方案
灵敏度等诊断试验评价
ROC曲线（第十八章）
图1-4其他资料的统计学方法选择路径图
第二章
资料的统计描述
18兽医统计学
【例2-1】
对病畜血液、尿液、粪便、体液、组织细胞及病理产物，观察其有形
成分，测定物理性状与化学成分，并分析病理变化和病因，最终得到一系
列有关某种流行病的客观资料以及治疗结果。将该实验成果总结成文向上
级汇报，却因为该研究者对于临床资料的一般情况、受试对象的情况及实
验和观察结果等均用大量文字进行描述，报告不直观、未量化，并且没有
揭示规律性的结果，而使上级部门无法真正了解疫情发展状况。
【问题2-1】
（1）以上例子说明什么？
（2）什么是统计描述？
（3）进行统计描述可借助于哪些工具，它们各有什么利弊？
【分析】
（1）撰写兽医流行病学调查报告的目的是汇报流行病学调查与分析结
果、临床诊断或者实验诊断观察结果，通过分析结果说明疫病状况、发生
原因、提出疫病控制措施建议等。大多数兽医流行病学调查报告、研究论
文、论著，对资料的收集、整理、处理、分析都离不开兽医统计学，案例
研究中若将大量的文字描述改用统计描述，则使研究结果更加直观，读者
一自了然。
（2）统计描述是指用适宜的统计指标、统计表和统计图描述资料的分
布规律及其数量特征。它是统计分析的必经之路，能为科研分析提供初步
信息，是统计推断的前提和基础。表达方式主要是通过统计指标、统计表
和统计图。
（3）进行统计描述可人工计算或者借助专门统计软件进行数据的整理
和分析。人工处理和软件分析各有利弊。人工费时费力，容易产生错误；
专门的统计软件，如SAS、SPSS等，快速准确、功能强大，但因其价格
第二章资料的统计描述
19
较高、较难操作等弊端而尚未全面普及。如果在实际处理数据过程中，仅
需要使用简单的统计描述（均数、标准差、标准误、置信区间等），绘制
简单的统计图表，或者进行t检验、方差分析及回归相关分析等，可使用
MicrosoftOffice中的Excel。Excel容易获取，容易操作，且功能相对较强。
第一节资料的采集
一、统计调查的概念与类型
完整的统计工作过程分为统计设计、统计调查、统计整理和统计分析四个
步骤。其中原始统计数据往往通过统计调查获取。统计调查是统计整理和统计
分析的前提。统计调查是根据统计研究的目的、要求，采用科学的调查方法，
有组织、有计划地搜集有关统计资料的工作过程。进行统计调查的原则必须满
足准确性、及时性、全面性和经济性。
依据调查对象和形式的不同，统计调查方法分为以下三种：
1.现场专题调查法现场观察法是观察者带有明确目的到观察现场，借助
人的视觉、听觉或者录音录像设备，对调查对象进行直接观察而获得信息资料
的一种收集方法，又称为直接观察法。具体有普查和抽样调查两种形式。普查
更能全面了解群体基本情况，但是需要耗用大量的人力、物力，因此较为少用。
抽样调查能够在有限资源情况下较为全面地了解情况，较为常用。在恰当使用
的条件下，抽样调查能够在较少的人力和物力条件下，对总体作出相当准确的
推断。运用现场专题调查方法时，应遵循全方位性、客观性、持久性、深入性
见解使得结果因人而异的缺陷。
20兽医统计学
2.调查历史资料法历史资料指各种工作情况的年报表、畜禽疫情月报
表等。例如各种统计报表是兽医卫生监督和流行病学调查工作的重要组成部分。
准确完整的业务报表能直接展示兽医卫生监督管理和流行病学调查工作的成果，
反映畜禽检疫、疫情动向、病害畜禽及其产品的无害化处理结果等信息。
3.调查工作记录法调查工作记录是指调查各级动物疫病预防控制中心、
动物卫生监督所、动物疫病边境检查站和疫情测报站等单位和部门的日常工作
记录、实验室诊断记录、临床化验报告、门诊病例等，这些资料是研究畜禽疫
病流行状况、分析疫情动态的基本资料，是制定动物疫病防治措施的重要依据。
一些专门的报告、生产记录，如产存数、死亡数、传染病、流行病、中毒等报
告单都属于工作记录。对这些资料的研究，可以分析疫病发生的规律及治疗措
施的有效性。例如，通过对200例犬猫B超的详细门诊病例进行统计分析，可以
发现B超诊断相比于常规诊断方法具有诊断准确率高等优点。在动物临床诊疗
方面，病历记录填写还存在不重视、不规范等不足现象。为了使这些资料具有
科学研究价值，平时应该认真填写，并妥善保管。
统计调查阶段搜集到的原始资料并非所谓的统计数据，需要对这些原始资
料进行加工和汇总，最终形成系统化、科学化、规范化并且简洁明了的统计图
表，才能反映事物总体综合特征。
二、统计资料的概念与分类
统计资料收集，就是根据统计研究的自的，采用一定组织形式与科学方法，
进行采集与研究问题有关的各类信息资料的过程。准确、系统、全面的统计数
据是进行科学统计分析和预测的前提。
按照获取途径不同，统计资料可分为原始资料和次级资料。原始资料也称
为第一手资料，次级资料也称为第二手资料。尽可能用最经济、最有效率的方
式采集所需的资料，可以节约大量的人力和物力成本。例如通过查找各种媒体
发表的文章或文献的方法来搜集相关资料。一般来说，在可能的情况下应该尽
量使用第一手资料，它比第二手资料更加丰富、更加准确。使用第二手资料主
要是因为其收集成本和所花费时间较节省。
第二章资料的统计描述21
三、统计资料的采集形式
依据调查者组织调查样本的行为不同，数据调查可以分为主动调查法和被
动调查法。主动调查法，即调查者主动组织调查样本，完成统计调查的方法。
它包括实验采集法、监测数据法、紧急调查法、专项调查法；被动调查法是不
主动组织调查，而是等待各地报告的方法，包括农业部采集数据、报表数据、
边境检查站统计资料的上报报表数据。被动调查对于发病率极低的疫病有关数
据的获取具有非常重要的作用。
（一）主动调查法
1.实验采集法实验采集法，是指实验者在一定的实验条件下，在一定范
围内观察总体现象中自变量与应变量之间的变动关系，并据此作出分析判断。在
动物防疫实际工作和科学研究中，很多问题必须通过实验来解决。比如药物试
验、畜禽生理生化指标测定、临床疗效实验等。一般作法是，从影响问题的诸多
因素中选出一个或多个因素，在设置好的实验条件下有计划地通过随机样本进行
观测，获取的资料是随机样本的观测结果，这些结果可以作为进一步分析的依据。
兽医实验室常见的诊断疫病种类包括：多种动物共患病，如口蹄疫、伪狂犬病、
弓形虫病、动物衣原体病、流行性乙型脑炎、动物布鲁氏菌病；猪病，如猪瘟、
猪流感、猪细小病毒病、猪喘气病等；禽病，如高致病性禽流感、新城疫、鸡马
立克氏病、禽白血病、禽脑脊髓炎、鸡传染性支气管炎等；细菌病，如沙门氏菌
病、葡萄球菌病、链球菌病、大肠菌群等；此外还有牛病、马病、犬猫病等。
2.监测采集法疫病监测资料在兽医学领域内主要用于：鉴定病因、预
防、治疗和其他控制试验，预测未来疫病发生、为制定合理防制对策提供依据、
评价动物保健的经济效果。我国动物疫病的监测是在农业部畜牧兽医司组织领
导下进行的。同时，各省、市、县以下地方政府均设有政府兽医机构以及诊断
实验室。我国进出口动物疫病监测具体由动植物检疫总所及所属口岸负责承担
检疫。在农业院校和研究部门兽医诊断实验室的配合下，上述系列政府兽医机
22兽医统计学
构在合作中已初步形成全国性的动物疫病监测网络。
标准的动物疫病监测系统通常由动物疫病监测中心、诊断实验室及分布各
地的监测点等构成。监测的资料收集应系统、连续、全面，一般包括发病和死
亡报告资料、流行或暴发报告资料、现场调查资料、实验调查资料（如病原体
抗原检测和分离鉴定、血清学调查）、药物及疫苗使用的资料、暴发或流行的流
行病学调查资料、动物群体及环境资料（包括暴露地区和监测地区资料）。
监测数据是指通过免疫效果监测、疫病监测等得出的结论性数值。例如，
对部分临床疑似畜进行拍照或摄像，并收集临床疑似畜的其他材料如档案、动
物疫病采样及监测数量表、采样单等，都是统计资料采集的重要结果。制定监
测数据的收集、整理和分析方法，通过收集监测结果、核对和录人监测数据，
利用计算机软件制作图表，再通过图表的方式分析动物疫病的时间、空间、种
间分布，有助于评估重大动物疫病的免疫效果、疫情风险，以及发布监测预警。
3.紧急调查法动物疫病流行病学调查依据不同调查目的和任务，通常
设置有紧急流行病学调查、定点流行病学调查和专项流行病学调查这3种调查方
式。其中，突发的畜禽疫情必须及时进行流行病学调查和处置工作，这种调查
称为紧急调查。例如对每起发生的口蹄疫、禽流感、猪链球菌病等重大突发疫
情要进行抽样检测病原和抗体，了解重大动物疫病的流行分布情况。对阳性样
品进行分子流行病学分析，提出调查、监测分析报告。
4.专项调查法对重大动物疫病、人畜共患病、外来动物疫病流行病学等
展开的专项调查和研究称为专项调查，通过调查能够获取畜禽疫病状况、外来
病发生风险和动物卫生状况等有关资料。专项调查还可针对重大动物疫病防控
中遇到的特定问题，例如家畜包虫病流行状况、布鲁氏菌病防控措施实施效果、
狂犬病风险交流情况等。
（二）被动调查法
1.获取官方数据从农业部获取有关数据是获取官方数据的重要途径。
1996年建成的农业部网站（www.moa.gov.cn）是中华人民共和国农业部官方网
站，是具有权威性和广泛影响的中国国家农业综合门户网站。网站由中华人民
第二章资料的统计描述23
共和国农业部信息中心承办。其下设有中华人民共和国农业部兽医局（http：//
www.syj.moa.gov.cn/），其主要职责包括专门拟订动物防疫、检疫、医政、兽药
及兽医器械发展战略、政策、规划和计划并指导实施，起草有关法律、法规、
规章并监督实施，及公布疫情数据。
《兽医公报》是中华人民共和国农业部创办编辑出版的政府出版物，主要刊
载全国人大和国务院通过的有关兽医和动物卫生方面的法律、法规，国务院农
业行政主管部门发布的有关兽医和动物卫生方面的规章和文件、动物卫生标准、
我国的动物疫情月报、我国动物疫病防治情况、有关动物卫生监测报告等。从
这个网站获取数据是非常重要的。
《中国畜牧业年鉴》是全面反映我国畜牧、兽医、饲料、草业等行业基本情
况的资料性工具书，每年出版一卷。年鉴撰稿人主要是各有关部门或单位的工
作人员，统计资料由国家统计局及相关部门提供或由他们核实订正，交由该年
鉴首次发表。
国家动物疫情测报体系由国家动物疫情测报中心、省级动物疫情测报中心、
县级动物疫情测报站和边境动物疫情监测站三级单位组成。技术支撑单位包括
中国动物中国疫病预防控制中心、动物卫生与流行病学研究中心、农业部兽医
诊断中心及相关国家动物疫病诊断实验室。各测报（监测、诊断）中心（站）
按规定报告动物疫情检测结果；国家疫情测报中心负责疫情监测，测报数据的
汇总、分析，国家动物流行病学研究中心负责国内外动物疫情的收集、流行病
学研究和预测、预报；相关国家动物疫病诊断实验室为动物疫情的监测提供技
术支撑。
中国动物卫生与流行病学研究中心（http://www.cahec.cn/）主要职责为：负
责组织开展动物流行病学调查、分析、研究和疫病普查；负责收集、处理、保
藏各种动物血清，开展重大动物疫病动态监测和疫情追溯。负责重大外来动物
疫病诊断、疫情监测及防控技术措施研究。负责收集国外动物疫情信息，建立
国家动物卫生与流行病学数据库，开展动物疫病预警分析工作。承担动物和动
物产品兽医卫生评估、动物疫病区域风险评估工作，组织实施企业动物卫生认
证。协调国家动物卫生与流行病学分中心、国家兽医参考实验室、各级各类兽
24兽医统计学
医实验室和流行病学调查工作，分析和汇总流行病学调查相关数据，提出流行
病学调查总体报告。
2.报表数据统计报表是按照规定的统一表式、统一指标内容、统一报送
程序和时间，由填报单位自下而上逐级提供统计资料的一种统计调查方法，其
资料来源主要是基层单位的原始记录、统计台账及内部报表。统计报表以各项
原始记录为基础，具体指兽医工作情况的月份、季度、年度报表，以及各种畜、
禽疫病类别报表等，是定期取得系统、全面的统计资料的主要形式之一。统计
报表能够系统反应各地区或各牧场在各个时期工作的基本情况，反应畜禽健康
和畜牧业的发展概况，是总结工作、拟定防治措施的重要依据。在我国，畜禽、
发病资料的收集主要限于法定应报告的传染病，如畜禽疫情报表都记录着发病
资料。我国省级、市级地区逐级向上提供各种防疫报表，动物检疫业务报表，
包括活畜禽检疫情况统计表等内容。各畜禽生产单位都有发病的日常记录，在
执行消灭或控制这些疫病的规划过程中，对特定疫病的发病资料记录，如猪瘟、
新城疫、布鲁氏菌病和结核病的发病记录，以及在进行特定研究中的发病记录，
如肢蹄病记录、流产记录、牛乳房炎记录等。
3.基层兽医在我国，县、乡两级防疫机构都直接从事动物疫病防治的具
体工作，而城市里以犬、猫为服务对象的私人兽医也逐步发展起来。这些基层
兽医机构的病例记录可以提供马、奶牛、肉牛、犬、猫等动物的疫病流行情况。
广大养殖户、基层兽医工作者和防疫员以及其他公众在遇到疑似动物疫情、或
者发生动物死亡等情况的时候有义务向各级兽医主管部门、疫控机构和监督机
构反映情况。历年来，广大群众反映的情况为兽医主管部门判断疫情、分析形
势提供看重要的信息。
另外，畜禽生产单位，尤其是奶牛场、集约化养猪场和养禽场，大都保存
有完整的生产记录和疾病记录。屠宰加工牛、羊、猪、禽的工厂和肉联厂，都
设有专职的肉品卫生检验兽医，记录屠宰检验的结果，大多数情况下，根据大
致病变即可作出诊断。在肉品检验中诊断出来的大多数是亚临床疫病，在检验
中详细记录的发现的异常情况，具有流行病学价值。药物和农产品销售部门的
记录有时也是一定程度上提供动物疫病发生情况的一种间接评估渠道。
第二章资料的统计描述
25
除了单独使用上述的资料采集方法，在实际的工作应用中可以结合调查对
象的特点情况多种方法结合使用。
四、Meta分析简介
近年来，随着科研投人的增加，同类或相似研究报道不断出现，定量化的
Meta分析越来越受到人们重视。它是一种量化的文献综述，常用于临床试验、
诊断试验和流行病学研究等方面的综合评价。它可以通过综合多个同类研究结
果，增大样本量，从而提高检验效能。目前，医学文献综合研究是医学研究的
一个重要组成部分。Meta分析在医学领域应用范围日益广泛，在诊断、治疗、
药物、危险度评价、干预措施、预防对策及临床试验、流行病学等方面起着独
特的作用。利用适当的统计方法对按照某种特定标准收集到的研究资料进行分
析概括，以获得更加普遍的结论，其结论比一般综述更加科学可靠，能最大限
度地减少主观影响和最大可能地确保结论的科学性和真实性。高质量的Meta分
析能为卫生服务提供者、利用者及决策者提供重要信息。Meta分析方法的优点
具体体现在以下方面：
1.增加统计功效，定量估计研究效应的平均水平由于单个临床试验往
往样本太小，难以明确肯定某种效应，而这些效应对临床来说又可能是重要的。
Meta分析可以综合各个结果，改进和提高由于样本的大小而影响统计效能，定
量估计研究效应的平均水平，可以提高对初步结论的论证强度及临床所见效应
的分析评估力度。
2.解决各研究结果的不一致性对同一个研究问题，因研究水平、研究对
象、试验条件、样本量等不同，各个临床试验结果可能不尽一致，甚至存在分
歧争议。运用Meta分析方法可以得到对该问题的全面认识，并作出科学的结论。
不同病例一对照数的研究结果进行综合比较，以增大样本量、提高检验效能，
评价各研究结果的不一致或矛盾，发现以往研究的不足并得到收敛的合并效应
值，提出一些尚未研究的新问题和研究方向，从而获得对某一研究问题的全面、
26兽医统计学
可靠地综合性结论。
可以进行Meta分析的软件有很多，常用的有ReviewManager、R、Stata等
软件。由于Meta分析是对某一主题已有的研究进行综合分析，所以尽可能全面、
系统地收集相关文献是进行文献检索的基本原则。可以通过检索主流数据库如
国外的MEDLINE、EMBASE和国内的CBMDISC、VIP、CNKI、万方数据库等
获取以往研究成果。制定恰当的检索策略可以尽可能全面地收集相关文献。下
面以探讨家禽养殖场禽流感发病的风险因素为例来说明该分析方法的过程。
第一步，进行文献检索和筛选。通过对PubMed、Wiley、Elsevier和Springer
数据库交叉检索有关家禽养殖场禽流感发病风险因素研究的相关文献，通过文
献检索发现126篇可能相关的文献。
第二步，进行检索之后文献的筛选。必须在正式选择文献前制定合格文献
的纳人与排除标准，因为根据纳入标准和剔除标准，才能更进一步筛选出符合
Meta分析要求的病例对照研究。而用于评价文献质量的方法很多，如目前用于
临床试验文献质量评价的量表不少于25种，应用较多的包括Consort声明、Jadad
标准、Delphi清单和Chalmers量表。不少学者提出了特定的量表法进行观察性
研究的文献质量评估，如Lichtenstein等对病例对照研究拟定20条标准。在均衡
研究的内部真实性和推广应用性的前提下，通过专家讨论并参照针对单个研究
的Lichtenstein20条标准，确定本研究的文献纳人、排除标准。按照预先设定的
纳入、排除标准筛选后，最终进入此次Meta分析的文献共15篇，其中14篇病
例一一对照研究，1篇横断面研究，文献研究涉及4个洲的11个国家和地区，累
计养殖场总数2823例，其中，病例场数843例。
第三步，进行数据提取。从纳人文献中提取出第一作者、出版年、国家、
样本来源、病例一对照研究时间、养殖场类型、家禽类型、禽流感病毒亚型
及其致病性、暴露因素、病例组中暴露和未暴露的例数、对照组中暴露和未暴
露的例数等数据。为避免由于各个文献对暴露的定义不明确而造成此次分析对
暴露状况的错误分类，还要对部分暴露因素进行标准定义。数据提取过程中，
对缺乏或含义模糊的数据，与通讯作者联系后补充完善；对工作量大的数据
（如暴露因素），通过双重提取，进而交叉核对。
第二章资料的统计描述27
第四步，进行统计分析。采用Meta分析软件ReviewManager5.2对筛选出的
文献进行Meta分析。使用每个纳入研究中的、发病与各个暴露因素之间的关联
强度进行评价，将OR及其95%CI作为合并效应量。采用x检验进行多个独立研
究间的异质性检验，通过敏感性分析了解结果的稳定性和可靠性；对有异质性
的资料根据不同养殖场类型和不同样本量进行分层分析。同时，对合并效应量
具有统计学意义的风险因素，采用SAS9.3统计分析软件估算失安全系数（fail-
safenumber）以识别和评估发表偏倚。
第五步，Meta结果分析。通过对国内外有关家禽禽流感发病风险因素的探
索研究方面的文献进行综合分析，发现家禽养殖场禽流感发病的主要危险因素
为养殖场附近有升放水源、有临近养殖场感染、养殖厂内畜禽混养等，研究结
果与国内外文献报道基本一致。其中，养殖场周围环境因素对禽流感发病与否
影响显著，表明科学选址、合理布局、促进养殖设施化对禽流感防控至关重要。
故建议养殖过程中加强栏舍建设、实现畜禽良种化。另外，对养殖场管理情况
中的圈养、设备共用和生物安全状况中的养殖场消毒因素分析虽无显著统计学
意义，但其P值均较小，即合并OR值具有实际指导意义，故在养殖场畜禽生产
过程中要实现并加强监管常态化和防疫制度化。综合分析之后进而可以为家禽
养殖厂禽流感发病的风险因素探索和预防控制决策提供依据。
五、资料的核对与检查
兽医研究者从各种来源收集的大量原始资料，必须对它们进行科学整理，
使之系统化，才能作进一步研究分析。
统计资料的审核包括汇总之前的审核和汇总之后的检查。完整、正确的资
料对于统计分析工作是十分必要的。为了确保原始资料的完整性和正确性，必
须认真检查与核对原始资料。完整性是指原始资料中没有缺失或者重复的数据。
正确性是指原始资料测量、记录都没有差错或者不合理的合并等。在检查中，
要特别注意非常大、非常小以及异常数据，需要结合兽医专业知识进行辨别判
断真伪。
28兽医统计学
一是，资料汇总前，要检查资料的及时性和完整性，然后应该对原始资料
的全部数据做检查和核对、分辨真伪，力求完整和正确。检查原始的记录是否
存在遗漏、重复的现象，以及每个项目是否填写齐全、同一指标在不同表中是
否一致、各有关指标之间是否存在矛盾等。
二是，资料的检查与核对在统计工作中十分重要。在获取资料时如果发现
问题就应该及时解决。重复或者异常的资料经过核实确定之后才能慎重删除，
否则可能丧失获取新的信息的机会。错误或者矛盾的资料经过仔细检查核对之
后要进行及时更正，如果有必要可以进行复查或者重新试验。
三是，统计资料汇总以后，还需要进行认真的检查，主要是审查资料的
准确性，包括计算检查和逻辑检查。汇总后检查的目的不仅在于审查、汇总
工作本身的问题，还是为了发现新问题、解决新问题，以保证最后结果准确
无误。
六、统计资料的分类
在第一章已介绍，资料的统计方法种类很多，每种统计方法都有一定的使
用条件和范围。正确选择统计方法的前提是了解资料分析类型。根据分析需要，
各类资料可以进行互相转化。正确判定统计资料属于定量资料还是属于定性资
料是选用统计分析方法的首要前提。资料类型的传统划分方法是将资料分为定
量资料、定性资料和等级资料这三类。定量资料是指测定每个观察单位某项指
标量的大小所得的资料。例如测得正常成年男子身高（cm）、体重（kg）、血红
蛋白（g/L）等所得的资料。定性资料是指将观测单位按某种属性或类别分组计
数，然后分别清点各组中的例数，这样得到的数据成为定性资料，一般没有度
量衡单位，是一种间断性的资料。例如某地区生猪存栏数为23万，养殖场户数
为2.1万等。等级资料是指将观测单位按某种属性的不同程度分组计数，得到各
组观察单位数称为等级资料、半定量资料或有序资料。等级资料室是介于定量
资料和定性资料之间的一种有序分类资料，一般没有度量衡单位，也是一种间
断性资料。例如用某种治疗方法医治100例病人，最后清点治愈、显效、好转、
第二章资料的统计描述29
无效、死亡个数分别为10、30、30、25、5。
统计资料类型的现代划分方法是将资料分为定量资料和定性资料两类。定
量资料（Quantitativedata），其变量值是定量的，表现为数值的大小，如调查
某年某地7岁女童的生长发育资料，以人为观察单位，女童的身高（cm）、体重
（kg）等均属于定量变量。定量变量有两种类型，离散型变量（discretevariable）
和连续型变量（continuousvariable）。离散型变量只能取整数值。如，一个月中
的死亡人数、一年里的新生儿数。而连续型变量可以取实数轴上任何数值。例
如，血压、身高、体重等。注意：有一些测量值，如白细胞计数，虽然以“个”
为单位时只能取整数，但其数值很大，当以“千”、“方”为单位时，又司以取
小数值，所以通常把这类变量也视为连续型变量。
定性资料（qualitativedata），其观测的个体只能归属于几种互不相容类别中
的一种，一般是用非数字来表达其类别。定性变量常分为分类变量（categorical
variable）或名义变量（nominativevariable）和有序变量（ordinalvariable）或等
级变量（rankedvariable）
分类变量是指所分类别或属性之间无程度和顺序的差别。如，教育程度是
一个分类变量，其可能的“取值”不是数字，而是小学、初中、高中等。分类
变量常分为两种：
（1）二分类变量：为最简单也最常用的分类变量。两类间相互对立、互不
相容。如，试验结果的阴性、阳性，疫病的有、无等。在计算机输入时，常用0
和1来编码。也称为0-1变量。0-1变量也常称为假变量（dummyvariable）或哑
变量。
（2）多分类变量：如，人类的ABO血型，以人为观察单位，结果分为A型、
B型、AB型和O型，表现为互不相容的多个类别。
等级变量不同于分类变量，为将观察单位按某种属性的不同程度分成等级
后分组计数，分类汇总各组观察单位数后而得到的资料。它在种种可能“取值”
中自然地存在着次序。各类之间有程度的差别，给人以“半定量”的概念。如，
测定某人群某血清学反应，以人为观察结果，结果可分为“二”、“±”、“+”、“十”
四级；又如问卷调查常问对某件事情的满意程度，给出五个选项：极不满意、
30兽医统计学
有点满意、中度满意、很满意、极满意。
变量类型不是一成不变的，在统计分析中，常根据不同的需要，对各类变
量进行转化，以满足不同统计分析方法的要求。例如，血红蛋白量（g/L）属于
定量变量，若按血红蛋白正常与不正常分为两类时，可按二项分类资料分析；
若按重度贫血、中度贫血、轻度贫血、正常、血红蛋白增高分为五个等级时，
可按等级资料进行分析。以上的例子是先获取定量资料后向定性资料或等级资
料的转化，只要能在专业理论的支持下，确定不同属性或不同等级的数量界限，
这种转化是不难实现的。变量只能由“高级”向“低级”转化，如：定量一有
序一分类一二值；不能作相反方向的转化。在研究设计中，能测量的指标应该
尽可能设计为定量指标，这将为分析中的资料转化带来方便。
第二节定量资料描述
一、定量资料的概念
定量资料是通过度量衡的方法测量每一个观察单位的某项研究指标的量的
大小，得到的一系列数据资料，一般有度量衡单位。例如动物的形态指标：体
重、身高、体长、胸围等；生理生化指标：呼吸次数、脉搏次数、体温、白细
胞数、血糖含量、血红蛋白含量等。定量资料应用甚广，如一些参数都应该用
计量水平进行评价和分析；又比如在评价手术效果的研究中，获得的变量，如
体重、手术持续时间、手术后生存时间等，都可以用定量方法测量，表现为数
值的大小，一般有计量单位。对于这些量化的指标，在统计学上可以从统计描
述和统计推断两个层面进行分析。定量数据通常指使用各种仪器或试剂测定的
生理、生化、免疫等连续变量数据，如血压、血小板、红细胞等，特点是能够
第二章资料的统计描述
31
用数值大小衡量其水平的高低。
恰当地利用统计表对实验或观察结果进行数据描述并不是一件容易的事情。
当用统计表对定量资料的统计结果进行描述时，最常见的是给出各项指标的均
数和标准差，同时最好给出中位数。在兽医流行病学研究中，由于生物现象的
变异较大，各种因素又错综复杂，实验与观察的结果往往会受到许多随机因素
的影响，收集的数据中往往包含了很多数值变量。而统计学的重要作用就在于
能够透过偶然现象来探测其规律性，并用容易理解的方式将研究结果表达出来，
为在情况不确定的条件下进行判断提供依据。由这些变量组成的定量资料必须
根据资料设计的特点，采取相应的统计分析方法。
二、定量资料的统计分析
定量资料统计分析主要分为统计描述和统计推断。定量资料的统计描述包
括三部分：平均水平描述、离散程度描述和正态分布。
（一）平均水平描述
均数是描述定量资料最常用的统计指标，通常使用平均指标来描述一组定
量资料的集中趋势，它反映了一组观察值的平均水平，即一组观察值的平均水
平或中心位置。常用的有算术均数、几何均数和中位数。（由于计算机的普及，
一般可用软件精确计算结果，所以下述公式中没有列出样本量较大时相应的近
似计算公式，若需手工计算，请参阅有关文献。）
1.算术平均数算术平均数也称为代数平均数，简称均数，适用于数据呈
正态或近似正态分布的描述。即n个性质相同的变量数据X，X，"，X之和除
以n所得结果。观察值个数不多时采取直接计算方法。公式如下：
>X
（2-1)
n
n
对于已经分组的资料，可依据次数分布表采用加权法计算均数，计算
得到的均数称为加权均数。以X表示第组的组中值或者每组的组平均数，k
32兽医统计学
为组数，f为第i组的次数。用加权计算得到的均数称为加权均数。计算公式
如下：
(2-2)
f+f+...+f
Zf
=1
2.几何平均数几何平均数又称为几何均数，适用于变量值呈对数正态分
布或变量值为等比数列的资料，主要用于畜禽疫病及药物效价的统计分析，例
如抗体的滴度、畜禽疫病的潜伏期等。当变量值不多时，常用的直接计算方法
是对n个性质相同的数据分别取对数变换后，再按算术均数公式计算，最后再求
其反对数所得结果。数据呈现倍数关系或者服从对数正态分布时，适于使用几
何均数来描述其平均水平：
G=√xx··x=(x··x）
(2-3)
在实际使用中，当n>3时，为了计算的方便，可以转换成对数形式进行计
算，公式如下：
G=1g-[-（gx+1gx+.+1gx,)]=1g(-∑1gx,)
(2-4)
n
3.中位数为一组按照大小顺序排列的变量，其位次居中的数值即中
位数，n个性质相同的数据按照从小到大排序，居中的数据就是所谓的中位
数。其实就是第50百分位数，它正好把一组数据等分为2部分，多用于描述
偏态分布资料的平均水平，也就是说在一组观察数值中，大部分数值比较集
中，少数数值偏向了一侧，或者资料分析情况不够明确时，计算中位数公式
如下：
M=X（n+1）/2（n为奇数）
(2-5)
M=（Xn/2+Xm/2+1）/2（n为偶数）
(2-6)
（二）离散程度描述
对于一组观察值特征的描述，不仅需要均数表达其平均水平，还需要用一
第二章资料的统计描述33
些统计指标描述其离散程度，这样才能全面地反映观察值的分布特征。描述观
察值离散程度的常用统计指标有：极差（全距）、四分位间距、方差、标准差和
变异系数。
极差（range），是一组观察值中最大值与最小值之差，常用R表示。全距越
大，表示这一组观察值越离散。其不足之处是全距大小仅由一组观察值中最大
值和最小值决定的，故不能反映组内其他观察值之间的离散情况。极差不稳定，
较少使用，多用于说明传染病、食物中毒的最长、最短潜伏期等。
四分位间距（IQR，interquartilerange），是一组性质相同的数据中，第75百
分位数与第25百分位数之差，可以看作中间一半观测值的极差，多用于描述偏
态分布资料的变异水平。四分位间距与全距代表的意义和适用范围相似，数值
越大，离散程度越大。虽然四分位间距比全距稳定，但仍未考虑到每个观察值
的离散度。
方差（variance）和标准差（standarddeviation）用来反映一组数据的平均
变异水平，方差是标准差的平方。方差是为了克服全距的缺点，考虑到一组观
察值中每个数据对均数的离散程度，可用每个数据与总体均数之差的总和，即
n
均数一起描述正态分布的特征。
变异系数（CV，coeficientofvariation）即标准差与算数均数的比值。当比
较两组或多组定量资料的变异度大小时，如果各组资料的度量衡单位不同，或
者各组算数均数相差悬殊，必须用变异系数进行比较。标准差、变异系数计算
分别如下公式：
∑(x-x)
S=
(2-7)
n
S
CV==
×100%
X
(2-8)
34兽医统计学
第三节定性资料描述
一、定性资料的概念
定性资料是先将观察单位按某种属性或类别分成若干组，再清点各组观察
单位个数所得的资料。每个观察单位之间，没有量的差别；各组之间具有质的
不同，不同性质的观察单位不能归入一组。
若观测结果为定性资料（如治愈、未愈），一般不以个体为计量单位，而是
以处理组为计量单位，换句话说，资料以分组且用表格的形式呈现出来，这种
表通称为列联表。列联表有二维列联表和高维列联表之分。具体地说，就是列
联表中涉及儿个定性变量就称为儿维列联表。根据结果变量的性质可将高维列
联表分为以下三类：一是结果变量为二值变量的高维列联表；二是结果变量为
多值有序变量的高维列联表；三是结果变量为多值名义变量的高维列联表。处
理不同的高维列联表资料所用的统计分析方法不尽相同。
二、定性资料的统计分析
定性资料的统计分析主要分为统计描述和统计推断。统计描述主要指可以
计算相对数的指标。相对数是一种相对指标，与绝对数对应。描述定性资料的
内部构成情况或相对比值或某现象的发生强度，需用相对数，它包括比如率。
统计推断主要是估计相对数指标的置信限以及作假设检验，比如率的95%置信
区间的估计以及进行卡方检验等。
定性资料的统计描述主要涉及相对数的计算和注意事项的问题。下面介绍
绝对数与相对数的概念。
1.绝对数绝对数是研究事物现象的基本资料，绝对数在统计学中对应的
是总量指标，反映现象总体在一定时间和条件下发展的总规模或总水平。是统
第二章资料的统计描述35
计整理阶段的直接成果，为统计研究进入统计分析阶段提供可靠的数据基础。
绝对数在兽医统计工作中的应用：
（1）用于表示事物最基本的数量特征，如体重、体长、血压等。
（2）反映事物存在或某事件出现的绝对水平，如某养殖场在某时期内患某
种传染病的总病例数。
（3）根据事物在时间上的变化，可用绝对数编制动态数列，例如，某地区
型患肠胃炎羊只数的动态变化。
（4）绝对数是数学运算和统计工作上计算其他统计指标的基础。
（5）在医学统计工作中，某些情况下的统计指标只能用绝对数表示。
绝对数本身就能说明一定的问题，但是要进一步分析现象间的关系和发展，
就要将绝对数换算成相对数。如某地区每年的患某种病的数量是绝对数；但是
如果根据患病数以该地的总量数计算出一个发病率，那么对于该疫病在该地区
的严重性就有了一个更明确的判断指标。
2.相对数为进一步分析现象间的关系，常需用率、构成比、相对比
等指标来描述。这些指标都是由两个有联系的数据之比组成，统称为相对数
(relativenumber)
（1）率（rate），又称频率指标，即在一定条件下某现象实际发生的例数和
可能发生这种现象的总数之比，用于说明事件发生的强度。在兽医统计学中通
常用以测度疫病发生频率或强度。
发生某现象的观察单位
XK
（2-9)
比例基数K根据实际需要可以取为百分率（%）、千分率（%）、万分率
（1/10000）等，取值的具体结果一般以能保留一至二位整数为准。
在兽医卫生工作和科学研究分析中，率的应用很广泛，常见的率有患病率、
感染率、发病率、累计发病率、罹患率、携带率、死亡率等。这些率的含义互
有区别：发病率往往是一个比较长时间内新发病率的强度；而患病率不同，是
较短时间内或者某一个时间点上发病数除以该地的总量个数；病死率和死亡率
36兽医统计学
也是两个不同的概念，某病的死亡率反映了该病在群体中的死亡强度，应该用
因该病死亡的个数除以该地区的总数，而病死率反映的是该病对于个体来说导
致的死亡的可能性大小，在一定程度上也反映了疫病的严重程度和医疗水平的
高低。
患病率（prevalencerate），指某个时间内的特定病种的新、老病例数（不包
括此时间前已经死亡或者痊愈的个体数）与同时期段内群体的平均数之比。
XK
同时间该群体暴露动物数
（2-10)
例如，对某养殖场内的50只羊进行为期一年的观察，观察期内患上胃肠炎
病的羊总数为8只，羊胃肠炎病的患病率=8/50×100%=16%。这个比例体现的是
在一个给定时期内，代表了一种动物患上某种特定疫病的概率。疫病普查得出
的就是这个率。患病率可以取值在0和1之间，并无量纲，它往往表示为百分比。
感染率（infectionrate）和患病率意义相近，动物被桌些传染病感染之后并
不一定发病，但通过微生物学、血清学以及其他免疫学方法可以测定其是否感
染。感染的动物包括带有和不带临床症状的两种，感染的诊断方法和判断标准
对感染率的影响很大。
检出阳性动物数、
感染率=
xK
受检动物总数
（2-11)
例如，某牛群的牛肝片形吸虫感染率就是患病率，是患病或者感染牛之比
例的一种静态描述。感染率的用途广泛，可以用它推论该病种的流行态势，在
布鲁氏菌病、结核病等慢性病，以及寄生虫病和一些病毒病的流行病学研究中
十分常用。
发病率（incidencerate），表示在一定时期内某畜群中发生新病例的频率。
它被用来描述疫病分布，探讨疫病决定因素和评价防治措施效果，通过比较不
同组群的发病率，可以验证病因假设，因此是一种常用队列研究指标。
第二章资料的统计描述
37
XK
同时期内该群体动物平均数
（2-12)
累计发病率（cumulativeincidence），是指观察期开始时，无病的个体在观
察期内变为有病个体的比例。
特定时期内变为有病动物的总数
累计发病率：
XK
该观察期开始时群体中的健康动物数
（2-13）
例如，有100只猫于第一周出现17例病毒性鼻气管炎，于第二周文出现
13只病例，观察期的时间越长，风险就越大。观察期为一周的累计发病率
17/100=17%，观察期两周的累计发病率=（17+13）/100=30%
耀患率（attackrate）与发病率均用来表示群体中在一定时期内新病例的发
生频率，是用以度量动物群体中较短时期内发生新病例频数的指标。
XK
同期暴露动物的总数
（2-14）
携带率（carrierrate），概念上与感染率类似，根据病原体的不同分为带毒
率、带菌率、带虫率等。其概念与感染率相似。
被检动物总数
（2-15）
例如，对某养殖场内的50只羊进行为期一年的观察，观察期内携带胃肠炎
病菌的羊只总数为5只（假设这一年内该群体动物均数为50只）。则病菌携带率
5/50×100%=10%
死亡率（mortalityrate），是指某动物群体在一定时期内死亡总数和该群体
同期动物平均数之比。
XK
同期该群体动物平均数
（2-16)
38兽医统计学
例如，对某养殖场内的50只羊进行为期一年的观察，观察期内羊因患上胃
肠炎而死亡的总数为3只，则死亡率=3/50×100%=6%
累计死亡率（cumulativemortality），计算方式与累计发病率相似，但是
分子由一定时期内由特定疫病导致的死亡个体的数量构成。分母由该时期暴
露在风险中的个体数量构成。在该观察期开始时已经患病的动物数也包含在
分母中。
累计死亡率=
在特定时期内死亡总数
在该时期开始时的群体总数
XK
（2-17)
按照疫病种类计算死亡率时，称为某病死亡率，它是疫病分布的一项重要
指标，对轻微不致命的疫病或者发病率高但死亡率低的疫病都不适合使用，而
对猪瘟、牛恶性卡他热、鸡新城疫等病死率高疫病的研究具有重要价值。
同期患该病的动物平均数
（2-18）
病死率（fatalityrate），表示一定时期内患某病的动物因病死亡的频率，如
果死亡专率和发病专率很稳定，可以用该病死亡专率和发病专率的比值推导出
病死率。其中，专率是指将群体中的动物按照性别、年龄、品种或者其他属性
进行分类，用率对各类动物的疫病发生进行描述。因此有年龄发病专率、性别
发病专率、品种发病专率等。
XK
同期患该病的动物数
(2-19)
在比较相对数时尤其应注意可比性。观察对象、研究方法、观察时间、
地区等其他影响因素应相同或相近，或者说除了要对比的因素外（如不同的
药物），其余的干扰因素应当尽可能在组间相同或相近。如，在新药组同常规
药组疗效比较的研究中，两组的性别、病情、年龄构成等应尽可能相近（可
用相应的分析方法进行检验）。这一点具有普遍性，适用于所有组间比较的
第二章资料的统计描述
39
情形。
（2）构成比。构成比也称为结构相对数，表示事物内部各个组成部分所占
的比重，通常又称为百分比。即仅具有属性的那一部分个体数目n占全部个体
总数的百分比p，有：
P+P++P=100%
（2-20)
第i个类别的观察单位数
×100%
(2-21)
该指标有两个特点：
第一，构成部分的相对数之和为100%；
第二，如果某一部分比重增加，其他部分相应减少。
例如：某养殖基地各种羊肝片吸虫发病例数为：肝片吸虫后尾40例，童
虫47例，成虫13例。则三种肝片吸虫分别占肝片吸虫总数的百分比为：
肝片吸虫后尾=40/（40+47+13）×100%=40%
肝片吸虫童虫=47/（40+47+13）×100%=47%
肝片吸虫成虫=13/（40+47+13）×100%=13%
各部分百分比之和100%，即40%+47%+13%=100%
（3）相对比。相对数是有关事物指标之比，又称为比。说明甲是乙的若干
倍或百分之几，常用百分数或倍数表示。甲、乙可以是绝对数、相对数或均
数等。
在流行病学研究方法中常遇到的危险度（RR）和比值比（OR）就是在临
床科研中经常遇到的相对比指标。RR值或OR值常用来表示暴露因素和疫病的
关联程度。两个有关指标之比，用于说明两者的对比水平。通常以倍数或百分
数表示。
甲指标
相对比=
×100%
乙指标
（2-22）
40
兽医统计学
例如：某养殖基地在为期3年的观察期内，羊患肠胃炎发病数中公羊为93
只，母羊为60只，则公羊为母羊的1.55倍，即
公羊/母羊=93/60×100%=155%
也可以写成
公羊：母羊=93：60=1.55：1
计算相对数的分母不宜过小。计算相对数时要有足够的调查或试验例数，
否则误差太大。因为当观察例数很少时，分子每改变一个单位对结果的影响很
大，此时不宜计算相对数，尤其在临床试验中，影响研究结果的偶然因素较多，
此时直接用绝对数叙述即可。例如治疗了2例患者，结果全部治愈，于是认为该
方法治疗的治愈率为100%显然存在很大误差。也就是说计算相对数要有足够的
数量，如少于10例时以绝对数表示为好，必须用时应给出置信区间。但动物实
验中，例如毒理实验中，每组9只纯种小鼠，经周密设计、精选对象、严格控制
实验因素，每组9只动物也可求率，即也可以计算相对数。
分析时不能以构成比代替率，防止概念混淆，称为率不一定都相同。构成
比只能说明事物各组成部分的比重或分布，并不说明某现象发生的频率或强度。
指标的选择错误：通常是应计算频率指标而选择了构成比。用构成指标来下频
率指标的结论易导致错误结论（把构成比当成率来分析）；反映事件发生的强度
必须用率来说明。在对相对数进行比较时要注意资料的可比性以及资料的周期
性，并在比较前运用恰当的方法进行预处理，如率的标准化的方法。率和构成
比等同样存在抽样误差，需要对样本率或构成比进行假设检验来比较有无差别。
率和构成比的区别如表2-1所示。
表2-1构成比和率的区别
构成比
率
各部分可直接相加
各率不可直接相加
各部分之和等于100%
总率不一定等于各率之和
某部分变化，其他部分随之变化
某部分变化，其他部分随之变化
第二章资料的统计描述
41
对观察单位不等的几个率不能直接求总率，而应分子相加除以分母相加。
在比较相对数时应注意可比性。观察对象、研究方法、观察时间、地区、
种族等其他影响因素应相同或相近，或者说除了要对比的因素外（如不同的
药物），其余的干扰因素应当尽可能在组间相同或相近。如，在新药组同常
规用药组疗效比较的研究中，两组的性别、病情、年龄构成等应尽可能相近
（可用相应的分析方法进行检验）。这一点具有普遍性，适用于所有组间比较
的情形。
对样本率（或构成比）的比较应随机抽样，原则上需要进行参数估计，并
做假设检验。但对相对比的统计推断非常困难，对强度型指标的统计推断也不
容易，而对频率分布作统计推断的理论和技术却比较成熟。
第四节参考值范围的确定
一、参考值范围的概念
参考值范围（referencerange），又称临床参考值范围或正常参考值范围
等，是指绝大多数正常动物的各种生理生化指标或者组织、排泄物中各种成分
的含量和各种组织、器官解剖指标等的范围。它源于临床医学中对疫病诊断和
治疗的实际需要，可以帮助区分正常与异常的界限。由于个体差异、体内外环
境的改变，同样一群动物的指标表现会有差别，所以需要正常值的一个波动
范围。比如，牛的正常红细胞数为（5.5~7.0）×10个/mm，猪的正常体温为
38~39.5℃，这些表示了红细胞数和体温指标正常的范围。表2-2列出了健康动
物生命征象参考值。
42
兽医统计学
表2-2健康动物生命征象参考值
动物种类
体温（℃）
脉搏数（次/min）
呼吸次数（次/min）
猪
38~39.5
60~80
18~30
羊
38~39.5
70~80
12~30
犬
37.5~39.2
70~120
10~30
猫
38.5~39.5
110~130
10~30
禽类
40.0~42.0
120~200（心跳）
15~30
二、参考值范围的确定
制定参考值范围的时候，应该注意的问题如下：
（1）合理分类和分组。原则上要对因性别、年龄或者品种不同造成的明显
不同生理生化指标分开考虑，差别不明显时应该合并。
（2）适宜的样本例数。确定参考值范围应有适宜的样本例数。参考值范围
是根据样本的分布来测定的，样本分布越接近总体分布，所得结果越可靠，因
此例数不宜过小。一般来说，参加被测动物的数量应该足够多。要选定足够数
量的正常动物（如果某疫病并不影响要研究的指标，这些患病动物一般可认为
是“正常”的）作为调查对象。
（3）合理确定参考值范围取单侧或者双侧。参考值范围应该根据指标的实
际用途来确定是取单侧还是取双侧。参考值只需确定上限或者下限之一的，称
为取单侧范围。例如，尿铅、血沉等指标过高为异常，正常值范围只需确定上
限；白细胞、体温等指标过高或者过低都是异常的，其正常值范围就需要分别
确定上限和下限。
（4）选定适宜的百分范围。正确选定百分范围对兽医临床实践非常重要。
正常值范围指绝大多数的正常动物的观测值都在这个范围中，但由于最边际的
数值变动起来很大，另外病畜和正常动物的测定值往往有交叉，例如许多病畜
的测定值也会低于正常动物测定的最大值，也可能高于正常动物测定结果的最
小值，所以往往不以这批正常动物所测定的全部结果中的最小值至最大值这个
范围为准。参考值范围的百分数通常取包括95%个体测定值的界限作为正常值
第二章资料的统计描述
43
范围，此外还有使用99%、98%、90%和80%等界限。按照单侧计算，正常值范
围为5%、1%、2%、10%和20%。按照双侧计算，每侧有2.5%、0.5%、1%、5%
和10%
（5）新确定的参考值范围，应该进行医学实践检验、诊断试验评价。当参
考值范围建立后，要评价是否可以用于医学实践，一般需重新观测一部分健康
个体和患病个体，用原观测方法（金标准）与参考值范围判断进行评价。
三、估计参考值范围的方法
估计参考值范围的常用方法根据资料的分布特点不同，主要有以下两种：
（一）正态分布法
正态分布法适于正态分布资料，或数据经过变换服从正态分布的资料。它
受两端数据影响较小，资料分布越接近正态，估计结果越准。估计公式为：
x±zs
（2-23)
x为样本均数，s为样本标准差。z为标准正态分布的分位数，是与正常值范围相
对应的临界值常数，其值可以通过标准正态分布的分布函数表查询。
双侧95%参考值范围：x±1.96s
单侧95%参考值范围：>x-1.64s或<x+1.64s
当计算出样本均数和标准差之后代人即可算出双侧或单侧95%参考值范围。
常用的z值如表2-3所示。
表2-3常用的z值表
参考值范围（%）
单侧
双侧
80
0.842
1.282
90
1.282
1.645
95
1.645
1.960
99
2.326
2.578
44兽医统计学
例如，计算出血清某离子含量平均数和标准差分别为：x=2.105，s=0.408（血清中
某离子含量过高以及过低均异常，因此按照双侧估计95%参考值界限。）据表查
得双侧95%正常值范围的z值为1.96，由公式（2-23），估计95%正常值范围的下
限为2.105-1.96×0.408=1.990，上限为2.105+1.96×0.408=2.905，得出血清某离
子含量的95%正常值范围为1.990～2.905mg。
（二）百分位数法
适于非正态分布资料，当变量值的频数分布不完全呈正态时，百分位数能
更准确地反映出所测数值的分布情况。中位数是百分位数的特例。中位数特别
适用于描述明显偏态分布、或两端无确定数值数据的平均水平。用百分位数估
计参考值范围的方法简便，各种分布形态的资料都适用。
这种方法是把某一组的变量值（例如体重的公斤数、身长的厘米数）按从
小到大的顺序排列起来，编上秩序，然后将全部秩次分为100等分，与x%秩次
对应的数值为第x百分位数，百分位数用P加下标数字（特定百分点）表示，记
为Px。如求第5百分位数，即Ps。
注意，由于样本太小会导致计算结果误差较大，因此只用此种方法要求样
本容量大，一般要求大于200。另外，指标值过大或者过小均为异常。用双侧百
分位数确定正常值范围，需要求出2.5%与97.5%位数，记为P25和P97.50
双侧95%参考值范围：（P2.5，P97.5）
单侧95%参考值范围：>P或<Pg5
第三章
统计表与统计图
46兽医统计学
【例3-1】
2014年8月，某养殖规模较大的集约化养猪场公司要求有关工作人员将
公司其中三个养猪场的饲养管理情况、疾病防治情况和哺乳仔猪的保健情
况进行调查统计后上报，该工作人员根据对该猪场年度仔猪死亡情况调查
的结果编写了一份统计调查报告，主要统计内容包括：年产仔数55000头、
共死亡8900头，其中腹泻死亡数3500头、弱胎死亡数1980头、母乳不足死
亡数1190头、管理不当造成死亡数1910头，其他传染病死亡数320头，并按
这些死亡原因分别计算出各死亡原因导致的仔猪死亡率：6.36%、3.60%、
2.16%、3.47%、0.58%和各死亡原因占死亡数的比率：39.32%、22.25%、
13.37%、21.46%、3.60%
【问题3-1】
（1）该统计调查报告有什么问题？
（2）如何编制统计表来更直观地体现该报告中的死亡统计数据？
（3）最常用的统计图表编制及统计数据分析软件有哪些？
【分析】
（1）该报告数据呈现杂乱状态，无法一眼从中看出该公司三个养猪场
疫病情况。将同性质的资料归纳一体，资料系统化后才能得出正确结论。
（2）统计表能以表格形式来体现被研究对象的特征、内部构成、研究
项目分组之间的数量关系。一个编制合理的统计表可通过有条理地罗列数
据和统计量，避免冗长的文字叙述，方便阅读、比较和计算。
根据该案例的统计数据，编制出该公司三个养猪场年度哺乳仔猪死亡
情况统计表，见表3-1。
第三章统计表与统计图
47
表3一1公司三个养猪场年度哺乳仔猪死亡情况统计表
死亡原因
死亡数（头）
死亡率（%）
占死亡数（%）
腹泻
3500
6.36
39.32
弱胎
1980
3.60
22.25
母乳不足
1190
2.16
13.37
管理不当
1910
3.47
21.46
其他传染病
320
0.58
3.60
（3）随着计算机技术的不断普及，使用统计软件或办公自动化软件
的组件均可以方便地由原始数据编制出统计图和表进行统计分析。美国
Microsoft公司的通用办公软件中的电子表格Excel附带了比较完善的统计分
析功能。它提供了14种之多的图表类型，包括柱形图、条形图、折线图、
饼图、散点图、面积图等，还可以提供丰富的函数功能，包括统计、数学
与三角、数据库、文本、逻辑等共9大类的近400个函数，还能提供辅助决
策的功能，包括数据排序、筛选、统计、单变量求解等，有助于广大医学
科研工作者对医学科研数据进行正确的统计分析。这样的大型表格对于绝
大多数用户来说，是足够的。Excel除具备一般的数据查询、筛选功能外，
还具有强大的统计分析功能，为人们提供了大多数基本的和经典的统计分
析方法。合理利用Excel的统计分析功能，用它进行医学科研的数据统计分
析，界面友好，易学易用，简明快捷。例如，利用Excel可以实现对医学科
研数据的统计描述、假设检验和相关回归分析等。
48
兽医统计学
第一节常用统计表
一、统计表概念、结构和制作要求
广义上，统计表包括调查表、登记表、过渡表以及表达最后结果的统计表
等。狭义上是指表达统计结果的统计表，是指将一系列说明总体特征的统计资
料，按照一定的次序和格式排列形成的表，它是表现、汇总和积累统计资料的
一种有效工具。下面介绍狭义统计表的结构和编制要求。
从外形看，统计表由表号、标题、线条、纵标目、横标目、数字及合计组成。
标题位于表的上方，概括说明表的主要内容。标目用来说明横纵行数字的含义，
并附有单位，如百分比（%）、厘米（cm）、毫克（mg）等。线条多采用三线式，
即顶线、底线、纵标目下的横隔线。有时也在合计之上绘制半条线或一条线。
编制统计表时最常犯的错误有：
（1）标题太长，意思还表达得不清楚；
（2）线条太多，纵横线条交织在一起，再加上表头左上角的“斜线”，使人
眼花缭乱，也不易绘制；
（3）纵横标目安排不当，不便阅读；
（4）表中的“数字”代表什么，读者不得而知。
编制统计表可不拘泥于特定的形式，一个完善构成的统计表应该注意以下
几点：
（5）在表号之后，应该有一个简洁、信息充分和明确定义的标题，包括时
间、地点、事件；
（6）每行和每列都有简短、明确的标题；
（7）有计量单位；
第三章统计表与统计图
49
（8）给出每个得出综合量度（例如百分比）的项自数值，表内的数字必
须准确无误，同一种统计指标各数值准确度一致，各个位数或小数点要上下
对齐，暂缺数字用省略号“”填充，数字不存在用“二”填充。数字为0则
写“0”；
（9）当提供一个汇总统计（如平均数）的时候，要包含精确度量（如置信
区间）
（10）给出的数值必须是有着合适精确度的（有效数字而不是原始数据），
注意同一指标的小数位数相同，数字为0则写“0”；
（11）不要罗列过多信息于一张表中；标目的层次不宜太多，通常1至2层，
最多不适宜超过3层；
（12）表中线条应该尽量少，要注意表中的上下两条横线一般使用粗线，其
他线用细线；
（13）一般主辞位于表左侧，宾辞位于表右侧；
（14）遇有特殊情况需要使用备注时，可以写在表的下面。
二、利用Excel制作统计表步骤
Excel2003之前提供了统计表“自动套用格式”，共提供了17种统计表样式。
一般可以选择简单表，略加修改即可。
Exce12007及以后版本，需要通过下列步骤添加“自动套用格式”：“文
，一，近不，一
三、常用统计表用法举例
（一）简单表
简单表是指主辞没有经过分组，只罗列观察单位或地区、时间、统计指标
50
兽医统计学
的统计表。将反映某事物各种特征的有关信息罗列在一起，由一组横标目和一
组纵标目组成，二者都未进行分组的表，统称为简单表。此类表适合于简单资
料的统计，见表3-2。
表3-2某猪场仔猪死亡情况
死亡原因
死亡数
频率（%）
发育不良
22
27.84
冻死
15
18.99
肠炎
13
16.46
寄生虫
19
24.05
黄白痢
10
12.66
合计
79
100.00
在研究药物对畜禽某疫病的治疗效果时，常需要分析药物的不同种类与对
应疗效是否相关。这类判断两类因子彼此独立或相关的假设检验称为独立性检
验，它按照两类因子的属性类别构成列联表。如果表中的原始数据只有两个分
组标志，而且每个分组标志只有两个水平，称为2×2表或四格表，常用的一般
形式详见表3-3。如何进行统计推断将在第五章进行详细介绍。当有3个或者以
上指标时，称为多为列联表，常用R、C表示行数和列数。即当两个分组标志分
别有R个和C个水平时，称为RxC表，其一般形式见表3-4。
表3-32×2表的常用形式
1
2
合计T
1
O(E)
O2（E2)
T.=O+O12
2
O2(E2)
O2（E22)
T2.=O2+O2
合计T
T.=O+O2
T.=O12+O2
T=n=O1+O12+O2+O22
第三章统计表与统计图
51
表3-4R×C表的常用形式
1
2
C
合计T
On（E)
O（E)
O1c
T.=O+O12
1
2
O2（E1)
O2（E)
0
T2.=O2+O2
R
ORI
OR2
ORc
TR.
合计T
T.
T.2
T.c
T
例如，某猪场为了比较两种药物A（呋喃西林）和B（土霉素+葡萄糖）对
仔猪下痢的治疗效果，抽取了150头下痢的仔猪进行治疗，然后将结果列表，检
验两种药物疗效是否具有显著差异。如表3-5所示。
表3-5A、B两种药物对仔猪下痫的疗效
药物
治愈
死亡
合计T
治愈率（%
A
20（30.00)
30(20.00)
T=50
40.00
B
70(60.00)
30（40.00)
T=100
60.00
合计T.
T.=90
T.=60
T=n=150
100.00
流行病学研究所面对的统计资料丰富多彩，既有自变量，又有结果变量；
既有定性资料，又有定量资料。此时又该如何表达呢？同时表达丰富内容的统计
表有多种形式，其中较好的形式就是采用数据库结构，按这种形式将数据输人
计算机创建数据文件后，便于用通用的统计软件处理数据（详见表3-6。此表的
形式最便于用统计分析软件进行统计分析）。为了研究饲料中钙磷含量对幼猪生
长发育的影响，将钙（A）、磷（B）在饲料中的含量各分4个水平进行交叉分组
试验。选用品种、性别、日龄相同，初始体重基本一致的幼猪48头，随机分成
16组，每组3头，用能量、蛋白质含量相同的饲料在不同钙磷用量搭配下各喂一
组猪。经过2个月试验，幼猪增重结果（kg）列于表3-6。
52
兽医统计学
表3-6不同钙磷水平对猪增重（kg）的影响试验数据
组别
B1
B2
B3
B4
22.0
30.0
32.4
30.5
A1
26.5
27.5
26.5
27.0
24.4
26.0
27.0
25.1
23.5
33.2
38.0
26.5
A2
25.8
28.5
35.5
24.0
27.0
30.1
33.0
25.0
30.5
36.5
28.0
20.5
A3
26.8
34.0
30.5
22.5
25.5
33.5
24.6
19.5
34.5
29.0
27.5
18.5
A4
31.4
27.5
26.3
20.0
29.3
28.0
28.5
19.0
（二）复合表
复合表是由两组及以上的横标目和纵标目结合起来、或一组横标目及两组
以上的纵标目结合起来以表达它们之间关系的统计表。复合表可以利用更多的
标志对总体进行更深人地研究。
当实验研究中，按一个原因（称为单因素）的多种状态（称为多水平）分
组进行实验时，统计表就是复合表。例如，表3-7中的免动脉张力（因素）分成
肺动脉、肾动脉、颈动脉3个水平。所以这种表属于复合表。
表3一7低温对兔动脉张力的影响
实验温度
免数
张力（g，X±S）
（℃）
（只）
肺动脉
肾动脉
颈动脉
37
8
0.502±0.004
0.204±0.005
2.01±0.06
16
8
0.335±0.036
0.093±0.041
1.60±0.09
其实，统计表在实际工作中有更复杂的情况，但总的来说，统计表应该言
简意，中心突出，符合统计表的一般规范。
第三章统计表与统计图
153
第二节常用统计图
一、统计图概念、结构和制作要求
统计表的资料用几何图形或者图案等形式表示即成为统计图。统计图能生
动地表达事物间的大小和变化趋势，常用的兽医学统计图有柱状图、直方图、
饼图、百分条图和折线图等。应用统计软件中可以作出各种需要的图形，图形
的选择取决于研究资料的性质。一般情况下，连续性资料采用直方图、线图和
散点图，离散性或分类资料常用柱状图、饼图或折线图。
统计图具体部分构成以及制图的基本要求如下：
1.标题。每个图应必备简单明确的标题，常包括内容、时间、地点。位于
图形区域外，一般置于图形下方，贴近图形；
2.主体。即图域。除了圆形图外，长宽之比要美观；
3.标目。横纵轴都应该有标目，并注明度量单位；
4.尺度。横轴的尺度从左至右，纵轴自下向上；
5.数值。从小到大的顺序排列，间隔宽松；
6.图例。需要用图例进行说明，可用不同的线条或者颜色表示不同的事
物。图例一般放在图的右侧或者图的下方。
由于目前统计图多是由软件做成，本文仅叙述常见统计图形的应用场合，
具体如何作图请参见各软件应用手册。Excel的制图功能，它能根据输入表中的
数据自动生成柱状图、饼形图等，大大减轻了手工制图的工作量。Excel的图
表生成简单，可视化窗口模式形象直观，是日常图表生成的有利工具，而且修
饰加工的图形尤其美观。单元格数据与数据分析结果具有“联动”关系，改变
其中一个单元格数据，与之相关的Excel公式或图表就会发生相应的改变，具有
“即改即见”的效果。
54兽医统计学
二、利用Excel的图表绘制统计图
在任意一张空白的电子表格，选择相应的行与相应列，制作一张统计表，
并输入相关的数字；先用鼠标选中这张表格，接着在Excel中单击工具栏上的
“图表”或“插人一图表一图表向导”中“标准类型”选项卡中选择要作的图
形；自动绘制好统计图的有时候并不一定能够满意，需要进行后处理工作。
（1）如果图中表格及纵横轴没有名称，相应的点没有对应的值，那么可以
选中绘图区或图表区，用鼠标右击，选中“图表选项”在弹出的选项卡中选择
“标题”和“数据标志”，在标题中输人相应的名称；在“数据标志”中的数据
标签选项中的“值选项”打上“”；
（2）如果图中没有网格线，就选中绘图区或图表区，用鼠标右击，选中
“图表选项”，在弹出的选项卡中选择“网格线”。
（3）如果对纵轴的数字间隔不满意，就选中统计图绘图区中的纵轴，右击
值”及“主要刻度单位”中输人想要的值即可。
利用Excel绘制统计图的技巧还有很多，在此不进行一一说明，更多技巧请
参阅其他有关书籍。
三、常用统计表用法举例
（一）柱状图
用若干个矩形条的高度表达定性变量中某指标各类别的大小。用一个单位
长度表示一定的数量，根据数量的多少画成长短不同的直条，再把这些直条按
照一定的顺序排列起来，就得到了条形统计图。它用等宽的条的长短或者高低
来表示按某一指标来划分属性种类、等级的次数或者频率分布。例如，数种家
禽对某一寄生虫感染的情况；奶牛的几种疫病的发病率等。条形统计图的特点
第三章统计表与统计图
55
是能清楚地表示出每个项目的具体数目，易于比较数据之间的差别。
在绘制过程中应该注意：
（1）横轴应该作为基线，长条的宽度要相等，标明各个长条的内容；
（2）纵轴尺度从“0”起，间隔必须相等大小，还必须标明纵轴所表示指标
的尺度以及单位；
（3）对于间断性的资料，作图的时候每个矩形之间，应留出一条小间隔；
（4）同一个属性、等级的两个或两个以上的指标的长条应该绘制在一起，
各个长条表示的指标用图例说明，同一个属性种类、等级的各长条间不需留下
间隔。
（5）复式柱状统计图中，表示不同项目的直条要用不同的线纹或颜色区别
开来，并注明图例。
根据上一节常用统计表3-2绘制柱状图如图3-1所示。
25
20
头
15
死亡数
10
5
0
发育不良
冻死
肠炎
寄生虫
黄白痢
死亡原因
图3-1某猪场仔猪死亡情况柱状图
（二）直方图
直方图（histogram）用于反映连续性变量的频数分布，根据频数分布表作
出直方图以表示资料的分布情况。
绘制直方图应该注意：
56
兽医统计学
（1）直方图的纵轴应该从“0”开始，横轴可以不从“0”开始；
转化为相等的频数之后再作图；
（3）直方图中各个矩形之间可以划直线分隔，也可以不划。
例如，低血镁是各种原因引起血镁降低所致的一种矿物质代谢素乱疾病。
最常发生在春季从舍饲转入放牧后数周和夏李牧草生长茂盛的期间，以产续后
2~3周的高产奶牛多发。对200头奶牛的血镁含量进行测定，以组限作为横坐
标，次数作为纵坐标，矩形的高等于次数直方图，如图3-2所示。
45
40
35
30
数
25
15
10
5
血镁含量（mmol/L）
图3-2乳牛血镁含量分布直方图
（三）饼图
饼图是利用圆和扇形来表示总体和部分的关系，用来表示组数不多的品质
资料或者间断性数量资料的内部构成情况。即圆表示总体，圆中的各个扇形分
别代表总体中的不同部分，扇形面积的大小反映部分占总体的百分比。它的特
点是能清楚地表示出各部分在总体中所占的百分比。
绘制饼图的时候应该注意各个扇形应该按照大小顺序或者自然顺序从9时或
者12时的时钟处开始，顺时针方向排列，扇形内要注明简要的百分比数值或者
第三章统计表与统计图
57
文字，必要时加上图例说明各部分内容。
圆心角度的计算是把百分数乘以360°。仍以前文表3-2的数据为例（取整
数）绘制饼图。图形整个面积代表100%，不同颜色代表不同致死病因，其面积
大小的比例代表了不同原因致死数量之比。
黄白痢
13%
发育不良
28%
寄生虫
24%
冻死
肠炎
19%
16%
图3-3某猪场仔猪发病情况分布饼图
（四）百分条图
凡能够画圆圈的资料，可用百分条图表示，尤其在比较几个组内部构成的
时候，通过绘制长款相同的数个直条，以长条面积为100%，用长条内各段面积
所占的百分比来表示各部分在全体中所占的比例。上述饼图也适用于构成比资
料，应用在描述各部分的百分构成。
绘制时注意一定要有标尺，画在图的上方或下方，起始的位置、总长度和
百分条图一致，并和百分条图平行。全长为100%，分成10格，每格10%。按各
部分所占百分比的大小排列，在图上标出百分比。在图外要附图例说明。可以
画几个平行的百分条图以比较不止一个事物。各条图的排列顺序相同、图例相
同。详见图3-4。
58
兽医统计学
乙
14
甲
22
0%
10%20%30%40%50%
60%70%80%90%100%
构成比
水肿病
肠炎
寄生虫病口黄白痢口其他
图3-4甲乙两猪场仔猪不同病因死亡情况百分比条图
（五）线图
线图适用于连续性数量资料，用线段的升降表达一事物随另一事物的变化
趋势。数据点画在组段中间位置，相邻的点用直线连接，图内线条一般不超过5条。
有多条曲线时，用不同颜色、不同图案区分，并附图例加以说明。对于连续型
资料，可以根据次数分布表作出次数分布曲线。图3-5是某地区2001—2014年痢
疾与百日咳死亡率（1/100000）。本例中，以年份为横坐标，死亡率为纵坐标，
将数据用不同线型连接成线。
0.160
0.140
痢疾
0.120
0.100
0.080
0.060
死
0.040
百日咳
0.020
9
0.000
2000
2002
2004
2006
2008
20102012
2014
2016
年份
第三章统计表与统计图
59
（六）散点图
散点图多用于相关回归分析的预分析中，表示两个不同指标变化的关系，
图中用点的密集程度和散布趋势表示两指标间的相关关系和相关方向。散点图
与线图不同的是，对于横轴上的每个值，纵轴上可以有多个点与其相对应，且
点与点之间不能用直线连接。
例如，为了提高奶牛的繁殖率，可以采用氢氛激光对不孕牛进行照射治疗。
经过收集氮氢激光照射母牛的天数与对应血红蛋白含量变化的数据资料，可以
作出图3-6散点图。由图可以看出血红蛋白含量与照射天数呈现直线状关系。在
以后章节讨论如何求出表示简单相关程度和性质的直线相关系数。
8.5
8.0
7.0
量
合6.5
白
6.0
5.5
5.0
0
2
4
6
8
10
照射天数
图3-6照射天数与血红蛋白含量散点图
第四章
变量的分布及应用
62
兽医统计学
【例4-1】
某养猪场为50头仔猪配备了一台自动饮水器，观察并记录仔猪的饮水情
况。发现平均每半小时约有5头仔猪到饮水器处饮水。每半个月记录一次仔猪
的体重，2月龄仔猪体重数据处理后得到其均数为20kg，标准差为4.5kg。该
养猪场所在的区域发生区域性猪瘟疫情，每只仔猪患上猪癌的概率为10%。
【问题4-1】
（1）这50头仔猪的体重服从哪种分布？2月龄体重在15.5～24.5kg范围
内的仔猪大约有多少只？
（2）每半小时内饮水的仔猪数目服从哪种分布？半小时内有3只仔猪饮
水的概率是多少？
（3）该养猪场患猪瘟仔猪数目服从哪种分布？至多有3头仔猪患猪瘟的
概率是多少？
（4）对仔猪进行猪瘟诊断，诊断出2只感染时已检测出的未感染仔猪数
目服从哪种分布？
【分析】
（1）这50头仔猪的体重服从正态分布，2月龄仔猪体重服从N（20，4.52），
2月龄体重在15.5~24.5kg范围内的仔猪约有50×68.27%~34只。
（2）每半小时内到达饮水器处饮水的仔猪数目服从参数为5的Poisson分
布，半小时内有3只仔猪到达饮水器处的概率为0.14。
（3）该养猪场患猪癌仔猪数目服从参数为50、0.1的二项分布，至多有3
头仔猪感染猪瘟的概率为0.25。
（4）检测出2只患病时已检测出的未感染的仔猪数目服从参数为2、0.1
的负二项分布。
上述问题都涉及了概率分布这个概念。概率分布是一种理论模型，运用该
模型可以计算事件发生的概率。概率分布描述了所有互斥事件是怎样分布的，
第四章变量的分布及应用
63
并且以等式或图表的形式呈现出来，即概率分布描述了随机变量所有可能的取
值以及相应的概率。如果一个变量能够以固定的概率取不同的值，这个变量就
称为随机变量。所有可能的取值为有限个（可以穷举）的随机变量是离散型随
机变量，如果变量的所有取值是连续的，则这个变量是连续变量。下面介绍四
个常用分布：正态分布、二项分布、泊松（Poisson）分布和负二项分布。
第一节正态分布
一、正态分布的概念
正态分布又名高斯分布，是自然界最常见的分布之一，服从正态分布的变
量是连续型随机变量。奶牛日均产奶量、健康马的红细胞数目、随机测量误差
等都服从正态分布。正态分布是具有两个参数u和的连续型随机变量的分布。
习惯上用N（，）表示均数为u，标准差为o的正态分布。服从正态分布的随
机变量的取u邻近的值概率大，而远离u值的概率小；o越小分布越集中在u附近，
o越大分布越分散。
161频率/组距
14
12
10
8
6
4
2
0
-2
10
15
20253035404550
测量值
图4-1正态分布示意图
64
兽医统计学
图4-1称为频率密度图，它以各长方形面积代表各组段的频率。直条的高度
为频率除以组距称为频率密度。
二、正态分布的特征
正态曲线呈钟型，两头低，中间高，左右对称，曲线与横轴间的面积总等
于1。该曲线的函数表达式f（x）称为正态分布密度函数
1_（x-μ)²
f(x)=-
e2o²
√2π
（4-1)
其中，u为总体均数，o为总体标准差。
正态分布曲线有如下特征：
（1）关于x=u对称；
（2）在x=u处取得概率密度函数的最大值，在x-μ±o处有拐点；
（3）曲线下面积为1；
（4）u决定曲线在横轴上的位置，u增大，曲线沿横轴向右移；u减小，曲线
沿横轴向左移；
（5）o决定曲线的形状，当μ一定时，o越大，数据越分散，曲线越扁平；
越小，数据越集中，曲线越陡峭；
（6）任何正态分布，其概率密度曲线下面积都有一共同规律：以均数为
中心，正负1个标准差（μ一0，μ+o）内，正态分布曲线下总面积等于68.27%；
正负2个标准差（μ-2o，μ+2o）内，面积为95.44%；正负3个标准差（μ-30，
μ+3o）内，面积为99.74%
三、标准正态分布
标准正态分布是一种特殊的正态分布，标准正态分布的u和分别为0和1。
通常用V（0，1）表示。对于任一服从正态分布的随机变量都可以通过Z变换转
第四章变量的分布及应用
65
化成标准正态分布
Z=x-μ
(4-2)
D
转换后Z的密度函数为：
1
f（Z=2）=
√2π
(4-3)
这个分布为标准正态分布。
四、正态分布的应用
正态分布的用途很广，众多微小且独立的随机因素（其中没有一个是主导
的）影响的总结果，一般表现为正态分布（中心极限定理）。如随机误差的分
布、某些生理现象的频率分布等，都可认为是正态分布。某些分布，如二项分
布、Poisson分布、t分布等的极限分布也是正态分布。
【例4-2】
低血镁是各种原因引起血镁降低所致的一种矿物质代谢紊乱疾病。最
常发生在春季：从舍饲转入放牧后数周和夏季牧草生长茂盛的期间，以产
续后2～3周的高产奶牛多发。对某牧场500头奶牛的血镁含量进行测定，测
得血镁含量平均数u为2.2mg/dL；血镁含量标准差o为0.3mg/dL。
（1）血镁含量在1.9~2.5mg/dL范围内的奶牛约有多少头？
（2）奶牛血镁含量正常值为1.8～3.0mg/dL，血镁含量在正常范围内的
奶牛约有多少头？
（3）血镁含量最低的20%的奶牛血镁含量不高于多少？
解：奶牛的血镁含量是近似服从正态分布的，将该牧场奶牛的血镁含量记
66
兽医统计学
为X（mg/dL），X的均数μ=2.2，方差o²=0.3²，所以X服从正态分布N（2.2，0.3²）
（1）μ-0=2.2-0.3=1.9，μ+0=2.2+0.3=2.5，则血镁含量在1.9~2.5mg/dL
范围内的奶牛的数量占总数量的68.27%，即血镁含量在1.9～2.5mg/dL范围
内的奶牛约有500×68.27%~341头；同理可得血镁含量在1.6～2.8mg/dL范围
内的奶牛约有500×95.44%~477头，血镁含量在1.2~3.1mg/dL范围内的奶牛
约有500×99.74%~498头
（2）Excel中内置了80个统计函数，利用这些统计函数可以很方便地
解决在日常工作中遇到的许多统计问题。在本例中运用正态分布概率函数
NORMDIST（x，mean，standard-dev，cumulative）可以算出X=3.0的累计概
率为“=NORMDIST（3，2.2，0.3，1）”=0.996，X=1.8的累计概率为0.091，
则血镁含量在正常范围内的奶牛数量占总数量的0.996-0.091=0.905，其数量
为500×0.905=450头。第1问也推荐使用这种方法解答。
（3）运用函数NORMINV（probability，mean，standard-dev）可以算出
累计概率为0.2时，左分位数为1.948，则血镁含量最低的20%的奶牛血镁含
量不高于1.948mg/dL。
第二节二项分布
一、二项分布的概念
二项分布是描述随机现象的一种常用的概率分布形式，它是一种离散型随
机分布，因与二项式展开式相同而得名。二项分布即重复n次的伯努利试验所产
生的分布。在一次实验中只有两种可能的结果，而且是互相对立的、独立的，
与其他各次实验结果无关，结果事件发生的概率在整个系列试验中保持不变。
第四章变量的分布及应用
67
如果每个观察对象阳性结果的发生率为π，阴性结果发生率为（1一π），重复观
察n次后发生阳性结果的观察对象个数X的概率分布记作B（n，π），二项分布的
概率函数P（X）可用公式来计算：
P(X)=C²π(1-π)-x
(4-4)
其中
n!
C=
X!n-X)!
X的取值为0，1，"，n。
二、二项分布的特征
二项分布具有以下几个特征。
1.图形特征在n次独立重复的实验中，若某事件发生的概率为π，则该事
件发生的次数X服从二项分布。以X为横轴，以对应的P（X）为纵轴，即可绘出
二项分布的图形。二项分布的图形取决于π与n的大小，高峰在nπ处或附近；π为
0.5时，图形是对称的，π不等于0.5时，分布不对称，且对同一n，π离0.5越远，
对称性越差。对同一π，随着n的增大，分布逐渐趋于对称。当n一时，只要π
不太靠近0或1，二项分布趋于对称。
当π-0.5时，n为10和3对应的二项分布详见图4-2a和图4-2b。
f(x)
f(x)
0.4
0.4
0.35
0.35
0.3
0.3
0.25
0.25
0.2
0.2
0.15
0.15
0.1
0.1
0.05
0.05
0
10
0
2
图4-2aπ=0.5与n=10对应的二项分布
图4-2bπ=0.5与n=3对应的二项分布
68
兽医统计学
2.均数和标准差如果每次试验出现阳性的概率均为π，进行n次独立重复
试验，出现X次阳性，则理论上有二项分布X的总体均数为：
μ=nπ
（4-5)
X的方差为：
²=nπ（1-π）
(4-6)
X的标准差为：
=√nπ（1-π)
(4-7)
若将出现阳性结果的频率记为：
p=
则p的总体均数
μ=π
(4-8)
p的方差
π（1-π)
n
(4-9)
p的标准差
π（1-π)
n
(4-10)
三、二项分布的正态分布近似
二项分布图取决于π和n，当π接近0.5时，图形是对称的；π离0.5越远，对
称性越差，但随着n增大，分布趋于对称。理论上可以证明，不管π如何，当n足
够大时，只要π不太靠近0或1，二项分布B（n，π）近似正态分布N（nπ，nπ
（1一π））。由于二项分布是离散型变量分布，因此需经校正才可用正态近似方
法计算。
第四章变量的分布及应用
69
四、二项分布的应用条件
二项分布的应用条件如下：
（1）各观察单位发生某一结果的概率只能取相互对立的两种结果之一，不
允许考虑“可疑”等模糊结果，属于二分类资料。
（2）已知发生某一结果的概率π不变，其对立结果的概率为1一π，实际工作
中要求π是从大量观察中获得的比较稳定的数值。
（3）n次试验在相同条件下进行，且各观察单位的结果互相独立。即每个观
察单位的观察结果不会影响到其他观察单位的结果。
五、二项分布的应用
在日常的兽医工作中，经常会遇到一些事件，其结果可分为两个彼此对立
的类型，如个体的存活与死亡、动物的雌性与雄性、检查结果的阴性与阳性等。
这类事件符合二项分布的定义，可以运用二项分布来进行描述和解决问题
【例4-3】
假设仔猪黄痢病在常规治疗下病死率为20%
（1）求5头病猪治疗后死亡头数各可能值相应的概率；
（2）求5头病猪治疗后至多2头死亡的概率和恰好2头死亡的概率。
解：每头病猪接受常规治疗后，只有存活和死亡这两种相互对立的结
果，因此如果记5头病猪治疗后死亡头数为X，则X服从B（5，0.2）。
（1）全部可能的X取值为0、1、2、3、4、5，可以利用公式（4-4）
计算出X取各可能值时相应的概率，也可以运用Excel内置的二项分布概
率函数BINOMDIST（numer_s，trials，probability_S，cumulative）来计
算。令numer_s分别等于0、1、2、3、4、5，trials=5，probability_s=0.2，
cumulative=FALSE即可算出相应的结果，详见表4-1。
70
兽医统计学
表4-15头感染黄痢的仔猪在常规治疗下的病死头数概率分布
死亡头数
0
1
2
3
4
5
概率
0.32768
0.40960
0.20480
0.05120
0.00640
0.00032
（2）5头病猪治疗后至多2头死亡的概率P（X≤2）=P（X=0）+P（X=1）+P
（X=2），上表中前三列的概率和即为所求的结果，同样也可以运用Microsoft
Excel内置的二项分布概率函数BINOMDIST（numer_s，trials，probability_s，
cumulative）来计算，既方便又准确。令numer_s=2，trials=5，probability_
s=0.2，cumulative=TURE即可算出相应的结果为0.9421，这是5头病猪治
疗后至多2头死亡的概率。而要求5头病猪治疗后恰好2头死亡的概率则令
cumulative=FALSE，相应的结果为0.2048。
第三节Poisson分布
一、Poisson分布的概念
Poisson分布是一种离散型分布，用以描述单位时间、空间、面积等罕见
事件发生次数的概率分布。它可以看成为二项分布的一种极限情形。例如，
每毫升水中的大肠杆菌数、1000名新生儿中染色体异常出现的概率、羊群中羊
只感染布鲁氏菌病死亡数，这些事件都是罕见事件，可近似认为服从Poisson
分布。
Poisson分布一般记作P（A）。其中为Poisson分布的唯一参数。如果某事件
的发生是完全随机的，则单位空间或单位时间内，事件发生0次、1次、2次、“
第四章变量的分布及应用
71
的概率为
P（x）=
(4-11)
ix
式中，=nπ为Poisson分布的总体均数，X为观察单位内某稀有事件的发生次数；
e为自然对数的底，X的取值为0，1，。
二、Poisson分布的特征
（1）Poisson分布的总体均数和总体方差相等，均为l。
（2）Poisson分布的观察结果有可加性。即若X~P（），Y~P（），且x，
Y相互独立，则X+Y~P（+）。
（3）Poisson分布式二项分布的极限形式，二项分布中当π很小，n很大时，
二项分布逼近Poisson分布。
（4）Poisson分布的图形呈正偏态分布，当l≥50时，可按照正态分布原理处
理。Poisson分布图形如图4-3所示。
μ=3
μ=5
0.1800
0.1500
0.1200
0.1000
P(X)
P(X)
0.0600
0.0500
0.0000
0.0000
0
8
0
12
X
(a)
(b)
图4-3μ取不同值时的Poisson分布图
三、Poisson分布的正态近似
一般情况下，当L≥20时，Poisson分布资料可按正态分布处理。Poisson
分布也是离散型变量分布，因此要对概率函数作校正。其正态近似计算方
72
兽医统计学
法为：
k+0.5-n
P(X≤k)=
P(X≥k)=1-P(X<k)=1-
√2
e-x
k,+0.5-
k-0.5-2
P（k≤X≤k）=
12
（4-12)
四、Poisson分布的应用
【例4-4】
猪大肠杆菌可引起仔猪黄痢、仔猪白痢和猪水肿病这些疫病，通过对
仔猪粪便进行细菌检验可判断大肠杆菌是否超标。某养猪场进行猪大肠杆
菌检验时，对300个单位容积内的猪大肠杆菌计数结果进行分析后，得知单
位容积内的平均猪大肠杆菌数约为10。
（1）单位容积内猪大肠杆菌数为5、10、15的概率分别是多少？
（2）单位容积内猪大肠杆菌数至少为5的概率分别是多少？
（3）假设对另一养猪场进行细菌检验后发现其单位容积内的平均猪大
肠杆菌数约为7，现将这两个养猪场的检验物进行充分混合并检验，此时单
位容积内的平均猪大肠杆菌数约为多少？
解：单位容积内的猪大肠杆菌数X服从Poisson分布，并且单位容积内的
平均猪大肠杆菌数约为10，即X~P（10）
（1）可以利用公式（4-11）计算出X分别取值为5、10、15时相应的概率，
也可以运用Excel内置的二项分布概率函数POISSON（X，mean，cumulative）
来计算。令X分别等于5、10、15，mean=10，cumulative=FALSE即可算出相
第四章变量的分布及应用
73
应的结果，结果详见表4-2。
表4-2单位容积内猪大肠杆菌数
单位容积内猪大肠杆菌数
5
10
15
概率
0.037833
0.125110
0.034718
（2）单位容积内猪大肠杆菌数至少为5的概率可以用以下公式计算：
P（X≤5)=P（X=0）+P（X=1)+P（X=2）+P（X=3）+P（X=4)+P（X=5），分别计算
X=0、1、2、3、4、5的概率，再将它们加总求和即可得单位容积内猪
大肠杆菌数至少为5的概率。但显然这种方法是比较复杂的，可以运用
POISSON（x，mean，cumulative）来很方便地计算出结果。令X=5，mean=10，
cumulative=FALSE即可算出单位容积内猪大肠杆菌数至少为5的概率为
0.067086。
（3）记第二个养猪场单位容积内的猪大肠杆菌数为Y，则Y服从P（7），
由于Poisson分布的观察结果有可加性，因此X+Y服从P（17）的Poisson
分布。
第四节负二项分布
一、负二项分布的概念
负二项分布也称为帕斯卡分布，是一种离散型概率分布。负二项分布常用
于描述生物群聚性，医学上用来描述传染性或非独立性疫病的分布和致病生物
的分布。负二项分布与二项分布的区别在于：二项分布是固定试验总次数n的独
立试验中，成功次数k的分布；而负二项分布是所有到成功r次时即终止的独立
74
兽医统计学
试验中，失败次数k的分布。
若随机变量X服从参数为r和p的负二项分布，则记为X~NB（r，p），其中r
为实验成功的次数，p为在一次独立试验中事件成功的概率。
若X~NB（r，p），则X的概率分布为
P（X=k）=Ck+-p（1-p)，其中k=0，1，2，
（4-13）
表示已知一个事件在伯努利试验中每次的出现概率是p，在一连串伯努利试
验中，一个事件刚好在第k+r次试验出现第r次的概率。
二、负二项分布的特征
（1）当r=1时，负二项分布等于几何分布，此时概率分布为P（X=k）=
p(1-p)*;
r(1-p)
r(1-p)
（2）若X~NB（r，p），则X的期望值为
，方差为
p
p
0.12
0.25
mr=5.p=0.3
mr=5.p=0.6
0.1
mr=3.p=0.3
0.2
r=3.p=0.6
0.08
0.15
0.06
0.1
0.04
0.02
0.05
0
135791113151719
135791113151719
图4-4r、p取不同值时负二项分布的概率分布图
三、负二项分布的应用
负二项分布在医学中主要用于聚集性疾病及生物、微生物、寄生虫分布模
第四章变量的分布及应用
75
型等的研究。具体地说，当个体间发病概率不相等时，可以拟合负二项分布。
如单位观察对象（人群、畜群等）内某传染病的发病数目，某地方病、遗传病
的发病数目等，这些均可通过负二项分布进行处理。
【例4-5】
假设某地山羊布鲁氏菌病阳性率为10%，为获取3只阳性羊，对该地山
羊逐一进行检测。
（1）平均需要检测多少只山羊才能恰好检测出3只病羊？
（2）检测出3只病羊时恰好共检测了25只山羊的概率是多少？
解：检测出3只病羊时检测结果为阴性的山羊总数目为X，则X~NB（3，0.1）
r(1-p)
（1）负二项分布的期望为
阴性的山羊约有3×（1-0.1）÷0.1=27只，因此平均需要检测27+3=30只山
羊才能恰好检测出3只病羊。
（2）可以按公式（4-14）求出X=25一3=22的概率，也可以用Excel内
置的统计函数NEGBINOMDIST（number_f，number_S，probability_s）来计
算令number_f=22，number_s=3，probability_s=0.1，即可得到P
（X=22）=0.02718。
第五章
总体均数的估计及假设检验
78
兽医统计学
【例5-1】
某水产养殖户想知道自家养殖的小龙虾平均体重。于是，他从养殖的
小龙虾中随机抽取100只，分别测量其体重并记录，然后计算这100只小龙
虾的平均体重。
【问题5-1】
（1）这种测量小龙虾平均体重的方法是否合理？
【分析】
（1）如此估计所养殖小龙虾的平均体重只是一种点估计，尽管合理，
但不够准确。为了更合理给出样本均数对总体均数的估计，应该考虑到抽
样误差的存在，借助抽样分布对总体均数作出估计。
（2）想要了解总体的特征（所养殖小龙虾的平均体重），最直接的方法
是对总体中的每个观察单位进行测量（即普查），通过整理分析即得总体参
数。但大多数情况下，这往往是不可能的，也是没有必要的。实际工作中
更常用的是从总体中随机抽取样本，用样本信息推断总体特征。一种方法
是直接将样本统计量作为总体参数的估计（如本例）；另一种方法是计算
置信区间。因为采用区间估计方法考虑了抽样误差，所以更为合理，也更
常用。
第五章总体均数的估计及假设检验
79
第一节抽样误差与标准误
由于总体中个体变异的存在，从某一总体中随机抽取一个样本，所得样本
统计量与相应的总体参数往往是不同的，这种差异称为抽样误差（sampling
error）。在抽样研究中，抽样误差是不可避免的，由于其产生的根本原因是生
物个体的变异性，故样本均数的抽样分布（samplingdistribution）具有如下特
点：①各样本均数未必等于总体均数；②各样本均数间存在差异；③样本均
数的分布很有规律，围绕着总体均数，中间多、两边少，左右基本对称，即服
从正态分布；④样本均数之间的差异明显小于原始变量间的差异。样本均数
的标准差，通常称为标准误（standarderrorofmean，SEM），可用于反映均数
抽样误差的大小。若随机变量x的均数为u，方差为o，则样本均数的均数仍为u，
均数的标准误为：
x=丁n
(5-1)
在实际工作中，由于总体标准差o常常未知，而用样本标准差S来估计。因
此均数标准误的估计值为：
S=
S
（5-2）
由上述两公式可见，均数标准误的大小与标准差的大小成正比，而与样本
量n的平方根成反比。即可通过增加样本量n来减少均数的标准误，从而降低抽
样误差。
80
兽医统计学
第二节t分布
根据中心极限定理，即使统计量所来自的总体不服从正态分布，当样本量
足够大时，统计量的分布也近似服从正态分布。第四章介绍正态分布时，提到
了标准正态变换，由公式z=（x一u）/o可将一般正态分布N（μ，o）转化为标
准正态分布V（0，1）（即z分布）。同样，如果样本均数X的分布服从一般正态
分布N（u，ox）或N（μ，o/n），则可由公式：
n-X
Z=
/√n
（5-3)
将一般正态分布转化为标准正态分布N（0，1）。
但是，由于在实际研究中通常不知道总体标准差。，需要用样本标准差S来
X-μ
t~t（v)。其中，v为自由度，它决定了t分布的形状。
一、t分布的概率密度函数
英国统计学家WilliamS.Gosset于1908年以笔名“Student”发表了一篇论
文，提出了t分布理论，因此t分布又称为学生t分布（StudentDistribution），其
概率密度函数为：
V
+
f(t)=
/VT
其中：
第五章总体均数的估计及假设检验
81
S/√n
(5-4)
r（·）为伽玛函数符号，它是已知函数；π为圆周率；v表示自由度。如果
以t为横坐标，f（t）为纵坐标，则可绘制出t分布曲线，如图5-1所示。
f(t)
v一o（标准正态曲线）
=5
-5.0
-2.0
1.0
4.0
t
图5-1不同自由度的分布曲线
二、t分布的特点
由图5-1可见，对于不同的自由度，t分布有不同的曲线。可总结t分布的特
点如下：
（1）t分布为单峰分布，曲线在t=0处最高，并以t=0为中心左右对称。计
算所得r值可以是正数，也可以是负数。
（2）与z分布（即标准正态分布）相比，曲线最高处较低，两侧尾部翘得
较高。
（3）t分布曲线是一簇曲线，其形状变化与自由度的大小有关，自由度一旦
确定，则分布的形状也就确定了。自由度越小，则值越分散，曲线越低平；随
着自由度的增大，t分布曲线逐渐接近z分布曲线，t分布的极限分布为z分布（即
标准正态分布）。
（4）t分布曲线下的面积有一定的规律性，例如，自由度v=9时，t≤-1.833
82
兽医统计学
的（双侧）曲线下面积也为0.05[见图5-2（b）]
0.050.025
0.025
0
1.833
-2.262
0
2.262
(a)
(b)
图5-2自由度v=9时单侧（a）与双侧（b）t分布曲线下面积为0.05
令P=P|t>tp2v)，它是样本统计量的绝对值大于等于t界值的曲线下面积。
当P已知时，通过查表，可以得到不同自由度v的单侧或双侧P值对应的t界值为
或tp2.v；或者通过自由度v和计算所得统计量值，查表得到近似P值。
第三节总体均数的估计
一、置信区间的概念
参数估计（estimationofparameters）是以样本统计量作为未知总体参数
的估计量，并通过对样本各单位的实际观察取得样本数据，计算样本统计量的
取值，把它作为总体参数的估计量。
参数估计包括点估计和区间估计。点估计是直接以样本统计量作为相应总
体参数的估计量。例如，本章开买实例中所用的方法即是用样本均数作为总体
均数的点估计量。点估计的优点在于它能提供总体参数的具体估计值，可以直
接作为决策的数量依据。但是，点估计没有考虑抽样误差。而区间估计是按预
第五章总体均数的估计及假设检验
83
先给定的概率（1一α），确定包含未知总体参数的一个数量范围，该范围称为参
数的可信区间（又称置信区间，confidencebound/confidenceinterval，Cl）；
预先给定的概率1一a称为置信度（又称置信度，confidencelevel），常取95%或
99%，如没有特别说明，一般取双侧95%。
置信区间通常由两个数值即置信限（confidencelimit，CL）构成。其中较小
的值称为置信下限（lowerlimit，L），较大的值称为置信上限（upperlimit，U），
一般表示为L~U。
二、总体均数置信区间的计算
总体均数置信区间的计算方法，随总体标准差o是否已知，以及样本量n的
大小而异，通常有z分布和t分布两类方法。
1.o已知总体均数的置信区间
o已知时，总体均数u的双侧100（1一α）%置信区间为：
（X-Za2Ox，X+Za2Ox)
(5-5)
或简写为：
X±Za2Ox
其中，x服从总体均数为μ，总体标准差为ox=o√n的正态分布，即
x~N（μu,o²/n)；Za为标准正态分布曲线下两侧尾部面积各α/2的界值。其置信
区间可表示为图5-3的中间部分。
0.2
0.1
面积：100（1-a)%
0
μ-ZanOx
μ+Zanxx
图5-3总体均数u的双侧100（1一α）%置信区间
84
兽医统计学
令α=0.05，则有100（1-α）%=95%，总体均数μ的双侧95%置信区间为：
（x-1.960x，x+1.960x)
其中，z0.052=1.96，ox=o/√n，n为样本量。
o已知时，总体均数u的单侧100（1一α）%置信区间为：
右侧：
（x-2a0x，00）或>x-zax
(5-6a)
左侧：
（-00,x+za0x）或<x+zαx
（5-6b)
其中，服从总体均数为μ，总体标准差为ox=o/√n的正态分布，即
x~N（μu,o²/n)；z为标准正态分布曲线下某一侧尾部面积为α的界值。置信区
间（X-zα0x，∞）与（-oo，X+za0x）可分别表示为图5-4的左图与右图。
0.2
0.1
面积：100（1-a)%
面积：100（1-α%
μ-Zaox
μ
X
μ+Zx
图5-4总体均数u的单侧100（1-α）%置信区间
令α=0.05，则有100（1-α）%=95%，总体均数u的单侧95%置信区间为：
（x-1.645ox，00）或（-00，X+1.645x）
其中，Zo.05=1.645，x=o/√n
2.o未知时总体均数的置信区间
o未知时，采用样本标准差S替代，此时样本均数的分布不再服从z分布，而
是服从t分布。总体均数u的双侧100（1-α）%置信区间的公式应改变为：
(x-ta2，vSx,X+ta2，vSx)
(5-7)
第五章总体均数的估计及假设检验
85
或简写为：
X±ta2vSx
其中，x服从自由度v=n-1的t分布，样本标准误为Sx=S/√n，ta2为t分布曲
线下两侧尾部面积为a/2、自由度为v对应的界值。aSx称为置信区间的精
密度，它等于置信区间宽度的一半，意指置信区间的两端点离样本均数又有
多远。
【例5-2】
（续例5-1）假如从养殖的小龙虾中随机抽取100只测重，均数为47.2g，
标准差为19.6g，估计其抽样误差和总体均数的95%置信区间。
解：抽样误差大小即标准误为：
S
19.6
=1.96（g）
因为总体标准差未知，所以可以采用公式（5-7）计算总体均数的95%
置信区间为：
47.2±t0.05/2.99S元
其中，.052.9=1.984[可由Excel函数“=TINV（0.05，99）”获得]，将
Sx=1.96代入上式有95%置信区间为：（43.31，51.09）。
三、总体均数置信区间与参考值范围的区别
总体均数的置信区间与个体值的参考值范围无论在含义、用途还是计算上
均不相同。实际应用时，不能将两者混淆。现将其特点总结列表5-1，以说明其
区别。
86
兽医统计学
表5-1总体均数的置信区间与参考值范围的区别
区别点
总体均数置信区间
参考值范围
按预先给定的概率，确定的未知参数u的可能范
围。实际上一次抽样算得的置信区间要么包含
“正常人”的解剖、生
了总体均数，要么不包含。但可以说：当a=0.05
理、生化某项指标的波
含义
时，95%C1估计正确的概率为0.95，估计错误的
动范围
概率小于或等于0.05，即有95%的可能性包含了
总体均数
总体均数的波动范围
个体值的波动范围
计算
o未知：x±ta2.Sx
正态分布：X±zaS
公式
o已知或o未知但n>100：X±za2或X±z2Sx
偏态分布：Px~P100-x
绝大多数（如95%）观
用途
总体均数的区间估计
察对象某项指标的分布
范围
a2（对应于双尾概率），也可用t
**Za2（对应于双尾概率），也可用z
第四节假设检验概述
一、假设检验的概念与原理
假设检验（hypothesistest）是通过对样本中所蕴含的信息进行加工和处
理，来对总体情况进行推断、判断。它是统计推断的另一项重要组成部分，是
第五章总体均数的估计及假设检验
87
参数估计的延续，是对参数估计在统计上的验证与补充。假设检验首先对考察
总体的分布形式或总体的某些未知参数事先作出某些假设，然后根据检验对象
构造合适的检验统计量，并经过数理统计分析，确定在原假设满足的情况下该
统计量的分布；在预先给定的显著性水平下，从分布中得出鉴别对原先假设的
拒绝域和接受域的临界值；之后由所抽取的样本资料计算样本统计量，并将样
本统计量与临界值进行比较，从而对所提出的原假设作出统计判断：是接受还
是拒绝原假设（如图5-5）
拒绝区间（a/2）
拒绝区间（a/2）
接受区闸（1-α）
临界值1
临界值2
图5-5假设检验
假设检验所遵循的推断依据是统计中的“小概率原理”。也就是说，之所以
拒绝原假设，并不是因为它存在逻辑的绝对错误，而仅仅是因为它存在的可能
性很小。根据“小概率原理”，小概率事件在一次试验中儿乎是不会发生的。如
果在原假设正确的条件下计算出某一结果发生的概率很小，理应在一次试验中
不至于发生，然而在一次试验中事实上文发生了，则认为原假设不正确，因而
拒绝接受。
P值检验的原理：给出原假设（也称零假设，nullhypothesis）后，在假定
原假设正确的情况下，利用样本数据，可以计算出检验统计量及其对应的概率，
这个概率便是P值。P值间接地给出了样本值在原假设成立条件下发生的概率。
而后将此概率值跟事先给出的显著性水平值a进行比较。如果该值小于α，表明
原假设为小概率事件，根据上述的“小概率原理”，就可以否定原假设，而取对
应的备选假设。如果该值大于α，就不能拒绝原假设。
假设检验的理论和方法纷繁复杂，但具体到计算机操作，只需要掌握两点
88
兽医统计学
就足够了：一是原假设，二是P值。SPSS等统计软件的各种假设检验方法所输
出结果均给出了P值。于是，只要知道原假设，就可以根据P值和a的大小关系
来得出正确的推断。
二、假设检验的基本步骤
下面以检验样本均数文对应的总体均数u是否等于某一给定总体均数u为
例，说明假设检验的基本步骤。
一般情况下，假设检验可按如下4步进行。
第一步：建立检验假设，确定检验水准。
原假设H：=Ho，即两总体均数相等，差异仅由抽样误差所致。
备择假设H：μ≠μ（包括u<μ与u>μo，所以为双侧），其差异不仅仅由抽
样误差所致，两总体均数本身也存在差异。
确定检验水准α=0.05（通常情况下，控制I类错误的概率在0.05或以下）。
根据专业知识及数据特征，备择假设H也可以设为如下形式：
H：u<μo，单侧。
H：μ>μo，单侧。
选用双侧检验还是单侧检验，需要根据数据的特征及专业知识进行确定。
若比较甲、乙两种方法有无差异，研究者只要求区分两种方法有无不同，无须
区分何者为优，故应选用双侧检验。若甲法是在乙法基础上改进而得，已知如
此改进可能有效，也可能无效，但不可能改进后反不如以前，故应选用单侧检
验。没有特殊专业知识说明的情况下，一般采用双侧检验即可。
第二步：选择检验方法和计算检验统计量。
根据资料的类型和分析目的等确定相应的检验统计量，并进行计算。例如，
在总体方差已知情况下，比较两总体均数间的差异常采用z检验；在总体方差未
知情况下，比较两总体均数间的差异常采用检验。
第三步：根据检验统计量的结果作出统计推断。
作出统计学推断结论有两个主要的方法。
第五章总体均数的估计及假设检验
89
（1）采用统计软件（如SPSS或SAS等）进行假设检验时，通常可以输出具
体的P值。
①如果P≤a，则拒绝H，接受H，认为总体间的差异有统计学意义。
②如果P>α，则不拒绝H，即拒绝H的证据不足，暂且认为H假设成立。
所谓P值，是指在H成立的前提下，比由样本数据获得的样本检验统计量
（如z，1，F值等）更极端的概率。P值也是一个随机变量，即不同的样本可得到
不同的P值。
（2）在事先规定的检验水准a下，如果有必要，还要通过自由度等其他信
息，通过查表查找某种抽样分布（如z分布、t分布）中的临界值（如za2，ta2.v
等），然后采用样本检验统计量与之进行比较。
①如果样本统计量绝对值大于等于临界值，则P≤α，拒绝H，接受H，认
为总体间的差异有统计学意义。
②如果样本统计量绝对值小于临界值，则P>α，不拒绝H，即拒绝H的证
据不足，暂且认为H假设成立。
过去，在计算机比较少的情况下，通常采用后者作出统计推断；目前，在
计算机时代，作出统计推断常采用前者。实际工作中只需采用这两种推断方法
中的一种即可
第四步：根据统计推断结果，结合相应的专业知识，给出专业结论。
在通常情况下，假设检验主要是上述三步，对于第四步，通常需要结合具
三、假设检验的两类错误
尽管假设检验可回答口与u是否相等的问题，但这种回答是建立在小概率事
件原理基础之上的，无论是拒绝零假设H。（接受备择假设H），还是不拒绝零假
设H，都有可能犯错误。如果检验假设H实际是正确的，由样本数据计算获得
的检验统计量得出拒绝H的结论，此时就犯了错误，统计学上将这种拒绝了正
确的零假设H。（弃真）的错误称为1类错误（typeIerror）。为了限制这种错误
90
兽医统计学
发生的可能性大小，统计学上通常事先规定一个小的概率，记为α（如a=0.05），
以此为检验水准（levelofsignificance）进行统计学推断，如果比样本检验统计
量更极端的概率（即P值）小于等于α，则认为零假设的事件在某一次抽样研究
中不会发生，此时有充分理由拒绝H。，即有足够证据推断差异具有统计学意义；
如果比检验统计量更极端的概率（即P值）大于a，则不拒绝H，即尚无足够证
据推断差异具有统计学意义。
假设检验的另一类错误称为ⅡI类错误（typeⅡIerror），即检验假设H原本
不正确（H正确），由样本数据计算获得的检验统计量得出不拒绝H。（纳伪）的
结论，此时就犯了Ⅱ类错误。Ⅱ类错误的概率用表示。
与两类错误相对应，假设检验的正确推断同样有两类。不拒绝正确的H。
的概率就是置信度（1-α）；拒绝不正确的H的概率，在统计学中称为检验效
能或把握度（poweroftest），记为1一β。检验效能的意义是：当两个总体参
数间存在差异时（如备择假设H：μ≠u成立时），所使用的统计检验能够发
现这种差异（拒绝零假设H：μ=μ）的能力，一般情况下要求检验效能应在0.8
以上。
现将以上关于两类错误的内容总结于表5-2和图5-6，以方便读者查阅。
表5-2两类错误的意义
样本假设检验的结论
真实情况
拒绝H
不拒绝H
I类错误
推断正确
H正确
犯错误的概率为o
正确结论的概率为（1一α）
即检验水准
又称为置信度
推断正确
Ⅱ类错误
H不正确
正确结论的概率为（1-β）
犯错误的概率为
又称为检验效能
第五章总体均数的估计及假设检验
91
H
H
图5-6两类错误示意图（以单侧检验为例）
值得注意的是，在假设检验时，应兼顾犯工类错误的概率（a）和Ⅱ类错
误的概率（β）。如果把I类错误的概率定得很小，势必增加犯Ⅱ类错误的概率，
从而降低了检验效能；反之，如果把Ⅱ类错误的概率定得很小，势必增加犯1
类错误的概率，从而降低了置信度。若要同时减小a和B，只有通过增加样本量，
减少抽样误差大小来实现。
第六章
94
兽医统计学
【例6-1】
欲探究不同饲养方式对交配期母羊体重的影响，在一个牧场选取体重
相近的交配期母羊54只，随机分为两组，一组24只补饲复合预混料+精料补
充料，另一组30只补饲复合预混料+尿素，3周后测体重（kg），结果如下：
补饲复合预混料+精料补充料：70.771.864.968.269.464.466.9
69.467.866.867.067.167.666.162.764.669.868.166.069.469.8
67.966.264.2
补饲复合预混料+尿素：62.566.869.564.165.365.566.466.168.6
62.563.965.767.265.263.565.365.164.867.466.069.262.661.1
61.869.671.167.067.568.263.6
【问题6-1】
（1）可采用哪种统计学方法对本例进行统计分析？基本步骤是什么？
（2）两种饲养方式对母羊体重的影响有无差别？
【分析】
（1）本例中两组母羊可视为两个独立样本，数据资料为定量资料，故
可采用两独立样本的t检验进行统计分析，来判断两种饲养方式对母羊体重
的影响是否相同。其分析步骤为本章重点内容，在下文中会详细介绍。
（2）运用SPSS软件进行两独立样本t检验，结果为P<0.05，差异有统计
学意义，说明两种饲养方式对母羊体重的影响有差别。
运用本章节所介绍的t检验进行均数比较，可判断均数不相等的两样本
是否来自不同的总体，是一种重要的单样本或两样本均数比较的统计方法。
第六章检验
95
第一节t检验的应用条件
第五章已经介绍了t分布。以t分布为基础的检验称为t检验。在兽医临床实
验和流行病学调查和研究中检验是应用较多的一类假设检验方法。
检验的应用条件是：
（1）随机样本，采用随机抽样方法获取的样本为随机样本；
（2）来自正态分布总体，即样本所属总体均数为、标准差为o的正态
分布；
（3）两个均数进行比较时，还要求两总体方差相等（方差齐性）。
第二节单样本t检验
单样本t检验（onesample/groupt-test）即样本均数（代表未知总体均数
μ）与已知总体均数u（一般为理论值、标准值或经过大量观察所得稳定值等）
的比较。其检验统计量按下式计算：
(6-1)
根据z值和自由度，通过查t界值表确定P值（现多通过软件求得），如果P值
小于检验水准，则拒绝零假设；反之，则不拒绝零假设。具体步骤见例6-2。
96
兽医统计学
【例6-2】
某养猪场随机抽取36头育肥猪，记录其日增重，发现36头猪日增重均数
为599.194g，标准差为3.109g，该养猪场希望记录阶段（猪生长至10周）这些
猪日均增重达到607g，试问该样本增重水平是否与期望增重水平一致？
解：该资料为单个独立样本，应进行单样本检验，步骤如下：
（1）建立检验假设，确定检验水准
Ho：μ=μo=607g，即该养猪场的猪日均增重水平与期望水平一致
H：μ≠μ=607g，即该养猪场的猪日均增重水平与期望水平不一致
a=0.05
（2）计算检验统计量
本例n=36，X=599.19g，S=3.11g，μo=607g。按公式（6-1）计算：
599.19-607
=-15.07,v=36-1=35
3.11/√36
（3）确定P值并作出统计推断
由Excel函数“=TDIST（ABS（-15.07），35，2）”得P<0.001。按
0=0.05水准，拒绝H，接受H，差异有统计学意义。统计分析表明，该养
猪场的猪日均增重水平与预期水平不一致。也可采用SPSS进行分析，选择
“分析一比较均数一单样本检验”进行单样本t检验。
第三节两独立样本资料的检验
两样本t检验又称成组t检验（two-sample/groupt-test），适用于完全随机
设计两样本均数的比较，此时分析的是两样本均数所代表的两总体均数是否相
等。两组完全随机设计是将受试对象完全随机分配到两个不同处理组。
第六章检验
97
当两样本量较小（如n<60或n<60），且均来自正态总体时，要根据两总体
方差是否相同而采用不同检验方法。
1.具有方差齐性，即两样本所属总体方差相等
运用SPSS进行两样本检验时，会直接输出方差齐性检验结果，笔算可根据
第七章第二节中介绍的两样本方差齐性的F检验方法进行。当两总体方差相等，
即o=0时，检验统计量为：
X-x
三
v=n+n-2
n2
(6-2)
其中S是利用两样本联合估计的方差，
S²=(n-1)S²+(n-1)S2
n+n-2
（6-3)
上述例6-1中，经检验，两组母羊体重服从正态分布，且具有方差齐性（检
验方法请见第七章内容），可应用两独立样本的检验进行统计分析，步骤如下：
（1）建立检验假设，确定检验水准
H：μ=μ2，即两组母羊体重的总体均数相等
H：μ≠μ，即两组母羊体重的总体均数不相等
α=0.05
（2）计算检验统计量
本例x=67.37，S=2.520；X=65.77，S=2.497；n=24，n=30，按公式（6-2）
计算得到
t=2.43，v=52
（3）确定P值，作出推断
由Excel函数“=TDIST（2.43，52，2）”得P=0.0186。按α=0.05水准，拒
绝H，接受H，差异有统计学意义。统计分析表明两组母羊体重的总体均数有
差异。
98
兽医统计学
利用SPSS软件，选择“分析一比较均数一独立样本T检验”进行两独立样
本检验，也可获取P值。
2.当两总体方差不等时，采用公式求出近似临界值r作为统计量，并校正
自由度公式为：
X-X
S²+S2
Vn
n2
(6-4)
(S²/n+S21n)²
(S²/n)²/(n-1)+(S²/n)²/(n-1)
(6-5)
【例6-3】
为了研究铅对大鼠脑水平的损伤作用，将12只大鼠随机分为两组，每
组6只，甲组为对照组，每天用0.9%的生理盐水灌胃；乙组为试验组，每天
灌服每升含500mgPb的醋酸铅溶液，并将醋酸铅溶液作为唯一饮用水，并每
天灌服0.9%的生理盐水，8周后处死大鼠测定大鼠脑组织中还原型谷胱甘肽
（GSH）含量，结果见表6-1，请比较两组大鼠GSH含量是否相同？
表6-1两组大鼠脑组织中GSH含量
均数
标准差
组别
例数
（mg/g，以每克蛋白质计）
（mg/g，以每克蛋白质计）
对照组
6
3.10
0.42
试验组
6
4.84
0.47
解：经正态性检验，两组大鼠脑组织中GSH含量均服从正态分布，但
方差不等（检验方法请见第七章内容），自由度应用公式（6-5）进行计算。
第六章t检验
99
（1）建立检验假设，确定检验水准：
Ho:μ=μ2，即两组大鼠脑组织中GSH含量的总体均数相等
H：μ≠μ2，即两组大鼠脑组织中GSH含量的总体均数不相等
α=0.05
（2）计算检验统计量：
本例x=3.10，S=0.42；x=4.84，S=0.47；n=n=6，按公式（6-4）和
（6-5）计算得：
t=2.365，v~10
（3）确定P值，作出推断结论。由Excel函数“=TDIST（2.365，10，2）”
得P=0.0396。按α=0.05水准，拒绝Ho，接受H，差异有统计学意义。统计分
析表明两组大鼠脑组织中GSH含量的总体均数有差异，即铅对大鼠脑组织
GSH含量有影响。
第四节配对资料的检验
配对设计是一种比较特殊的配对方式，能够很好地控制非实验因素对结果
的影响，包括自身配对和非自身配对（异体配对）
第一，异体配对。为消除混杂因素的影响，将某些重要特征相似的两个受
试对象配成一对，每对对象分别接受不同的处理；
第二，自身配对。同一受试对象的实验前后处理、同一个体两个部位分别
接受处理，都可视为自己和自己配对。配对设计资料的分析着眼于每一对中
两个观察值之差，将差值构成一组资料，用t检验推断差值的总体均数是否为
“0”。其检验统计量为：
100兽医统计学
d-0
v=n-1
Sa1√n
(6-6)
其中a为差值的均数，S为差值的样本标准差，n是对数。
【例6-4】
在一个随机交叉试验中，对11只胰岛素依赖型糖尿病犬首先随机喂养
低不溶性纤维和高不溶性纤维中的一种，6个月后测犬体内血糖水平，间隔
6周后，再喂养另一种纤维，6个月后测血糖水平，结果如表6-2所示，试问
喂养不同纤维，犬体内血糖水平是否有变化？
表6-2经两种纤维喂养后犬体内餐前血糖水平（mmol/L）
编号
低不溶性纤维
高不溶性纤维
差值
1
9.44
9.28
0.16
2
17.61
8.67
8.94
3
8.89
6.28
2.61
4
16.94
12.67
4.27
5
10.39
6.67
3.72
6
11.78
7.28
4.50
7
15.06
15.39
-0.33
8
7.06
5.61
1.45
9
19.56
11.94
7.62
10
8.22
5.11
3.11
11
23.17
17.33
5.84
解：假定两种纤维喂养后犬体内血糖水平的差值服从正态分布，进行
配对检验如下：
第六章检验101
（1）建立检验假设，确定检验水准
Ho：μ=0，即两种纤维喂养后犬体内血糖水平差值的总体均数为零
H：μa≠0，即两种纤维喂养后犬体内血糖水平差值的总体均数不为零
α=0.05
（2）计算检验统计量
本例n=11，d=3.81，S=2.892，按公式（6-6）计算得：
t=4.37，v=10
（3）确定P值，作出推断结论
由Excel函数“=TDIST（4.37，10，2）”得P=0.014。按α=0.05水准，拒
绝H，接受H，差异有统计学意义。统计分析表明两种纤维喂养后，犬体
内血糖水平有变化，且高不溶性纤维喂养血糖水平降低的更明显。
利用SPSS软件，选择“分析→比较均数一配对样本t检验”进行配对样
本检验，也可获取P值。
第七章
方差分析
104兽医统计学
【例7-1】
为研究攻毒对鸡体重的影响，将28只10日龄未免疫鸡分为QX、DY、
FC攻毒组和对照组，分别用鸡腺胃型IBV毒株的青岛株（QXIBV）、东营株
（DYIBV）以及肥城株（FCIBV）攻毒，对照组注射生理盐水，9天后称量
去血鸡体重，结果如表7-1所示。
表7-1不同组去血鸡体重（g）
QX组
DY组
FC组
对照组
132.12
130.21
132.74
146.96
132.45
129.70
130.62
145.12
132.02
130.10
132.42
146.32
132.23
130.21
132.10
147.36
132.52
129.06
133.05
146.84
132.26
131.02
132.32
145.99
132.43
129.42
132.01
147.20
【问题7-1】
（1）该例可以用t检验进行统计分析吗？如果不能，应该选用何种方法
进行统计分析？该方法又与检验有何区别？
（2）该例进行统计分析的基本思想和基本步骤是什么？
【分析】
（1）该例不能用检验进行统计分析，因为该例需要比较四个样本均数，
应采用方差分析判断四个样本均数有无差别。方差分析与t检验的区别在于
前者可用于比较两个及以上均数的差别，而后者只能用于比较两个均数的
差别。
（2）该例应采用方差分析的方法来判断四种饲料对鸡体重的影响有无
不同，其基本思想和分析步骤在本章中会详细阐述。
第七章方差分析105
第一节方差分析的基本思想及应用条件
方差分析（analysisofvariance，ANOVA）又称F检验，其基本思想是把
全部观察值间的变异按设计和需要分解成两个或多个组成部分，然后将各部分
的变异与随机误差进行比较，以判断各部分的变异是否具有统计学意义，可用
于比较两个或两个以上均数的差别。
一、方差分析应用条件
进行方差分析的数据应满足的条件：
（1）各样本（或各个处理组）是相互独立的随机样本，且均服从正态分布；
（2）各样本的总体方差相等。
二、方差分析的基本思想
方差分析的目的就是在“H：各总体方差相等”成立的条件下，通过分析
各处理组均数之间的差别大小，来推断多个总体均数间有无差别，从而说明处
理因素的效果是否存在。
下面以例7-1来说明方差分析的基本思想。
三月
j=1
N=∑n=n+n+.…+ng，g为处理组数，n为第i（i=1，2，"，g）组的样本量，
X为第处理组的第j（j=1，2，"，n）个观察值。在例7-1中，g为4，总体均数
为135.24，四个处理组的均数分别为132.29，129.96，132.18，146.54，总例数
为28。
106兽医统计学
试验数据有三个不同的变异：
（1）总变异。全部测量值大小不同，这种变异称为总变异。总变异的大小
可以用离均差平方和（sumofsquaresofdeviationsfrommean，SS）表示，即各
测量值X，与总均数X差值的平方和，记为SS点。总变异SS反映了所有测量值之
间总的变异程度，计算公式为：
SS=（x-x)²=x²-C
（7-1)
=1
目月
（2）组间变异。各处理组由于接受处理的水平不同，各组的样本均数文
（例7-1中i=1，2，3，4）也大小不等，这种变异称为组间变异。其大小可用各
组均数X与总均数X的离均差平方和表示，记为SS细间，计算公式为：
（7-2)
/=]
各组均数X之间相差越悬殊，它们与总均数X的差值越大，SS组间就越
大；反之SS红越小。SS细反映了各组X间的变异程度。存在组间变异的原因有：
）
的影响。
（3）组内变异。在同一处理组中，虽然每个受试对象接受的处理相同，但
测量值仍各不相同，这种变异称为组内变异（误差）。组内变异可用组内各测量
值X与其所在组的均数x的差值的平方和表示，记为SS组内，表示随机误差的影
响。计算公式为：
(x-x)²
SS组内
(=j=)
（7-3)
各离均差平方和的自由度为：
V=N-1V组间=g-1V组内=N-g
（7-4)
在例7-1中，V总=27，V组间=3，V组内=24。
第七章方差分析107
总离均差平方和可分解为组间离均差平方和及组内离均差平方和，即：
SS=SS组间+SS组内
（7-5)
相应地，总自由度可分解为组间自由度及组内自由度，有：
V总=V组间+V组内
（7-6)
变异程度除与离均差平方和的大小有关外，还与其自由度有关，由于各部
分自由度不相等，因此各部分离均差平方和不能直接比较，须将各部分离均差
平方和除以相应自由度，其比值称为均方差，简称均方（meansquare，MS）。
组间均方和组内均方的计算公式为：
SS组间]
MS组间=
V组间
SS组内
(7-7)
如果各组样本的总体均数相等（H：μ=μ=μ=μ4），即各处理组的样本来自
相同总体，无处理因素的作用（处理效应），则组间变异同组内变异一样，只反
映随机误差作用的大小，此时可以证明，比值MS组间/MS组内服从自由度为v和v2
的F分布。
MS组间
F=
V=V组间.V2=V组内
MS组内
(7-8)
F值接近于1，就没有理由拒绝H；反之，F值越大，拒绝H的理由越充分。
由F界值表，可查出按α水准（一般取α=0.05）F分布的单尾界值Fα（vu,v2），作为
判断统计量F大小的标准。若根据试验结果计算的F值偏大，如F≥Fo.05（v.v）时，
则P≤0.05，拒绝Ho，接受H：μ不全相等（i=1，2，，g），说明各样本来自
不同总体，即认为各样本的总体均数不等。反之，当F<Fo.05（vu，v2）时，P>0.05，
则不拒绝H。，还不能下各样本的总体均数不等的结论。
108兽医统计学
第二节两样本方差齐性的F检验
设有两个随机样本分别独立地取自两个正态总体，预判断其总体方差。和
o是否相等，可以作如下齐性检验：
H：0=02，即两个独立样本的总体方差相等。
H：0²≠0²
α=0.05
统计量为：
F=S2
（7-9)
其中，S²和S2是两个样本方差，S²表示数值较大的那个方差。当H成立时，
F统计量服从自由度为v和v的F分布。查F界值表可以得到相应P值，给定一
个小概率a作为检验水准，如果与F值相应的P值小于给定的α，拒绝H，否则不
拒绝H。SPSS进行两独立样本检验时，若方差齐性检验结果显示两样本方差不
齐，则输出校正检验的结果。
【例7-2】
欲研究两种缝合方法A和B对家免神经缝合后轴突通过率的影响，选取
36只家兔，随机分为2组，家免神经断裂后分别采用不同的方法进行缝合，
2个月后测轴突通过率（%），A组轴突通过率均数44，标准差为17.4；B组
轴突通过率均数52，标准差为13.3。试问两总体方差是否相等？
（1）建立检验假设，确定检验水准
H：0=02，即两总体方差相等。
第七章方差分析109
H：0≠o2
a=0.05
（2）计算检验统计量
根据公式7-9可计算F值和自由度：F=1.7116，V=V2=17
（3）确定P值并作出统计推断
由Excel函数“=FDIST（1.7116，17，17）”得P=0.1389，在α=0.05的水
准上不拒绝H，差异无统计学意义。统计分析表明两个总体方差相等。
第三节完全随机设计资料的方差分析
完全随机设计（completelyrandomizeddesign）是将同质的受试对象随
机地分配到各处理组，再观察其试验效应。各组样本量可以相等，也可不等。
完全随机设计是最常见的研究单因素两水平或多水平的试验设计方法，属单向
方差分析（one-wayANOVA）。
例7-1即为完全随机设计资料，下面在该例的基础上归纳完全随机设计资料
方差分析的一般步骤：
（1）建立检验假设，确定检验水准
H：不同组间去血鸡桐体重总体均数相同
H：不同组间去血鸡体重总体均数不全相同
α=0.05
（2）计算检验统计量
计算出离均差平方和SS：包括组间离均差平方和SS组间和组内离均差平方和
SS组内；自由度v：包括组间自由度v组间和组内自由度V组内；均方MS：组间均方MS组间
和组内均方MS组内；F值。结果见表7-2。
110兽医统计学
表7-2例7-1资料的方差分析结果
变异来源
SS
df
MS
F
总变异
1225.667
27
组间
1215.667
3
405.222
972.525
<0.001
组内
10.000
24
0.417
（3）确定P值并作出推断结论
由Excel函数“=FDIST（972.525，3，24）”得P<0.001，按α=0.05水准，拒
绝H。，接受H，差异有统计学意义。表明不同组间去血鸡体重总体均数不全
相同，至于总体中哪些均数不同，可以采用本章第七节介绍的方法进行均数两
两比较。
也可利用SPSS进行数据分析，选择“分析一比较均数→单因素ANOVA”
获取方差分析结果。
第四节
随机区组设计资料的方差分析
随机区组设计（randomizedblockdesign）又称配伍组设计，通常是将
受试对象按性质（如动物的窝别、体重等非实验因素）相同或相近者组成b个区
组，每个区组中的受试对象分别随机分配到k个处理组中去，属于双向方差分析
（two-wayANOVA）
随机区组设计资料的变异除了总变异、处理的变异和随机误差外，还从上
述组内变异中分离出了区组的变异。其大小可用以下公式表示：
SS组
k（x-x）
（7-10)
=
第七章方差分析
111
SS区组
MS区组
V区组
(7-11)
检验统计量F值有两个：
F处理=MS处理/MS误差
（7-12)
相应的自由度为：
处理=k-1区组=b-1
(7-13)
【例7-3】
四个种系未成年雌性大白鼠各三只，每个种系内的三只大白鼠分别随
机注射0.2μg、0.4μg、0.8μg的雌激素，一段时间后，解剖大白鼠称子宫重
量，数据见表7-3，问三种剂量雌激素对子宫重量的影响是否不同？
表7-3三种剂量的雌激素注射后大白鼠子宫重量
种系（区组）
雌激素0.2μg
雌激素0.4ug
雌激素0.8μg
1
106
116
145
2
42
68
115
3
70
111
133
4
42
63
87
该资料为随机区组设计，其方差分析步骤如下：
（1）建立检验假设，确定检验水准
对于处理组：
Ho：3个剂量组大白鼠子宫重量的总体均数相等
H：3个剂量组大白鼠子宫重量的总体均数不全相等
α=0.05
112兽医统计学
对于区组：
H：4个种系大白鼠子宫重量的总体均数相等
H：4个种系大白鼠子宫重量的总体均数不全相等
α=0.05
（2）计算检验统计量
可根据上述公式计算离均差平方和、自由度、均方和F值，结果见
表7-4。
表7-4例7-3方差分析结果
变异来源
SS
df
MS
F
P
总变异
13075.000
11
处理组
6074.000
2
3037.000
33.537
<0.001
种系（区组）
6457.667
3
2152.556
23.771
<0.001
误差
543.333
6
90.556
（3）确定P值并作出推断结论
由Excel函数“=FDIST（33.537，2，6）”得P<0.01，且由Excel函数
“=FDIST（23.771，3，6）”得P<0.001。按α=0.05水准，两个假设均拒绝
Ho，接受H，差异有统计学意义。分析表明3个剂量组大白鼠子宫重量的
总体均数不全相等，即不同剂量的雌激素对大白鼠子宫重量的影响不同；
且4个种系大白鼠子宫重量的总体均数不全相等，即种系对大白鼠子宫重
量有影响。
也可利用SPSS软件，选择“分析一一般线性模型一单变量”获取方差
分析结果。
第七章方差分析113
第五节析因设计资料的方差分析
析因设计（factorialdesign）是将两个或多个实验因素的各水平进行全面
组合的实验，能够有效分析各实验因素的单独效应、主效应和因素间的交互
效应。特点是每一组合均有相同的重复测量次数，测量值与上面相同均属于
定量资料。
一、单独效应、主效应和交互效应
（1）单独效应。单独效应（simpleeffect）是指其他因素的水平固定时，同
一因素不同水平间的差别。以表7-5中2×2析因试验结果为例，当B因素固定在
1水平时，A因素的单独效应为2；B因素固定在2水平时，A因素的单独效应为8。
同理，A因素的两个水平固定时，B因素的单独效应分别为6和12。
表7-52×2析因试验结果举例（均数）
A因素
B因素
平均
a-a
a
a2
b
30
32
31
2
b2
36
44
40
8
平均
33
38
35.5
5
b-b
6
12
9
（2）主效应。主效应（maineffect）指某一因素单独效应时的平均数。如B
因素为1水平和2水平时，A因素的单独效应分别为2和8，两者的平均水平5即为
A因素的主效应，同理B因素的主效应为9。
114兽医统计学
（3）交互效应。当某因素的各个单独效应随另一因素水平的变化而变
化，且相互间的差别超出随机波动范围时，则称这两个因素间存在交互效应
（interaction）。在2x2析因试验中，A，B两因素的交互效应可表示为
AB=[（ab-ab）-（ab-ab）]/2
或AB=[（a2b-ab）-（ab2-ab）]/2
（7-14)
在表7-5中，AB的交互效应为3。
二、析因设计资料方差分析原理及实例
析因设计方差分析的总变异可以分为处理和误差两部分，如2×2析因设计
的处理变异包含A因素、B因素的主效应以及AB间的交互效应，自由度也可相
应分解：
SS=SS处理+SS误差=（SSA+SSB+SSAB）+SS
V=V处理+V误差=（vA+VB+VAB）+VE
（7-15）
其检验统计量F值有三个，分别为：
MSA
MSB
MSAR
F=
F=
MSE
MSE
(7-16)
相应的自由度为：
VA=a-1
（I-q）（I-D）=AI-q=
(7-17)
【例7-4】
为研究鸡肝饲喂幼猫对其体重的影响，选取50日龄左右健康短毛家猫
20只，随机分为四组：第一组饲喂鸡肝加米饭30d，第二组饲喂鸡肝加米饭
60d，第三组饲喂幼猫猫粮30d，第四组饲喂幼猫猫粮60d，测量幼猫体重变
化，见表7-6。试对该资料进行分析。
第七章方差分析
115
表7-6四种不同处理情况下幼猫体重变化（kg）
鸡肝加米饭
幼猫猫粮
时间（30d）
时间（60d）
时间（30d）
时间（60d）
0.955
1.830
1.317
1.928
0.952
1.643
0.993
1.687
1.226
1.347
1.273
2.422
0.921
1.559
1.171
1.299
1.036
1.730
1.098
1.638
本例为最简单的两因素且每个因素有两个水平的2×2析因设计：A因素（饲
喂鸡肝）有两个水平，B因素（饲喂时间）有两个水平。其方差分析步骤如下：
（1）建立检验假设，确定检验水准
对于因素A：
H：饲喂鸡肝和饲喂猫粮的幼猫体重变化的总体均数相等
H：饲喂鸡肝和饲喂猫粮的幼猫体重变化的总体均数不等
a=0.05
对于因素B：
H：饲喂30d和饲喂60d的幼猫体重变化的总体均数相等
H：饲喂30d和饲喂60d的幼猫体重变化的总体均数不等
α=0.05
对于交互作用AB：
H：不同饲喂物对饲喂时间长短测得的幼猫体重变化无影响，即因素A
和因素B无交互效应
H：不同饲喂物对饲喂时间长短测得的幼猫体重变化有影响，即因素A
和因素B存在交互效应
α=0.05
（2）计算检验统计量
根据公式7-16和7-17计算F值和自由度，见表7-7。
116兽医统计学
表7-7例7-4资料的方差分析结果
变异来源
SS
df
MS
F
P
总变异
2.977
19
A
0.132
1
0.132
2.210
0.157
B
1.886
1
1.886
31.487
<0.001
AxB
0.001
1
100'0
0.009
0.926
误差
0.958
16
0.060
（3）确定P值并作出推断结论
由Excel函数FDIST可获取P值，结果见表7-7。本例交互效应A×B的
P>0.05，按α=0.05水准，不拒绝H，差异无统计学意义，尚不能认为两个因
素间存在交互效应。对于A、B两因素的主效应，A因素主效应P>0.05，不
拒绝H。，差异无统计学意义，即不能认为饲喂鸡肝和饲喂猫粮的幼猫体重
变化的总体均数相等；B因素主效应P<0.001，拒绝H。，差异有统计学意义，
即饲喂30天和饲喂60天的幼猫体重变化的总体均数不等。
也可以利用SPSS软件，选择“分析一一般线性模型→单变量”获取方
差分析结果。但注意必须说明模型存在交互作用项。
第六节重复测量资料的方差分析
一、重复测量资料定义及原理
重复测量资料（repeatedmeasurementdata）是同一受试对象的同一
观察指标在不同时间点上进行多次测量所得的资料，常用来分析观察指标在不
同时间点上的变化。例如在对某种动物不同种系的繁殖实验中，使用两种种系
的动物每种若干只，在不同温度下测试其体重、胎儿重、脂肪厚度等。该重复
第七章方差分析
117
测量实验可以分析种系之间（组间因素）有关繁殖指标的差异，研究不同温度
（组内因素）下繁殖指标间的差异以及各指标随温度变化的变化趋势。
重复测量资料的总变异包括两部分，一部分为受试对象间的变异，另一部
分为受试对象内的变异。其中受试对象间的变异又分为处理因素的变异和个体
间误差两部分；而受试对象内的变异可分为时间因素变异、处理因素与时间因
素的交互效应以及个体误差的变异三部分。
重复测量资料的变异分解较为复杂，故在此不详细列举离均差平方和与自
由度的分解公式。
二、重复测量资料方差分析基本步骤
【例7-5】
欲研究四种药物对家兔某生化指标的作用，5只家兔参与实验，每只家
免依次接受四种药物，每种药物实验之间相隔一定的时间，避免药物相互
之间的影响，实验结果见表7-8。
表7一8不同药物对家兔的影响
家兔
药物1
药物2
药物3
药物4
1
30
28
16
34
2
14
18
10
22
3
24
20
18
30
4
38
34
20
44
5
26
28
14
30
重复测量资料方差分析的一般步骤：
（1）建立检验假设，确定检验水准
Ho：四种药物对生化指标影响的总体均数相同
H：四种药物对生化指标影响的总体均数不全相同
118兽医统计学
α=0.05
（2）计算检验统计量
利用SPSS软件进行，选择“分析→一般线性模型一重复度量”结合
“分析一→一般线性模型一单变量”获取方差分析结果，见表7-9。
表7-9例7-5重复测量资料方差分析结果
变异来源
SS
df
MS
F
P
总变异
1491.800
19
对象间
680.800
4
170.200
3.150
0.046
对象内
811.000
15
54.067
4.692
0.016
药物
698.200
3
232.733
24.759
<0.001
误差
112.800
12
9.400
（3）确定P值并作出推断结论
通过软件分析结果得知P<0.05，按a=0.05水准拒绝Ho，差异有统计学意
义。结论为四种药物对家兔该生化指标的影响不全相同。
三、重复测量资料方差分析的前提条件
进行重复测量资料的方差分析，除需满足一般方差分析的条件外（见本章
第一节），还需满足协方差阵的球形对称性或复合对称性。若不满足球形对称
性质，方差分析的F值会有偏倚。球形对称性通常采用Mauchly检验来判断。对
于例7-5，用SPSS进行分析时，Mauchlystest的结果为P<0.001，即资料不满足
球形对称性，此时需要进行自由度校正，可采用的方法有：Greenhouse-Geisser
（G-G）法和Huynh-Feldt（H-F）法。即用两种方法的“球对称”系数&乘以
受试对象内各变异的自由度，用新的自由度再查F界值表获取新的P值。&的上
限是1，这时数据是完全符合球对称的；下限是1/（k-1）。k代表的是组内因素
第七章方差分析119
的水平数（或重复测量的水平数）：数据越不符合“球对称”，值就越小。如
例7-5中，V组间为3，而采用G-G法和H-F法校正后的v组间分别为1.815和3。利用
SPSS进行重复测量资料方差分析时，可以提供Mauchly检验以及上述两种校正
方法的分析结果，可根据实际情况选择合适的分析结果。
第七节多样本均数间的比较
前面例7-1的方差分析中，拒绝Ho，说明三个总体均数不全相等，若要明确
哪些总体均数不等需进一步作两两比较。多个样本均数间的两两比较可称为事
后多重比较（Posthocmultiplecomparisons）。若采用前面所学的t检验进行两两
比较，则会增加假设检验的次数，且实际犯第一类错误的频率将会增大，影响
判断结果，因此应采用专用的两两比较方法。
一、常用多重比较方法
两两比较的方法有很多种，这里介绍常用两种：Dunnett法，该方法是基于
两样本t检验原理进行的检验，适用于k一1个试验组与对照组均数的比较，因此
在使用Dunnett法时，应制定对照组；Bonferroni法，通过修正每次两两比较的检
验水准，控制1类错误总的发生概率。两两比较中最常见的错误是在每次比较
中，直接沿用总的检验水准（如α=0.05），这样做的结果是导致总的1类错误增
大，而Bonferroni法通过将每次检验水准调整为a/c（c为两两检验次数）把I类
错误的累积概率控制在0.05。该方法适用于所有的两两比较，但较为保守，当
比较次数c不多时，该法效果较好，当比较次数c较多时（如c>10），由于其检验
水平选择较低，结论偏于保守。
120兽医统计学
二、多重比较分析步骤
以例7-1为例，问QX、DY、FC组与对照组相比，去血鸡体重量总体均
数是否相同？
（1）建立检验假设，确定检验水准
Ho：μA=，即两种毒株攻毒喂养，去血鸡体重量的总体均数相同
H：μA≠以R，即两种毒株攻毒喂养，去血鸡体重量的总体均数不相同
a=0.05
（2）计算检验统计量
利用SPSS软件进行单因素方差分析时，可单击“两两比较”选项，该选项
提供了多种两两比较方法，选择最合适的方法获取两两比较的结果。若各组方
差齐时，可选择Bonferroni法、Dunnett法、LSD法等14种方法；若各组方差不
齐，可选择Tamhane'sT2等四种方法。
（3）确定P值并作出推断结论
SPSS两两比较分析结果显示：QX组与对照组均数比较P<0.001，DY组与对
照组均数比较P<0.001，FC组与对照组均数比较P<0.001。按α=0.05水准，均拒
绝H，接受H，差异有统计学意义；分析表明QX组与对照组、DY组与对照组
以及FC组与对照组去血鸡体重量的总体均数不相同。
第八节多样本方差比较
进行方差分析的条件之一为各样本的总体方差相等，因此在进行方差分析
前要进行方差齐性检验。本章第二节介绍的F检验用于两总体方差齐性检验，
对于多总体方差齐性检验可采用Levene检验（Levenestest），该方法相比于其
第七章方差分析121
他方差齐性检验方法更为稳健，且不依赖于资料分布类型，采用SPSS进行两独
立样本检验和方差分析是默认用Levene检验进行方差齐性检验的。
Levene检验用于资料是任意分布的方差齐性检验，既可用于检验两总体方
差齐性，也可用于检验多个总体的方差齐性。其检验统计量为：
(N-k)∑N(Z,-Z)²
W=
(z-z)（1-x)
(7-18)
式中，W为Levene检验统计量，k为样本组数，N为第i个样本的含量，N为各样
本量之和，Z为将原始数据转换后的新数据。乙为第i个样本的均数，乙为全部
数据的总体均数。
W服从自由度为v=k-1，v=N-k的F分布。
对例7-1作方差齐性的Levene检验，其一般分析步骤如下：
（1）建立检验假设，确定检验水准
Ho：0²=o²=o²=0²，即四个总体方差全相等
H：四个总体方差不全相等
a=0.05
（2）计算检验统计量按公式7-18计算得W=6.353，V=3，V=15
（3）确定P值，作出推断
由Excel函数“=FDIST（6.353，3，15）”得P<0.01，在α=0.05水平拒绝H
接受H，差异有统计学意义，尚不能认为四个总体方差相等。
用SPSS进行方差分析，若Levene检验的结果为P值小于给定的a，拒绝H
即三个总体方差不齐，此时可通过数据转换（如对数变换或平方根变换等）使
之满足方差分析的条件，也可采用非参数统计分析方法，如秩和检验（见第九
章）。若P值不小于给定的α，不拒绝Ho，三个总体方差相等，可直接采用SPSS
输出的方差分析结果。
第八章
卡方检验
124兽医统计学
【例8-1】
在绪论中曾提到一个例子：在临床型乳房炎患牛中随机抽取65头患牛
进行试验，研究中药对奶牛乳房炎的治疗作用。他将患牛随机分为2组，试
验组奶牛用中药复方治疗，对照组用青霉素和链霉素治疗，观察临床效果。
结果中药复方治疗患牛32例，治愈27例，治愈率为84.3%；对照组治疗33
例，治愈26例，治愈率为78.8%。据此认为用中药治疗奶牛乳房炎的疗效高
于西药；将相关资料及结论撰写成文，投稿至某杂志编辑部。然而，此论
文不久后即被拒退回，理由是该文未经统计学处理。
【问题】
（1）根据实验设计及上表数据，应该采用什么方法进行检验？
（2）检验过程如何？
【分析】
（1）该资料的结果按被治疗效果分为治愈和未治愈两种，属于定性资
料；根据资料的类型及其设计方案，应采用卡方检验中的四格表检验。
（2）该工作者对该资料在统计描述的基础上，应用SPSS软件进行四格
表检验。结果，差异无统计学意义，说明用中药复方治疗奶牛乳房炎与常
用抗生素的治疗效果基本相同。
之外还有哪些检验形式？在什么样的情况下需要用到卡方检验呢？
卡方检验在兽医学中应用较为广泛。本章主要介绍卡方检验的原理、
四格表资料的卡方检验、RxC表的卡方检验以及Fisher精确检验。
第八章卡方检验125
第一节卡方检验的原理
在兽医流行病学调查、研究和实验室诊断试验中，观察与测量的数据，依
其记载方式分为定量资料与定性资料。定量资料例如身高、体重、血中葡萄糖
含量等，定性资料例如牛羊的有角与无角，鸡冠的单冠、玫瑰冠、胡桃冠及豌
豆冠，病畜的治愈、好转、无效与死亡等。定量资料的显著性检验，主要是几
个样本平均数间差异的显著性检验。比较两个均数的差别是否其有统计学意义
可以采用检验，检验多个样本均数之间的差别是否具有统计学意义可以采用方
差分析。在兽医研究中，人们常常也需要比较两个或多个率之间的差别是否具
有统计学意义，即对定性资料的显著性检验。定性资料样本量不是足够大时，
样本率的分布与正态分布相差较大。在这种情况下，最常采用的统计方法就是
卡方检验（即x²检验）。
一、卡方检验
卡方检验（chi-squaretest）是先根据提出的假设算得理论频数，再将实际
数与理论频数之间的差异进行比较，检验其显著性。统计量x的定义如下：
x²=∑(A-T)²
T
(8-1)
式中，A为实际观察数，T为理论频数。除适合性检验外，一般x检验的理论频
数T是根据无效假设，按比例关系算得的。由上式可见，分子差异越大，x值就
越大，则实际数与理论频数越不符合；分子差异越小，则实际数与理论频数越
接近，当A=T时，X=0，表示两者没有差异。
126兽医统计学
二、卡方分布
卡方分布（x²distribution）是在正态分布基础上产生的总体分布，是随自
由度多少而不同的一组曲线。图8-1给出了几条x分布曲线。若样本的组数为k，
则统计量x的自由度df为k-1，x分布的形状依赖于自由度的大小：当自由度小
于等于2时曲线呈L型；随着自由度的增加，曲线逐渐趋于对称；当自由度趋近
于无穷大时，曲线趋近于正态分布。
0.3
df=1
0.2
df=3
df=5
0.05
0.1
3.84
7.81
0
2
6
8
10
图8-1自由度为1、3、5的x分布曲线
x取值范围是0<x<∞o，恒为正值。曲线向右偏斜，偏斜度随自由度的减少
而加剧。x分布曲线的形状仅取决于自由度df的大小，不论何种样本只要自由
度相同，其x分布的形状不变
三、卡方的连续性矫正
图8-1表明，x分布曲线是连续性的光滑曲线。将连续性的x分布应用于间
断性定性资料的显著性检验时，由连续性X分布得到的概率仅为真实概率的近
似值，往往造成偏低的估计。特别是自由度df为1，理论频数小于5时偏差较大，
必须进行矫正。当自由度为2时，偏差相对较小，一般可不作矫正。自由度为1
时，即使理论值都较大，但为了避免x值偏大，还是作矫正为宜。矫正的x值用
第八章卡方检验127
x2表示，公式如下：
x=∑A-T1-0.5)²
(8-2)
T
第二节
四格表资料的卡方检验
四格表也被称为2×2列联表（如表8-1），这种表格除合计外，只有a、b、
c、d四个格子的数据是基本的，故称四格表。四格表资料的检验用于两个率
（或构成比）的比较。一般地，自由度df=（行数一1）×（列数-1），四格表自
由度df=（2-1）（2-1）=l。
一、独立样本四格表资料的卡方检验
表8-1独立样本资料的率的观察指标
结果
组别
合计
观察指标得出的率
出现
不出现
甲
a
b
a+b=n
P=a/(a+b)
乙
d
c+d=n2
C
P=c/(c+d)
合计
a+c=m
b+d=m2
a+b+c+d=n
P=（a+c）/（a+b+c+d)
表8-2表8-1四格表对应的理论频数
结果
组别
出现
不出现
甲
（a+c）（a+b）/n
（b+d）（a+b）/n
乙
（a+c）（c+d）/n
（b+d）（c+d）/n
注：表8-1中的a、b、c、d分别为各自相关的实际观察频数A，表8-2中的四格表中分别
计算出的是各自的理论频数T。
128兽医统计学
四格表x检验的基本步骤：
（1）指定零假设H为两样本的总体率相同，或者说，所研究的两个因素之
间没有关联；指定备择假设H为两样本的总体率不同，或者两个因素之间有
关联。
（2）收集整理数据，将观察频数整理在2×2列联表中（如表8-1）
（3）在电脑上使用适当的命令来选择卡方检验。如果通过手工执行检验，
则需在表的每格中计算出理论频数。注意，在每格中理论频数是根据观察频数
n,m
分别在行和列的合计得到的（如表8-2）理论频数T，的计算公式为：=-
然后计算检验统计量。当n≥40时，但有某个格子出现1≤T<5，必须用如下校
正公式：
x²=∑(A-TI-0.5)²
T
式中，A为实际观察频数，T为理论频数。同样统计量x服从自由度为1的卡方
分布。
（4）采用计算机软件输出的P值，决定是否拒绝零假设。通常情况下，当
P≤0.05时，拒绝没有关联的零假设。需要说明的是，在一项观察性研究中，有
关联并不代表存在因果关系，因此，即使拒绝了零假设，也不一定能推测出一
个因素是由另一个因素的某一特定水平导致的。
（5）计算两个频数差异有关的置信区间。如果电脑输出不提供这些信息，
可采用
p(1-P)+P(1-P2)
（P-P2)±1.96
n
n2
计算95%的置信区间
第八章卡方检验
129
【例8-2】
Hawkins等人（1993年）研究表明，雄性和雌性非肥胖型糖尿病（NOD）
小鼠的发病率分别为24%和73%。通过分析早期阉割对雄性NOD小鼠糖尿病发
生率的影响，可以用来研究这种性别差异的原因。从100只雄鼠中随机选择50
只小鼠，并在其出生后1天进行阉割，将它们与其余的50只对照组小鼠进行比
较。饲养140天，并从第42天开始每双周收集血样。三个连续的血糖水平高于
200mg/mL将会导致糖尿病。结果表明，在112天时阉割后的小鼠（52%）比对
照组（24%）的糖尿病发病率高出一倍以上。这种差异是否具有显著性？
（1）建立检验假设，确定检验水准
H：实验组和对照组的小鼠糖尿病发生率相等
H：两组发病率不等
a=0.05
（2）计算检验统计量
将数据整理如表8-3。表8-4显示对应实际观察频数的理论频数。
表8-3阉割组和对照组发生糖尿病的实际观察频数
组别
有糖尿病
无糖尿病
合计
阉割组
26
24
50
对照组
12
38
50
合计
38
62
100
表8-4阉割组和对照组发生糖尿病的理论频数
组别
有糖尿病
无糖尿病
50×38
50×62
阉割组
=31
100
100
50×38
50×62
对照组
=19
=31
100
100
注：两组分别在有无糖尿病的理论频数相同是因为两组样本量一样。
130兽医统计学
因该例中为四格表资料，当n不小于40，理论频数T不小于5时，可以不
进行校正，直接采用公式：
19
19
31
31
=2.5789+2.5789+1.5806+1.5806=8.319
（3）确定P值，作出推断结论
根据Excel函数“=CHIDIST（8.319，1）”得到P=0.004。该结果与零假
设不一致，表明NOD小鼠早期阉割与糖尿病发病率有关，这说明雌雄小鼠
糖尿病发病率的不同可能与睾酮在血液循环中的浓度有关。
如果比较两组小鼠糖尿病发病率频数的实际差异，需计算95%置信
区间：
p(l-p）p(1-P2)
(P-P2)±1.96
n
n2
0.52×0.480.24×0.76
=（0.52-0.24）±1.96
50
50
因此早期阉割与糖尿病的发病率增加可能有关，发病率之差为28%，其
95%置信区间为（9.8%，46.2%）。
二、配对2×2列联表资料的卡方检验
在实际应用中，有时需要比较的样本资料不相互独立。比如，在配对实验
中两样本频率分布的比较问题。这种研究所用数据的两样本不一定满足独立性，
因此需要运用配对资料的卡方检验来计算。
这类问题的原始数据可以表示为表8-5所示的四格表形式。表8-5与表8-1
的区别仅在设计上，表8-1是两个独立样本，行合计是事先固定的；而这里的
第八章卡方检验
131
“两份样本”互不独立，虽然样本量n是固定的，但行合计和列合计是事先不确
定的。
表8-5两个变量阳性率比较的一般形式和符号
变量2
变量1
合计
阳性
阴性
阳性
a
b
n
阴性
C
p
n2
合计
m
m2
n（固定值）
由表中可以看出：
变量1的阳性率=_a+b
n
n
m
3+D
变量2的阳性率=
n
n
q+n
+D
b-c
变量1的阳性率一变量2的阳性率=
n
由此可见，两个变量阳性率的比较只和b、c有关，而与a、d无关。综上所
述，要比较两种检验方法阳性率有无差别，只要对其中的频数b与c作卡方检验
即可。将b、c及其理论频数（b+c）/2代人基本公式可以得到McNemar检验公式
x²=(b-c)²
b+c
(8-3)
该公式计算得到的卡方统计量服从自由度为1的卡方分布。注意b+c如果小
于40，则需要对McNemar检验公式进行校正，即需要采用
(1b-c｜-1)²
(8-4)
+q
如果是需要检查两个变量之间是否关联则使用前面的基本公式8-1即可。
132兽医统计学
【例8-3】
有308份血清样品，每份样品一分为二，用两种不同的免疫学检测方法
检验类风湿因子，其结果如表8-6所示。试问这两种免疫学检验的结果是否
相互独立？
表8-6两种血清免疫学检测结果
B法
A法
合计
十
十
172
8
180
12
68
80
合计
184
76
260
1.两个率差异的检验
（1）建立检验假设，确定检验水准
H：方法A检出的阳性率与方法B相同
H：方法A检出的阳性率与方法B相同
α=0.05
（2）计算x统计量
因为b+c=20<40，所以采用公式8-4，
（8-12|-1)
9
0.45
8+12
20
（3）确定概率及下结论
采用Excel函数“=CHIDIST（0.45，1）”计算得P=0.502，P值大于0.05，
不拒绝H。，尚不能说明方法A检出的阳性率与方法B不相同。
第八章卡方检验133
2.方法A与B的关联性检验
（1）建立检验假设，确定检验水准
Ho：方法A与B相互独立
H：方法A与B相互关联
α=0.05
（2）计算x²统计量
首先计算在H成立的条件下的理论频数，如：
T=184×180/260=127.38
同样得到
T=52.62，T=56.62，T2=23.38。
根据基本公式8-1得到x2=173.74
（3）确定概率及作出统计决策
由Excel函数“=CHIDIST（173.74，1）”得出P值=0.000，按α=0.05水
准，拒绝零假设，差异有统计学意义，可认为两种检验方法所得结果之间
存在关联性。
三、2×2列联表卡方检验的注意事项
（1）x检验的校正公式仅用于四格表资料，对于其他行列表，不能采用校
正公式。
（2）当n<40或T<1时，校正x²值也不恰当，这时可以用Fisher确切概率法检
验，见本章第四节。
（3）只有在两组对象其他方面“同质”的前提下才能比较两个频率，才能
进行四格表的x检验。
134兽医统计学
第三节R×C列联表的卡方检验
一、多个独立样本RXC列联表资料的卡方检验
同2x2列联表相同，仍采用公式8-1计算。针对RxC列联表可将公式改写为：
x²=>
S（A-T)
(i=1,2,..,R;j=1,2,.….,C)
T
(8-5)
同月
其中4为每个格子的实际频数，T为每个格子的理论频数。自由度仍为（行
数-1）×（列数一1）。
RxC列联表要求理论频数均大于1，并且小于5的格子分布不超过总的格子
数的1/5。否则，需采用其他方法进行检验（如Fisher确切概率检验），或采用增
大样本量等办法。
设有一个定性变量，具有C种可能的“取值”：现有R个独立样本的分布，
相应的样本数据以表8-7的形式表示。这样的数据形式称为行×列表，也称
RxC列联表。它的检验主要用于多个率或构成比的比较。
表8-7独立样本R×C列联表
属性
处理
合计
Y
Y2
Yc
1
Al1
A12
AIc
n
2
A21
A22
A2c
n2
R
AR1
AR2
ARC
nR
合计
m
m2
mc
RxC列联表的卡方检验的步骤与四格表卡方检验的相同，这里不再重复
第八章卡方检验
135
【例8-4】
对甲乙丙三地的水牛进行体型抽样调查。现将水牛的体型按优良、中
差两个分类，三个地区不同体型的水牛头数资料见表8一8。问甲乙丙三地区
间水牛体型有无差异，应该用什么方法进行检验呢？
解：从题可看出，该资料结果是二分类属于定性资料，不论是地区还
是体型都属于多变量，符合多个独立样本RxC列联表资料的卡方检验。根
据调查结果将数据整理成如下表格（表8-8）：
表8-8三个地区水牛体型调查情况
体型
地区
合计
优良
中差
甲
15
70
85
乙
25
25
50
丙
25
30
55
合计
65
125
190
方法：
（1）建立检验假设，确定检验水准
Ho：三个地区水牛体型无差异
H：三个地区水牛体型有差异
α=0.05
（2）计算检验统计量
利用公式（8-1）或公式（8-5），可获得x²=18.989，自由度=2。
（3）确定P值，作出推断结论
采用Excel函数“=CHIDIST（18.989，1）”得到P<0.001，差异有显著
性意义，即甲乙丙三地水牛体型有显著性差异。
在行×列的卡方检验中，若P<0.05，拒绝零假设H，只能作出总的结
论。总的来说，3个不同地区水牛体型的差异有统计学意义。但不知道究竞
136兽医统计学
哪两个地区水牛体型分布的差异有统计学意义。若想知道哪两个地区水牛
体型分布的差异有统计学意义，还要进行两两比较，即需进行行×列分割。
注意：该资料的结果变量体型是优良与中差两分类，所以可以采用卡
方检验。如果体型是优、良、中、差四个分类，则这一分类有等级，原则
上不适宜做卡方检验，应考虑采用下一章的基于秩次的非参数方法。
二、配对RXR列联表资料的卡方检验
在前面已经讨论过的配对2×2列联表资料中，定性变量只有2个“取值”，
但在实际工作中，更多的定性变量具有R（R≥2）个可能的“取值”，配对RxR
列联表中（如表8-9），定性变量1和变量2都有R个可能的“取值”，R>2。这里
要分析的问题是这两个样本分布的总体的概率分布是否相同。即指定零假设为
两变量概率分布相同，对立假设为两变量概率分布不同。
表8-9配对设计资料的R×R列联表
变量2
变量1
合计
1
2
R
1
A1
A12
AiR
2
A21
A22
A2R
n2
***
R
ARI
AR2
ARR
nR
合计
m
m
mR
n（固定值）
配对设计资料RxR列联表资料与独立样本RxC列联表资料的设计不同，因
此统计分析处理方法也不相同，对此类资料感兴趣的读者可参见宇传华主编的
《SPSS与统计分析》第187页至第200页。
第八章卡方检验137
三、行×列表卡方检验的注意事项
（1）若表格中结果变量是按多个等级（有序）分类，且等级数大于等于3
时，应采用下一章介绍的基于秩次的非参数检验。
（2）R×C列联表卡方检验有统计学意义时，只能认为各总体率或构成比之
间总的来说有差别，但不能说明它们彼此之间都有差别，若要进一步解决此问
题，可用卡方分割法进行两两比较。
（3）R×C列联表卡方检验适用条件为：一般情况下应该理论频数T≥5，
不能有理论频数T<1的格子，且1≤T5的格子数不超过总格子数的1/5。
（4）条件不足时可以采用以下方法：
①增大样本例数使理论频数变大，这是最好的方法；
②如果专业上充许，可删去理论频数太小的行或列，或将理论频数太小的
行或列合并；
③改用行x列表的Fisher确切概率检验，可以用SPSS、SAS等软件实现。
第四节Fisher确切概率检验
前面已经提到，当四格表nK40，或飞1时，需采用四格表资料的确切概率法。
另外，用Pearson卡方检验或连续校正计算得到的概率接近检验水准时，也可采用
确切概率检验。该方法的思想是：在四格表周边合计不变的条件下，用公式：
(a+b)!(c+d)!(a+c)!(b+d)!
P=
(8-6)
a!b!c!d!n!
直接计算出四格表内a、b、c、d四个数据在各种组合下的概率（式中a、b、c
138兽医统计学
d为四格表中的四个频数，n为总例数）。然后，按检验假设计算单侧或双侧的累
计概率P，把P值与检验水准a比较，作出是否拒绝H的决定。
Fisher确切概率检验的计算量较大，对小样本使用此方法较理想，不过在有
计算机和统计软件的条件下，大样本四格表资料用计算机软件作Fisher确切概率
检验速度并不慢。但必须注意：如果满足Pearson卡方检验或校正卡方检验条件
的情况下建议还是使用卡方检验，不要直接选用Fisher确切概率检验，我们仅用
Fisher确切概率检验结果作为参考。
此外，对于RxC列联表资料，也有对应的Fisher确切概率检验方法，其计算
可以借助SPSS、SAS、R等统计软件实现。
第九章
非参数检验
140兽医统计学
【例9-1】
分析两种兔子之间的差异首先从血糖的调节功能开始实验。分别测定
了两个不同品种免停食18h后的血糖值，测得的数据整理如表9一1所示。那
么，这两种兔子的血糖值是否有显著差异呢？
表9一1两种兔子的血糖值
品种
每100mL血糖值（mg）
A
117
116
128
108
121
101
123
124
B
137
136
121
113
100
112
114
【问题9-1】
（1）根据实验设计及上表数据，应该采用什么方法进行检验？
（2）该类方法有何特点？
（3）该类方法有何用途？
【分析】
（1）这种资料适宜运用非参数检验中两个独立样本的Wilcoxon符号秩
检验分析或t检验。
（2）为了克服参数检验的条件限制，一系列不以特定的总体分布为前
提、不针对决定总体分布的参数作推断的方法相继出现，此类方法相对于
参数检验统称为非参数检验。非参数检验的优点是较稳健，因为对总体
分布的假定条件大大放宽。
（3）前面有关章节中介绍的t检验、方差分析等方法均要求数据来自正
态分布总体，且各组数据总体方差相等。此类统计分析方法在理论上要求
样本来自特定的总体分布，且对未知总体参数作推断的假设检验方法称参
数检验。而在实际研究中数据往往不满足上述条件，例如，比较不同组间
第九章非参数检验
141
研究对象的血清铁蛋白含量、实验动物患癌后的生存时间、临床疗效等级
评分等指标，这类资料的特点是总体分布类型未知，或分布类型已知但不
对称，或变量可能无法精确测量。这些特点恰恰不符合t检验、方差分析等
方法的适用条件。在这些情况下，采用非参数检验更为合适。
本章讨论以下知识点：
（1）当不满足参数检验的假设时，可以采用的不同方法；
（2）参数与非参数检验之间区别的描述；
（3）在什么情况下对于一个数据集更适合用非参数检验；
（4）如何确定一个适合于符号秩检验、Wilcoxon秩和检验或Kruskal
WallisH检验的数据集，并进行检验。
非参数检验是先将数值变量从小到大，或等级从弱到强转换成秩次
（1、2、）后，再计算检验统计量。其适用条件如下。
对于定量资料：
（1）不满足正态分布和方差齐性条件的小样本资料；
（2）分布不明的小样本资料；
（3）一端或两端是不确定数值（如<0.5、>0.5等）的资料（必选）。
对于等级资料，若选行×列表资料的X检验，只能推断构成比差别，而
选秩转换的非参数检验，可推断等级强度。但是，由于它仅仅考虑排序，
数据信息利用不够充分，其检验效能不如正态分布资料的t检验和F检验高。
第一节配对样本的Wilcoxon符号秩检验
配对资料Wilcoxon符号秩检验可用于推断总体中位数是否等于某个指定值，
还可用于推断配对样本差值的总体中位数是否为0。其基本思想是：先求出每
142兽医统计学
对观察值的差值d，按d的大小编秩，分别求正、负秩次之和。如果两观测结果
相同，则每对变量差数的总体是以0为中心对称分布的，差值的总体中位数为0；
反之，如果差别太大，就拒绝分布位置相同的假设。
设x，x，"x,和y，y，"y分别为来自总体X、Y的样本，X、Y的分布函数
分别为连续函数F（x）和F（x）。建立假设：H：F（x）=F（x）；H：F（x）≠F（x）。
差值Z=x-y（i=1，2，"n），取差值绝对值Z，并计算Z的秩，记为T。若Z>0，
记其秩为T+，称为正秩；若Z<0，记其秩为T-，称为负秩。分别对正负秩求
和，秩和绝对值较小者即为检验统计量T，再根据样本量查符号秩检验表得5%
水平的显著性临界To.o5，当检验统计量T小于该临界值时，就表明在这一显著水
平下可以否定原假设。
【例9-2】
某奶牛场想用改良的方法来检测奶样的乳脂率，但不确定该方法是否
与原始方法测定结果一样。分别运用这两种方法检测10个奶样的乳脂率，
结果如表9-2所示。
表9-2两种方法检测的奶样乳脂率
项目
乳脂率（%）
奶样序号
1
2
3
4
5
6
8
6
10合计
(1)
原始方法
4.33
3.98
3.84
3.933.963.754.323.764.383.84
（2)
改良法
4.28
3.85
3.79
94.094.043.784.453.954.183.93
(3）
差值d
0.05-0.13-0.050.160.080.030.130.19-0.20.09
（4）=（3)-（2)
正秩
8
1
6.5
9
5
33.5
（5）
负秩
2.5
6.5
2.5
10
21.5
(6)
第九章非参数检验143
在此实验设计中，10个奶样均分成同样的两份，分别运用两种方法进
行检测，想要知道的是两种方法得出的结果有无差别。运用配对设计资料
的符号秩检验进行分析，步骤如下：
（1）建立检验假设，确定检验水准。
H：差值的总体中位数等于0
H：差值的总体中位数不等于0
α=0.05
（2）计算检验统计量。求检验统计量T值：①省略所有差值为0的对
子数，令余下的有效对子数为n，见表9-2第4栏，因该题中没有d=0的对子
数，所以，n=10；②按10个差值的绝对值从小到大编正秩和负秩，遇差
值的绝对值相等者取平均秩，称相同秩（ties）（样本较小时，如果相同秩
较多，检验结果会出现偏差，因此应提高测量精度，尽量避免出现较多的
相同秩），例如表9-2第（4）栏中差值的绝对值为0.13有2个，其秩依次为
2、7，皆取平均秩为6.5，见第（5）（6）栏；③任取正秩和或负秩和为T
本例基于负秩的结果则取T=21.5。计算也可直接用计算机软件操作。将数
据输入，选择SPSS中的“分析一非参数检验一两配对样本秩和检验”，结
果如表9-3所示。
表9-3SPSS配对样本的Wilcoxon符号秩检验的分析结果
（1）奶样脂乳率检验
改良法一原始方法
N
秩均数
秩和
负秩
4
5.38
21.50
正秩
6b
5.58
33.50
总数
10
注：a.改良法<原始方法。b.改良法>原始方法。
144兽医统计学
（2）Wilcoxon符号秩检验的统计量
类别
改良法一原始方法
Z
-0.612
渐近显著性（双侧）
0.540
注：a.基于负秩的结果。
（3）确定P值，作出推断结论。由表9一3结果可以看出，双侧检验的概
率P=0.0540>0.05，按α=0.05水准，不拒绝Ho，尚不能认为两组方法的差别
有统计学意义。
当数据是正态分布时，也可用符号检验替代单样本t检验或配对t检验。
但因符号检验效能较低，目前已使用较少。
第二节两个独立样本的Wilcoxon秩和检验
两个独立样本Wilcoxon秩和检验的目的是推断连续型资料或有序资料的两
个独立样本所代表的两个总体分布位置是否有差别。
在理论上检验假设H应为两个总体分布位置相同，即两个样本来自同一总
体。由于秩和检验对于两个总体分布的形状差别不敏感，对于位置相同、形状
不同但类似的两个总体分布，如均数相等、方差不等的两个正态分布，秩和检
验推断不出两个总体分布（形状）有差别。因此，对立的备择假设H不能为两
个总体分布不同，而只能为两个总体分布位置不同。在实际应用中检验假设H
可写作两个总体分布位置相同。Wilcoxon秩和检验适用于两组完全随机设计定
量资料的分析。
第九章非参数检验
145
【例9-3】
2012年金定鸭的9个家系和台湾褐色菜鸭的10个家系的受精蛋孵化率详
见表9-4，现需检测这两个不同品种鸭的受精蛋孵化率是否存在显著性的
差异。
表9-4两个品种鸭的受精蛋孵化率
金定鸭
秩
褐色菜鸭
秩
0.689
7
0.925
18
0.730
9
0.850
16
0.560
4
0.738
10.5
0.707
8
0.906
17
0.459
3
0.639
5
0.680
6
0.968
19
0.808
13
0.818
14
0.436
1
0.754
12
0.452
2
0.738
10.5
0.821
15
n=9
T=53
n=10
T=137
*：试验用数据来源于国家水禽品种资源基因库（福建）。
（1）建立检验假设，确定检验水准。
H：两个品种鸭的受精蛋孵化率的总体分布位置相同
H：两个品种鸭的受精蛋孵化率的总体分布位置不同
α=0.05
（2）计算检验统计量。
求检验统计量T值：①把两样本数据混合从小到大编秩，遇数据相等者
取平均秩；②以样本例数小者为n，其秩和（T）为T，若两样本例数相等，
可任取一样本的秩和（T或T）为T，本例T=53。也可直接用计算机软件得
出结果。
146兽医统计学
选择SPSS中的“分析一非参数检验一两个独立样本的秩和检验”，结果
如表9-5、表9-6
表9-5受精蛋孵化率Mann-Whitney检验
品种
N
秩均数
秩和
1
9
5.89
53.00
2
10
13.70
137.00
表9-6非参数检验统计量ab
类别
受精蛋孵化率
Mann-WhitneyU
8.000
WilcoxonW
53.000
Z
-3.022
渐近显著性（双侧）
0.003
精确显著性（单侧）
0.001*
注：a.没有对结果进行修正。
b.分组变量：不同鸭品种。
（3）确定P值，作出推断结论。
由表9-5、表9-6可知，2组数据的平均秩次分别为5.89和13.70，Z值
为-3.022，相伴概率是P=0.003<0.05，应该拒绝两独立样本总体均数无显著
性差异的零假设，即认为不同品种鸭的受精蛋孵化率存在显著性的差异。
两独立样本是来自完全随机设计的两样本，而配对样本是配对设计的
资料。配对设计是将受试对象按照某些重要特征配成对子，再将每对中的
两个受试对象随机分配到两处理组。在医学研究中，配对设计主要有以下
情形：①两同质受试对象配成对子分别接受两种不同的处理；②同一受
试对象分别接受两种不同的处理；③同一受试对象接受（某一种）处理的
前后。
第九章非参数检验147
第三节完全随机设计多个样本比较的
Kruskal-WallisH检验
多样本Kruskal-WallisH检验的基本思想是：先将各处理组数据混合在一起
按从小到大顺序编秩次，如果有相同数据则取平均秩次，记观测值Y的秩为R
对每一组观测值的秩求和，得到第组的秩和R=∑R，其中i=1，2，"，k是每
/=1
组的编号，=1，2，"，n是每组内部个体值的编号。由R=Rn计算每组的平
均秩次。如果零假设为真，则秩应该在k个组之间均匀分布，每组实际的平均数
R与所有资料平均秩R=（N+1）/2的偏差应该很小。若R差异很大，就可以拒
绝零假设。Kruskal-WallisH检验的检验统计量为：
12
R²
H=-
-3(N+1)
N(N+1)（
n）
(9-1)
当存在较多相同的秩次时，检验统计量H可以修正为：
Hc=H/C
其中，
C=1-∑（t²-t)/(N²-N)
（9-2)
C为校正系数。t为第j个相同秩次的个数。
当样本量较大时，统计量H近似服从自由度为k-1的卡方分布，当样本量较
小时，可查秩和检验H界值表。
Kruskal-WallisH检验的步骤如下：
（1）设立假设；
（2）编秩次，将各组数据混合在一起由小至大顺序编秩次，每一数值对应
的顺序号就为该数值的秩次，数值最小的秩次为1，数值最大的秩次为多组样本
量之和，相同数值计算平均秩次；
148兽医统计学
（3）求秩和，分别将各组的秩次相加求和，计算H值：
（4）统计推断，查卡方值表。
当然，应用计算机统计软件SPSS检验输人结果会更加便捷。
一、多组连续变量资料的秩和检验
【例9-4】
分别用三种饲料饲养同类白鼠，并在开始前和8周后分别对白鼠进行称
重，其体重的增加量详见表9-7。研究这三种饲料对白鼠体重增加量有无显
著性差异，应该采用什么方法检验呢？
表9-73种饲料饲养白鼠8周后体重增加量（g）
甲种饲料
乙种饲料
丙种饲料
100
110.5
120.5
105
108
130
110.5
120
135
126
135
140
118
140.5
150.5
120.5
126
134
125.5
165
资料为多组连续变量资料，可采用秩和检验检测其总体分布位置有无
差别。步骤如下：
（1）建立检验假设，确定检验水准。
Ho：三种饲料对白鼠体重增加量的总体中位数相等
H：三种饲料对白鼠体重增加量的总体中位数不等或不全相等
α=0.05
（2）计算检验统计量。选择SPSS中的“分析一非参数检验→多个样本
的秩和检验”，其结果如表9-8。
第九章非参数检验
149
表9-8SPSS秩和检验分析结果
（1）增重量秩次
分组
N
秩均数
甲种饲料
6
5.58
乙种饲料
7
9.93
丙种饲料
7
15.29
总数
20
（2）检验统计量
类别
增重量
卡方值
8.816
df
2
渐近显著性
0.012
（3）确定P值，作出推断结论。计算结果表明，P=0.012，差异有显著
性意义，即这三种饲料对白鼠体重增加量有显著性差异。
经多个独立样本的秩和检验，若P<0.05，拒绝零假设H。，总体有显著
性意义，但是不能认为样本两两之间有差异均有统计学意义。若要了解上
述数据两两之间是否有差异，需要进行两两比较。
二、多组有序变量资料的秩和检验
【例9-5】
为研究三种中药配方对提高生猪肉质的影响，根据猪肉大理石纹将肉
质分为4个等级，统计三种配方下满足4个等级的生猪肉质各有多少，试验
结果整理如表9-9，试比较三种中药配方对猪肉大理石纹的影响有无显著性
差异？
150兽医统计学
本例为等级分组资料，与上例的主要差别在于秩和及校正H值的计算，
检验步骤如下：
（1）建立检验假设，确定检验水准。
Ho：三种配方的大理石纹的总体分布位置相同
H：三种配方的大理石纹的总体分布位置不同或不全相同
（2）计算检验统计量。确定各等级的平均秩次范围，见表中的第6列，等
级1有2个个体，其秩次范围为1～2，等级2有5个个体，其秩次范围为3～7，
等级3的秩次范围为8~15，等级4的秩次范围为16。
表9-9中草药提高肉质试验的大理石纹资料及其秩和计算
秩次
平均
各组秩和
等级
配方1
配方2
配方3
合计
范围
秩次
配方1
配方2
配方3
1
2
2
1~2
1.5
3
2
1
1
3
5
3~7
5
5
5
15
3
3
1
4
8
8~15
11.5
34.5
11.5
46
4
1
1
16
16
16
合计
4
4
8
16
39.5
19.5
77
计算各等级的平均秩次，将表中第6列中秩次范围的上下两值相加除以2，
列于表中第7列，然后计算各配方组中各等级的秩和，例如配方2有2头为等
级1，1头为等级2，1头为等级3，将配方2组各等级的头数与平均秩次相乘，
列于配方2组秩和的相应等级中。最后计算秩和，将同一配方组合中各等级
的秩和相加，根据上述公式计算H值及校正H值。
（3）确定P值，作出推断结论。查自由度等于2时的卡方临界值，得5%
的卡方临界值为5.99。或直接应用计算机统计软件SPSS，得出P值大于0.05，
经比较，可知各组大理石纹差异不显著。当然，对于本例的结论，可能是
各组样本量较小所引起，因此还应增加样本量继续试验。
第十章
简单相关与回归
152兽医统计学
【例10-1】
研究人员在仙湖肉鸭的生产性能研究中，得到如下一组关于周龄与肉
鸭体重（g）的数据（详见表10-1）。研究人员希望通过这组数据得到仙湖
肉鸭周龄与体重之间的函数关系，以方便后续的选育工作。
表10-1仙湖肉鸭周龄与体重（g）对照表
周龄
0
2
4
5
6
7
体重（g）
60.7
250.2
582.5
1285.3
1920.8
2556.7
3165.2
3450.5
【问题10-1】
（1）如何判断仙湖肉鸭周龄与体重是否是直线相关？怎样度量这种直
线相关程度？
（2）假设已经判断出仙湖肉鸭周龄与体重具有直线相关关系，如何求
得相应的直线方程？
（3）如果上表中仙湖肉鸭体重数据并非具体数字，而是等级数据，又
该如何测度周龄和体重的相关程度？
（4）在进行直线回归分析后，发现拟合结果并不理想，于是试图进行
曲线回归？又该如何操作？怎样比较不同曲线拟合效果的优劣？
【分析】
（1）应先绘制仙湖肉鸭周龄与体重的散点图，通过观察散点图可以直
观地判断二者是否直线相关，再通过计算相关系数来度量相关程度。
（2）本章第二节讲解了计算拟合直线方程系数的方法，也可以将数据
输入SPSS或Excel直接拟合直线方程。
（3）仙湖肉鸭体重数据是等级数据时，直线相关和直线回归就不再适用。
此时可以进行等级相关分析，用Spearman等级相关系数来度量相关程度。
第十章简单相关与回归153
（4）研究人员仍然可以利用SPSS和Excel来进行曲线回归，通过比较
决定系数R的大小来判断不同曲线拟合效果的优劣，R越大，拟合效果
越好
客观事物是相互联系和制约的，反映在数量上，就表现为变量与变量
间的联系与制约。变量间的关系有两种类型，一是确定性的函数关系，如
圆的面积S与半径r的关系为S=πr²；二是非确定性的关系，如仔猪的断奶
体重与初生体重有密切关系，但断奶体重并非由初生体重大小所唯一确定，
是受遗传、饲养、管理等多方面因素影响的结果。运用统计学方法，找出
变量间非确定性关系的数学表达式，是相关和回归分析的任务。
第一节直线相关
在医学研究中，当两个变量不分主次时，如体重和身高、年龄和血压，可
以通过线性相关来刻画它们之间可能存在的线性相关方向与程度。
一、直线相关的概念
简单线性相关（simplelinearcorrelation），简称直线相关（linearcorrelation）
或简单相关（simplecorrelation），是分析两个连续型变量之间的线性相关关系
的方法，适用于双变量正态分布（bivariatenormaldistribution）资料。
线性相关的性质可由散点直观地观察，图10-1（a）中散点呈椭圆形，两
变量呈同向变化趋势，称为正相关（positivecorrelation）；图10-1（b）中散点
呈椭圆形，且两变量呈反向变化趋势，称为负相关（negativecorrelation）；图
10-1（e）中两变量呈同向变化，散点在一条直线上，称为完全正相关（perfect
154兽医统计学
positivecorrelation）；图10-1（f）中两变量呈反向变化趋势，且散点在一条
直线上，称为完全负相关（perfectnegativecorrelation）；图10-1的（c）、（d）、
（g）及（h）中两变量没有直线相关关系，称为零相关（zerocorrelation）。正
相关或负相关并不一定表示一个变量的改变是另一个变量变化的原因，有
可能同受另一个因素的影响。相关分析的任务就是对相关关系给以定量的
描述。
I>4>0
0>>-
p=0
r=0
(a)
（b）
（c）
(d)
r=1
r=-1
r=0
r=0
(e)
(f）
(g)
(h）
图10-1直线相关示意图
二、线性相关系数的意义和计算
线性相关系数（linearcorrelationcoefficient）又称Pearson积差相关系
数（Pearsoncoefficientofproduct-momentcorrelation），用符号r表示样本相关
系数。
相关系数说明具有线性关系的两个变量，相关关系的密切程度和相关方向。
计算公式为
第十章简单相关与回归155
（μ-）（x-x）
“11（<-）（x-x）
(10-1)
相关系数r没有单位，其值为-1≤r≤1。r的正负表示相关方向，r为正表
示正相关；r为负表示负相关。r的绝对值大小表示相关密切程度，r绝对值越
接近1，表示两变量相关关系越密切。r为零表示零相关，r的绝对值等于1表示
完全相关。
三、相关系数的假设检验
r是样本相关系数，是总体相关系数p的估计值。即使从p=0的总体中随机
抽样，由于抽样误差的影响，所得r也常不等于0。故计算一个样本的相关系
数r后，需要对总体相关系数p是否为0进行假设检验。常用t检验，其计算公
式为
r-0
S
1-r²
√n-2
(10-2)
式中，S为相关系数的标准误，自由度为n-2。
对同一样本，其相关系数r和回归系数b正负号一致，其假设检验是等价的。
四、操作注意事项
（1）操作提示。线性相关要求两个变量服从双变量正态分布，如果不服从，
则应考虑变量变换，或采用等级相关来分析。
（2）分析步骤。在分析前也必须做散点图，以使初步判断两个变量是否有
相关趋势，该趋势是否为直线，以及数据有无异常点。
156兽医统计学
【例10-2】
测量10头某品种绵羊的胸围（cm）和体重（kg），得到的数据详见表
10-2。可否由该数据说明该品种绵羊的胸围和体重具有相关性？
表10-210头某品种绵羊的胸围和体重
绵羊编号
1
2
3
4
5
6
7
8
9
10
胸围（cm）
68
70
70
71
71
71
73
74
76
76
体重（kg）
50
60
68
65
69
72
71
73
75
77
（1）经正态性检验绵羊的体重和胸围服从双变量正态分布，因此可以
对二者进行直线相关分析。
（2）根据上表中的数据，作出绵羊胸围和体重的散点图，散点图可以
通过Excel来绘制
绵羊胸围和体重散点图详见图10-2。
80
75
70
2065
60
重55
体
45
40
胸围（cm）
图10-2绵羊胸围和体重散点图
可以从散点图上初步判断绵羊的身高和体重之间存在相关性，并且这
种相关性是线性的。接下来就需要对这一直观判断进行进一步的定量检验。
（3）利用Excel内置的CORREL函数可以算出绵羊胸围和体重的样本相
关系数r=0.847，接下来需要对总体相关系数p进行显著性检验。
Ho:p=0
H:p≠0
第十章简单相关与回归157
利用公式（10-2）计算出的t值为4.51，自由度为8，由Exce1函数
“=TDIST（4.51，8，2）”，得到P=0.002，所以拒绝原假设，接受备择假设，
即绵羊的胸围和体重间的相关性有统计学意义。
第二节直线回归
一、线性回归的概念
线性回归（linearregression）是分析两个连续型变量之间依存变化数量
关系的统计方法，它是回归分析中最基本、最简单的情况，因此也称为简单
回归（simpleregression）。这两个变量的地位是不同的，其中一个作为自变量
（independentvariable），亦称解释变量（explanatoryvariable），用x表示，可以
是服从正态分布的随机变量，也可以是能精确测量和严格控制的非随机变量；
另一个作为因变量（dependentvariable），也称应变量（responsevariable），用y
表示。
线性回归通常的假设为：
（1）自变量与应变量间关系有线性趋势（linear）；
（2）每个观察个体之间相互独立（independent）；
（3）给定x值，对应的y服从总体均数为μyk、方差为o²的正态分布（normal
distribution);
（4）不同x所对应y的方差相等（equalvariance），均为o²。
为了方便记忆，以上假设称为LINE（线性）假设，因为线性、独立、正
态、等方差的首写字母为LINE。
若以变量x与y分别为横轴和纵轴，将成对的样本实测值绘制散点图，如图
158兽医统计学
10-3所示，各散点通常并不会恰好在一条直线上。根据散点图所反映出两个变
量的线性趋势，可以假定，对于自变量x的各个取值，相应的应变量y的总体均
数μ位于一条直线上，这时可以用某个适当的线性回归方程（linearregression
equation）来描述y的总体均数依赖于x的数值变化。回归方程如下：
Myx=a+βx
(10-3)
y
x
图10-3线性回归示意图
回归方程大多数情况由样本得到，称为样本回归方程或经验回归方程。如
果以表示μ的一个样本估计值，即x确定时y的样本均数，则样本回归方程的一
般表达式为：
y=a+bx
（10-4）
公式（10-4）中，a为回归直线在y轴上的截距（intercept），表示x值为0时y
的平均水平。α<0，表示直线与纵轴的交点在原点的下方；α>0，交点在原点的
上方；a=O，回归直线经过原点。b称为回归系数（regressioncoefficient），即直
线的斜率（slope），其统计学意义是：x每变化一个单位，y平均变化b个单位。
b0，表示直线从左上方走向右下方，即y随x的增大而减小；b>0，表示直线从
左下方走向右上方，即y随着x的增大而增大；b-0，表示直线与x轴平行，即x与
y无直线关系。
二、建立线性回归方程
从样本数据中求解a和6，实际上是拟合一条反映所有散点集中趋势的回
归直线，使得各实测值与对应该点估计值最接近。如图10-4所示，实测值y与
第十章简单相关与回归159
回归线上的估计值的纵向距离y-称为残差（residual）或剩余值，就是各点
残差要尽可能小。由于残差有正有负，通常要找一条各点残差平方和最小的
直线。
要保证各实测点距回归直线纵向距离平方和最小，通常用最小二乘法
（methodofleastsquare），推导出回归方程系数的计算公式：
∑(x-x）²
(10-5)
xq-<=n
(10-6)
式中，x，y分别是x，y的均数；是x的离均差平方和；L是x与y的离均差交叉
乘积和，简称离均差积和。
(Ex)(Ey)
=xy
(10-7)
n
两变量线性回归关系除了可以用公式（10-4）表示外，还可以在散点图上绘
制出样本回归直线作为一种直观的统计描述补充形式，此直线必然通过点（x，）
且与纵坐标轴相交于截距a。在自变量实测范围内，取易于读数的x值代人回归
方程得到一个点的坐标，连接此点与点（x，y）也可绘出回归直线。
P(x,y)
y-y
y-y
图10-4应变量平方和划分示意图
160兽医统计学
三、回归系数的假设检验
前面只完成了两变量关系的统计描述，要推断自变量x与应变量y间是否有
直线关系，需对总体回归系数B进行假设检验。即使样本来自总体回归系数为
零的总体，由于抽样误差的存在，样本回归系数b也不一定为零。
常用的假设检验方法有检验和方差分析。
1.检验
b-0
b
lh
y=n-2
S
S/√x
(10-8)
(4-A）<
SS
(10-9)
式中，S表示样本回归系数的标准误；S表示剩余标准差（residualstandard
deviation）。求得r值后查界值表得P值，按所取a水准作出推断。
2.方差分析
如图10-4所示，P点是双变量散点图中任一点，它的纵坐标被回归直线与
均数y截成3段，y-y=（y-）+（y-y）。若将全部点按上述法处理，并将等式
两端平方后求和，则有：
-+（-)=（-
（10-10)
上式用符号表示为：
SS=SS+SS
（10-11)
Vo=V+V剩
(10-12)
未考虑自变量与应变量的回归关系时，应变量的随机误差即为y的总变异SS；
当考虑了回归关系时，随机误差就减小为SS剩。若总体中两变量间存在回归关
系，回归变异应远大于随机误差。可采用统计量F来做推断回归变异是否具有
统计学意义。
第十章简单相关与回归161
SWSS
（10-13）
MS、MS新分别称为回归均方和剩余均方。统计量F服从自由度为V回、V剩的F
分布
四、资料分析步骤
回归分析的应用很广泛，但它有一定的适用条件，因此在拟合模型前，需
要对资料进行判断。
第1步：绘制散点图，考察数据是否满足线性趋势
如果图中发现有明显远离主体数据的观测值，则称之为异常点（outlier），
这些点很可能对正确评价两变量间关系有较大影响。对异常点的识别与处理需
要从专业知识和数据特征两方面来考虑，结果可能是现有回归模型的假设错误
需要改变模型形式，也可能是抽样误差造成的一次偶然结果甚至过失误差。需
要强调的是，实践中不能通过简单剔除异常数据的方式来得到拟合效果较好的
模型，只有认真核对原始数据并检查其产生过程认定是过失误差，或者通过重
复测定确定是抽样误差造成的偶然结果，才可以剔除或采用其他估计方法，例
如非参数回归与相关。
第2步：观察数据的分布
分析应变量的正态性、方差齐性，确定是否可以进行线性回归分析。模型
拟合完毕，通过残差分析结果来考察模型是否可靠。如果变量进行了变换，则
应重新绘制散点图并观察数据分布
第3步：拟合回归直线
第4步：残差分析
考察数据是否符合模型假设条件，主要包括以下两个方面。
（1）残差是否独立。实际上就是考察应变量y取值是否相互独立。采用
Durbin-Watson残差序列相关性检验进行分析。
162兽医统计学
（2）残差分布是否为正态。实际上就是考察应变量v取值是否服从正态分
布。可以采用残差列表及一些相关指标来分析，直观方法是图示法。
完成以上4步，才能认为得到的是一个统计学上无误的模型，下一步就是根
据统计学结果，结合专业实际作出结论。
第5步：结果的解释
反映两变量关系密切程度或数量上影响大小的统计量应该是回归系数或
相关系数的绝对值，而不是假设检验的P值。P值越小只能说越有理由认为变
量间的直线关系存在，而不能说关系越密切或越“显著”。另外，线性回归用
于预测时，其适用范围一般不应超出样本中自变量的取值范围，此时求得的预
测值称为内插（interpolation），而超过自变量取值范围所得的预测值称为外延
（extrapolation）。若无充分理由说明现有自变量范围以外的两变量间仍然是直线
关系，则应尽量避免不合理的外延。
【例10-3】
四川白鹅的生产性能研究中，得到如下一组关于鹅重（g）与70日龄
重（g）的数据，如表10-3。试建立70日龄重（y）与维鹅重（x）的直线回
归方程。
表10-3四川白鹅维鹅重（g）与70日龄重（g）
编号
维鹅重（x）
70日龄重（y）
1
80
2350
2
86
2400
3
98
2720
4
90
2500
5
120
3150
6
102
2680
第十章简单相关与回归
163
（续）
编号
维鹅重（x）
70日龄重（y）
7
95
2630
8
83
2400
9
113
3080
10
105
2920
11
110
2960
12
100
2860
（1）先绘制散点图，并添加趋势线，通过散点图直观判断x与y是否存
在线性关系（散点图可以通过Excel来绘制，见图10-5）。
y（g)3400
3200
3000
2800
2600
2400
2200
2000
70
80
90
100
110
120
130
x(g)
图10-5带趋势线的散点图
观察散点图及其趋势线，从散点图可以看出不存在异常点，并且直观
来看，x与v之间存在较强的线性关系。
（2）x为维鹅重，y为白鹅70日龄重，经正态性检验x与y都服从正态分布，
可以对其进行线性回归分析。接下来就可以运用Excel的数据分析工具下拉
菜单中的回归功能拟合回归直线，并对回归结果进行分析。
表10-4至表10-6是回归摘要分析表，包括三部分：回归统计、回归关
系的方差分析和直线回归的区间估计。
164兽医统计学
表10-4回归统计
回归统计
Multiple R
0.9774
R Square
0.9553
Adjusted R Square
0.9509
标准误差
60.9525
观测值
12
表10-4表明，拟合优度指标R为0.9553，说明建立的回归方程估测的可
靠程度较高。
表10-5回归关系的方差分析
df
SS
MS
F
P
回归分析
1
794339.5994
794339.600
213.8076
4.47×10-8
残差
10
37152.0673
3715.207
总计
11
831491.6667
表10-5表明，回归的F统计量为213.81，F对应的P值为4.47×10，说
明存在回归关系，即四川白鹅70日龄重与雏鹅重存在显著的直线关系。在
实际生产中，可以通过四川白鹅的雏鹅体重对70日龄鹅体重作出预测或
控制。
表10-6直线回归的区间估计
标准
总体回归系数的95.0%
回归系数
值
P值
误差
置信区间
下限
上限
Intercept
582.1850
147.3153
3.9520
0.0027
253.9460
910.4240
XVariable1
21.7122
1.4849
14.6222
4.47×10-8
18.4037
25.0207
表10-6说明了回归系数b的值为21.71，其标准误为1.485，b的t统计值
第十章简单相关与回归
165
为14.622，P值为4.47×10-，总体回归系数95%的置信区间为[18.404，
25.021]。回归截距a的值为582.2，其标准误为147.315，a的t统计值为3.952，
P值为0.0027，95%的置信区间为[253.946，910.424]。据此可列出四川白
鹅70日龄重与雏鹅重的直线回归方程为：=21.71x+582.2。
表10-7列出了的预测值及残差（y），图10-6是残差图。
表10-7预测值和残差
观测值
预测Y
残差
标准残差
1
2319.1582
30.8417
0.5307
2
2449.4313
-49.4313
-0.8506
3
2709.9773
10.0227
0.1725
4
2536.2799
-36.2799
-0.6243
3187.6449
-37.6449
-0.6478
6
2796.8259
-116.8259
-2.0102
7
2644.8408
-14.8408
-0.2554
8
2384.2947
15.7052
0.2702
9
3035.6597
44.3403
0.7630
10
2861.9624
58.0376
0.9987
2970.5232
-10.5232
-0.1811
12
2753.4016
106.5984
1.8342
200
100
美
0
X
120
70
80
06
100
110
130
-100
-200
图10-6残差图
166兽医统计学
图10-7是直线拟合图，可见y的实测值在预测值附近波动，表明拟合的
回归方程较合理。
3300
=21.71x+582.2
R²=1
3100
2900
y
预测Y
2700
线性（预测Y）
2500
2300
70
80
90
100
110
120
130
图10-7直线拟合图
第三节Spearman等级相关
一、等级相关分析法的概念
等级相关法（也称顺位相关法）侧重于观测数据的等级，就是把有关联的
不能精确描述的数量标志，或者某些品质标志的具体表现按等级次序排列，并
把等级顺序视为X和Y两个序数数列，再测定这两个序数数列之间的相关程度。
用这种方法计算的相关指标，叫做等级相关系数。其中Spearman等级相关运用
最为普遍。
二、等级相关系数
若分析样本含量为n的二维随机向量样本，用X代表其中的任一变量，设其
第十章简单相关与回归167
等级为X，X，""，X，（此等级按由小到大的顺序排列）。另一变量用Y表示，设
其等级观察值由小到大的顺序排列Y，Y，"，Y。每一组（X，Y）代表取自同
一联系单元的一对等级数值。如果两种等级完全正相关，则对所有i，应有X=Y；
如果两种等级完全负相关，则对所有i，应有X=Y，X=Y1，"，X=Y1。
Spearman等级相关系数着眼于差值D=X-Y，把D作为这些配对等级完全正
相关或完全负相关的偏离程度的量度。Spearman等级相关系数计算公式为：
n（n²-1)
（10-14)
Spearman等级相关系数r的值在+1与-1之间，数值为正代表正相关，数值
为负代表负相关。
样本等级相关系数r是总体等级相关系数p的估计值，要推断总体中两变量
X、Y间有无直线关系须经假设检验。
对Spearman相关系数的假设检验：
H:P=0
H:p≠0
当n≥10时，Spearman相关系数的检验统计量服从自由度为n-2的t分布：
n-2
(10-15)
三、Spearman等级相关的应用
在分析两事物数量间的直线关系时，对下列情况宜用Spearman等级相关：
1两事物的量，有的不能准确测量，只能按大小、程度、优劣或综合判断给出
顺序号；②虽可测量，但总体数据的分布未知或已知不是正态双变量，不能作
积差相关分析；（③只需对两事物数量之间的关系作初步分析等。
168兽医统计学
【例10-4】
做肝癌病因研究，调查了10个乡肝癌死亡率（1/100000）与某种食物中
黄曲霉毒素相对含量（以最高含量为10）见表10-8，试求两者之间的等级
相关系数。
表10-810个乡肝癌死亡率与食物中黄曲霉毒素含量
乡编号
黄曲霉毒素含量
死亡率
1
0.7
21.5
2
1.0
18.9
3
1.7
14.4
4
3.7
46.5
5
4.0
27.3
6
5.1
64.6
7
5.5
46.3
8
5.7
34.2
9
5.9
77.6
10
10.0
55.1
解：黄曲霉毒素含量和死亡率不服从双变量正态分布，不适合作积差
相关分析，可以作等级相关分析。将黄曲霉毒素含量（X）和死亡率（Y）
排秩，结果详见表10-9
第十章简单相关与回归
169
表10-9黄曲霉毒素含量和死亡率秩次
黄曲霉毒素含量
死亡率
D;
D²
X
秩次Rx
Y
秩次Ry
1
0.7
1
21.5
3
-2
4
2
1.0
2
18.9
2
0
0
3
1.7
3
14.4
1
2
4
4
3.7
4
46.5
7
-3
9
5
4.0
5
27.3
4
1
1
6
5.1
6
64.6
-3
9
7
5.5
7
46.3
6
1
1
8
5.7
8
34.2
5
3
9
9
5.9
9
77.6
10
-1
1
10
10
10
55.1
8
2
4
合计
55
55
42
将数据代入公式（10-14）就可以算出黄曲霉毒素含量（X）和死亡率
（Y）的Spearman等级相关系数。SPSS等统计学软件可以计算Spearman相关
分析，将需要分析的数据导入后即可得到分析的结果。本题利用SPSS分析
的结果详见表10-10。
表10-10SPSS的Spearman相关分析结果
黄曲霉毒素含量死亡率
Spearman'srho
黄曲霉毒素含量CorrelationCoeffcient
1.000
0.759
Sig.(2-tailed)
0.011
N
10
10
死亡率
Correlation Coefficient
0.759
1.000
Sig.(2-tailed)
0.011
N
10
10
Correlation is significant at the 0.05level（2-tailed）。
170兽医统计学
黄曲霉毒素含量（X）和死亡率（Y）的样本Spearman等级相关系数rs=0.759
的检验假设H：总体相关系数ps=0，H：Ps≠0，α=0.05，P=0.011<0.05，可
以认为黄曲霉毒素含量和死亡率存在正相关关系。
第四节曲线回归
在医学研究实践中，两个变量绝对的直线关系并不多见，不能用简单的直
线关系把它们的关系准确地表达出来。例如，血药浓度一时间曲线是先升后降；
药剂量与疗效反应率之间的关系呈曲线变化趋势。有时，在局部内两个变量的
关系也许呈直线趋势，扩大范围后却显示出曲线趋势。如马的生长发育，在某
一阶段，身高与年龄可以用线性模型来描述，但是从整个生命期看，身高与年
龄之间却是明显的曲线关系。
一、曲线直线化变换方法
当两个变量关系为曲线趋势时，如对数曲线、指数曲线等，可以采用变量
变换的方法使其直线化（rectification），然后通过线性回归来拟合模型。曲线直
线化是曲线拟合的重要手段。
1.变量的变换
所谓变量变换，是选用适当的函数将原始数据作某种转换，使数据满足直
线回归的应用条件。
例如，假定观察样本（X，Y），=1，2，，n满足
=bo+b,x²
(10-16)
Y与X之间呈指数函数关系，令X=X²，便可转化为线性模型
第十章简单相关与回归171
y=bo+b,x*
（10-17)
又如，假定观察样本（X，Y），i=l，2，"，n满足
y=e（bg=bx)
（10-18)
Y与X之间呈对数函数关系，令Y=1nY，便可转化为线性模型
y*=bo+bX
(10-19)
2.变量变换后实现线性回归的步骤
对于可以通过变量变换实现线性化的资料，回归的步骤如下：
（1）绘制散点图，观察散点分布特征类似于何种函数类型
（2）按照所选定的函数进行相应的变量变换；
（3）对变换后的数据建立直线回归模型；
（4）拟合多个相近的模型，然后通过比较各模型的拟合优度挑选较为合适
的模型。
上述方法对自变量X进行变换，然后用最小二乘法估计模型的参数，可以
保证残差平方和最小。但当涉及对应变量Y实施线性变换（如y*=1nY）时，因
为最小二乘法只能保证1nY的残差平方和最小，不能保证原变量Y的残差平方和
最小，所以在这种情况下，建议进行非线性拟合。
二、曲线回归
对两个变量间不呈直线关系的资料，除了上一节介绍的使用变量变换后的
直线回归分析外，还可以直接进行曲线拟合。曲线拟合（curvefitting）是求解
反映变量间曲线关系的曲线回归方程（curvilinearregressionequation）的过程。
1.一般步骤
曲线拟合的一般步骤如下：
（1）根据自变量X和应变量Y散点图呈现的趋势，结合专业知识及经验选择
合适的曲线形式。在某些情况下，绘制散点图时采用一些特殊的坐标系可能更
有利于揭示变量间的关系，更容易确定曲线方程的形式。例如，在半对数坐标
172兽医统计学
系中，散点呈现较为明显的直线趋势，即可选用指数曲线y=e（+x）或对数曲
线y=bo+b1nX。
（2）选用适当的估计方法求得回归方程。如果曲线形式可表示为X的某种
变换形式与Y的线性关系（例如，对数曲线y=b+b1nX），即可采用“曲线直
线化”的方法对变换后的z（如z=1nX）和Y作最小二乘拟合；如果曲线形式表
示为Y的某种变换形式Y与X的线性关系（例如，将指数曲线变换y=e（h-x）为
=bo+bX），则可采用“非线性最小二乘”（nonlinearleastsumofsquares）估计
方法。
（3）在实际工作中，有时可结合散点图试拟合几种不同形式的曲线方程并
计算R，一般来说，R较大时拟合效果较好。但应注意，为了单纯地得到较大
的R，模型的形式可能会很复杂，甚至使其中的参数无法解释实际意义，这是
不可取的。因此，要充分考虑专业知识，结合实际解释和应用效果来确定最终
的曲线形式。
决定系数R定义为
∑（y-)²
R²=1-
∑(y-)²
SS
（10-20)
2.曲线拟合的用途
（1）定量刻画X与Y的曲线关系。采用适当方法得到曲线回归方程之后，就
可以用X定量地预测相应的Y值或者进行逆估计。医学或生物学研究中经常可用
此方法绘制实验室中的标准工作曲线，例如用分光光度计的光密度值测定溶液
中某物质的浓度等。
（2）用相关指数反应两变量曲线关系的密切程度。把决定系数R开方，得
到的R值称为相关指数（correlationindex），其值在0到1之间，此数值离1越近，
表示两变量间关系越密切。如果两变量X与Y为直线关系，则相关指数在数值上
等于X与Y的积差相关系数r的绝对值；如果两变量X与Y为变换X之后可直线
化的曲线关系，则相关指数在数值上等于变换后的X·与Y的积差相关系数r的
绝对值；如果两变量X与Y为变换Y之后可直线化的曲线关系，那么相关指数须
第十章简单相关与回归173
通过公式（10-20）定义的决定系数R开方得到，或者等于Y与Y的积差相关系
数的绝对值，而不能等于X与Y或者X与Y'的积差相关系数r的绝对值。更一般
地说，不论何种情况，Y与Y的相关系数绝对值即相关指数R，可以反映两变量
曲线关系的密切程度。前面提到，积差相关系数r为0不一定表示两变量没有关
系，而只是说没有直线关系，如果是曲线关系，可以用相关指数R来描述这种
关系的密切程度。
3.常见的几种曲线拟合
无论进行何种曲线拟合，通常要考察原始数据的散点图来得到提示。图
10-8列出了几种常见的曲线类型作为参考。
X
X
a
b
C
d
图10-8两变量关系中常见的几种曲线形式
图10-8a中所示为对数曲线，为了使对数取值有意义，有时可以将自变量
加上某个常数再作拟合。图10-86中所示为指数曲线。图10-8c中所示称为抛物
线，可以将其中自变量的高次项作为新的变量，采用多元线性回归方法估计回
归系数，称为多项式回归（polynomialregression）。由于这些高次的新变量之间
常常会高度相关而使回归系数的最小二乘求解发生困难，可对这些变量进行恰
当的变换使之互不相关，称为正交多项式回归（orthogonalpolynomialregression）。
图10-8d中所示的S型曲线称为Logistic曲线，在生物医学中有很广泛的
应用。
174兽医统计学
【例10-5】
在禽多杀性巴氏杆菌感染对麻保沙星在鸡体内药动学特征的影响研究
中，得到一组感染鸡静注后采血时间与麻保沙星的血药浓度（mg/L）的数
据（见表10-11），试拟合并优选出血药浓度曲线。
表10-11感染鸡静注麻保沙星的血药浓度
时间
0.10.250.50.75
1.52
4
6
（h)
12
24
36
浓度
(mg/L)
解：首先绘制散点图，从散点图可以看出采血时间和血药浓度之间不
存在线性关系，可以考虑对其进行曲线回归，但具体二者之间存在何种曲
线关系目前并不清楚，因此需要进行不同类型的曲线回归，通过比较R值
的大小来确定最优拟合曲线。利用Excel可以进行指数、对数，多项式、幂
这四种曲线的拟合。图10-9给出的是对数曲线的拟合结果，回归方程为
y=-0.761ln（x）+2.2662，R²=0.9701；图10-10给出的是幂曲线的拟合结果，
回归方程为y=1.7483x-0.773，R²=0.8471。如选择直线、多项式、指数曲线拟
合其R分别为0.4745、0.7346和0.9402，由此可见，血药浓度曲线最佳的拟
合曲线是对数曲线，其R=0.9701，接近1，拟合的效果最优。
血药浓度
4
y=-0.7611n(x)+2.2662
3
R²=0.970
2
1
0
采血时间
0
10
20
30
40
-1
浓度（mg/L）——对数[浓度（mg/L）]
图10-9对数拟合
第十章简单相关与回归175
12
血药浓度
10
y=1.7483x-0.73
8
R²=0.847
6
4
2
0
采血时间
0
10
20
30
40
浓度（mg/L）
乘幂[浓度（mg/L）]
图10-10
幂拟合
第十一章
多重回归
178
兽医统计学
【例11-1】
某猪场为提前预知所屠宰猪的瘦肉量，特对25头育肥猪的体性状进
行记录。获得4个体性状的瘦肉量、眼肌面积、腿肉量、腰肉量数据资
料，如表11一1，试用多重线性回归分析方法建立以瘦肉量与眼肌面积、腿
肉量和腰肉量的多重线性回归方程。
表11-12
25头育肥猪4个体性状的数据资料
瘦肉量（kg）
眼肌面积（cm²）
腿肉量（kg）
腰肉量（kg）
编号
y
X
X
X3
1
15.02
23.73
5.49
1.21
2
12.62.
22.34
4.32
1.35
3
14.86
28.84
5.04
1.92
4
13.98
27.67
4.72
1.49
5
15.91
20.83
5.35
1.56
6
12.47
22.27
4.27
1.50
7
15.80
27.57
5.25
1.85
8
14.32
28.01
4.62
1.51
9
13.76
24.79
4.42
1.46
10
15.18
28.96
5.30
1.66
11
14.20
25.77
4.87
1.64
12
17.07
23.17
5.80
1.90
13
15.04
28.57
5.22
1.66
14
15.94
23.52
5.18
1.98
15
14.33
21.86
4.86
1.59
16
15.11
28.95
5.18
1.37
17
13.81
24.53
4.88
1.39
18
15.58
27.65
5.02
1.66
19
15.85
27.29
5.55
1.70
20
15.28
29.07
5.26
1.82
21
16.40
32.47
5.18
1.75
22
15.02
29.65
5.08
1.70
23
15.73
22.11
4.90
1.81
24
14.75
22.43
4.65
1.82
25
14.37
20.44
5.10
1.55
第十一章多重回归179
【问题11-1】
（1）在本例中出现的问题与第十章中的直线回归有何异同？
（2）可以采用什么方法进行分析？在分析的过程中需要注意哪些
问题？
【分析】
在上一章中，介绍了简单回归，用于分析单个自变量与应变量之间的
数量关系。而在本例中需要得到的多个自变量与应变量的回归方程，与简
单回归有所不同。本章将介绍由简单回归拓展而来的多重线性回归以及其
应用过程中应该注意的事项。
第一节多重线性回归
多重线性回归（multiplelinearregression）与多重相关（multiplecorrelation）
是研究多个变量之间的线性依存及线性相关的统计分析方法。
在医学研究中，医学指标通常受到多个因素的影响，如血压值除了受年龄
影响外，还受到性别、体重、劳动强度、饮食习惯、吸烟情况、饮酒情况、家
庭史等因素影响。用回归方程定量描述一个应变量Y与多个自变量X，X，“，
X的线性依存关系，称为多重线性回归，自变量的值可以是随机的，也可以是
人为固定的，但应变量则要求一定是随机的。
如果所有自变量与应变量都是随机的，则可用多重相关来描述应变量和一
组自变量之间的线性关系，用偏相关（partialcorrelation）描述在控制其他变量
影响后应变量和某一个自变量之间的线性相关关系。
多重线性回归（multiplelinearregression）是简单直线回归的推广，研究一
个应变量与多个自变量之间的数量依存关系。
180兽医统计学
一、多重回归模型
多重线性回归的数学模型为：
Y=βo+βX+...+βX,+e
（11-1)
式中，Y为应变量，是随机定量的观察值；X，X，"，X，为p个自变量。β为常数项，
B（j=l，2，，p）称为偏回归系数（partialregressioncoefficient）。β，（j=1，2，，
p）表示在其他自变量固定不变的情况下，自变量x每改变一个单位时，其单独
引起应变量Y的平均改变量。为随机误差，又称为残差（residual），它是Y的变
化中不能用自变量解释的部分，服从N（0，）分布。
由样本估计的多重线性回归方程为：
=bo+bx+...+bx
(11-2)
式中，Y为在各X取一组定值时，应变量Y的平均估计值或平均预测值。bo，
b，，b，是βo，β，，β的样本估计值。
不能直接用各自变量的普通偏回归系数的数值大小来比较方程中它们对应
变量Y的贡献大小，因为p个自变量的度量衡单位及变异度不同。可将原始数据
进行标准化，即
X-X
X=-
Sj
(11-3)
然后用标准化的数据进行回归模型拟合，此时获得的回归系数记为k。，k，"，
kp，称为标准化偏回归系数（standardizedpartialregressioncoefficient），又称为
通径系数（pathcoefficient）。标准化偏回归系数k绝对值较大的自变量对应变量
Y的贡献大。
二、参数估计
多重线性回归分析中回归系数的估计也是通过最小二乘法（methodofleast
第十一章多重回归
181
square）得到，即寻找适宜的系数bo，b，""，b，使得应变量残差平方和达到最小。
其基本原理是：利用观察或收集到的应变量和自变量的一组数据建立一个线性
回归模型，使得这个模型的理论估计值与观察值之间的离均差平方和最小。
在例11-1中，可用多重线性回归进行分析。在本例中，按照要求需要将瘦
肉量作为应变量Y，分别以眼肌面积、腿肉量、腰肉量作为自变量x、X、X。在
统计分析软件SPSS中，建立包含Y和X、X、X的数据文件，依次录入每个个体
（每头猪）各变量的具体数值。在SPSS中点击“Analyze一Regression一Linear”，
将变量Y选入应变量栏，将X、X、X选入自变量栏，自变量选择方法中选择
需要的方法（此处选择后退法）。在选择其他需要的选项之后，点击确定，在
SPSS完成计算后，可得到表11-2。
若不考虑变量的筛选，对选人变量不作要求，则可得到所求的多重线性回
归方程的常数项和X、X2、X的系数分别为0.998、0.015、2.057、1.950，即所
求的方程为：
=0.998+0.015X+2.057X+1.950X
表11-2某猪场育肥猪4个体性状SPSS多重线性回归分析结果
回归系数
模型
标准化回归系数k
值
P值
b;
Sbi
1（常数项）
0.998
1.405
0.710
0.485
X
0.015
0.030
0.046
0.500
0.622
X
2.057
0.274
0.717
7.498
0.000
X3
1.950
0.521
0.355
3.740
0.001
2（常数项）
1.216
1.313
0.926
0.364
X
2.080
0.266
0.725
7.830
0.000
X
1.981
0.509
0.360
3.893
0.001
三、回归方程的假设检验与拟合优度评价
建立的回归方程是否符合资料特点，以及能否恰当地反映应变量Y与p个自
182兽医统计学
变量的数量依存关系，就必须对该模型进行检验。
1.回归方程的检验与评价
零假设H：β=β=.=β=0；备择假设H：β（j=-1，2，p）不全为0。检
验统计量为F，计算公式为：
SSa/p
F=
SS/(n-p-1)MS
(11-4)
2.自变量的假设检验
（1）偏回归平方和检验。回归方程中某一自变量x的偏回归平方和（sumof
squaresforpartialregression），表示从模型中剔除x后引起的回归平方和的减少
量。偏回归平方和用SS（x）表示，其大小说明相应自变量的重要性。
检验统计量F的计算公式为：
SS(x,)/1
F=
SS/(n-p-1)
(11-5)
（2）偏回归系数的检验。偏回归系数的检验是在回归方程具有统计学意义
的情况下，检验某个总体偏回归系数是否等于0的假设检验，以判断相应的自变
量是否对应变量Y的变异确有贡献。
H:β=0，H:β≠0
检验统计量r的计算公式为：
S
b
(11-6)
其中，S为第/偏回归系数的标准误。
对于例11-1，利用SPSS分析输出结果显示，对X的偏回归系数进行检验
时，发现P值大于0.05，可认为X的偏回归系数不具有统计学意义。
第十一章多重回归183
四、使用条件
多重线性回归分析的前提条件和简单线性回归完全相同：即需要满足线性、
独立、正态和等方差，即LINE的要求。
1.Y与X，X，"，X之间具有线性关系；
2.各观察对象与应变量Y相互独立；
3.随机误差服从分布N（0，o），即对于任意一组自变量X，应变量Y具
有相同方差，并且服从正态分布。
第二节自变量的选择
在许多多重线性回归中，模型中包含的自变量没有办法事先确定，如果把
一些不重要的或者对应变量影响很弱的变量引人模型，则会降低模型的精度。
所以自变量的选择是必要的，其基本思路是：尽可能将对应变量影响强的自变
量选入回归方程中，并尽可能将对应变量影响弱的自变量排除在外，即建立所
谓的“最优”方程。
一、筛选标准与原则
对于自变量各种不同组合建立的回归模型，使用全局择优法选择“最优”
的回归模型。
1.残差平方和减小与决定系数增大
如果引入一个自变量后模型的残差平方和减少很多，那么说明该自变量对
应变量Y的贡献较大，应将其引入模型；反之，说明该自变量对应变量Y的贡献
184兽医统计学
小，不应将其引入模型。另一方面，如果某一变量剔除后模型的残差平方和增
加很多，则说明该自变量对应变量Y贡献大，不应被剔除：反之，说明该自变量
对应变量Y贡献小，应被剔除。
2.残差均方缩小与调整决定系数增大
残差均方缩小的准则是在残差平方和缩小准则基础上增加了（n-p-1）因子，
它随模型中自变量p的增加而增加，体现出对模型中自变量个数增加所实施的惩罚。
3.C统计量
由C.L.Mallows（1964年）提出，其定义为：
SS成
+2q-n
(11-7)
式中为全模型的残差均方估计；q为所选模型（包括常数项）中的自变量个数。
如果含g个自变量的模型是合适的，则其残差平方和的期望E（SS残差）=
（n-p）o²。假定全模型的残差均方估计的期望E（²）=o²为真，则SS残差/²近
似等于（n-p），因此C的期望近似等于模型中参数的个数，即E（C，）=a。用
C，值对参数个数g绘制散点图，将显示“合适模型”的散点在直线C，=q附近，拟
合不佳的模型远离此线。
二、自变量筛选常用方法
1.前进法（forwardselection）
事先定一个选人自变量的标准。开始时，方程中只含常数项，按自变量对Y
的贡献大小由大到小依次选人方程。每选入一个自变量，则要重新计算方程外
各自变量（剔除已选入变量的影响后）对Y的贡献，直到方程外变量均达不到选
入标准为止。变量一旦进人模型，就不会被剔除。
2.后退法（backwardselection）
事先定一个剔除自变量的标准。开始时，方程中包含全部自变量，按自变
量对y的贡献大小由小到大依次剔除。每剔除一个变量，则重新计算未被剔除的
第十一章多重回归185
各变量对Y的贡献大小，直到方程中所有变量均不符合剔除标准，没有变量可被
剔除为止。自变量一旦被剔除，则不考虑进入模型。
3.逐步回归法（stepwiseselection）
逐步回归法其本质是前进法，在自变量筛选过程中结合了后退法的特点。
该法每引人一个自变量，都会对已在方程中的变量进行检验，对符合剔除标准
的变量要逐一剔除。
第三节多重线性回归的应用与注意事项
一、多重线性回归的应用
（1）影响因素分析：用于分析解释对应变量起决定和预测作用的自变量，
司时知道该自变量对结果的影响程度。如例12-1中即利用眼肌面积、腿肉量、
腰肉量来预测瘦肉量，用较为易得到的数据来预测获得比较困难的数据。
（2）解释自变量的影响大小：在控制住其他自变量的时候，研究结果变量
和某一个自变量之间的关系。
（3）预测：在获得自变量的情况下，预测结果变量的取值。
二、多重线性回归的应用的注意事项
1.复相关系数、决定系数与调整决定系数
一般来说，当方程中自变量的个数增加时，或多或少总能减少残差，提高
模型的拟合精度，但会使模型复杂化。要保证模型内自变量“少而精”，就需要
一些量化的指标来衡量所得模型的“优劣”。决定系数、复相关系数和调整决定
系数常用于衡量方程的“优劣”。
186兽医统计学
决定系数（coefficientofdetermination）R，是回归平方和占总离均差平方
和的比例，即
R²=SS/SS点
(11-8)
用以反映线性回归模型能在多大程度上解释应变量Y的变异。其取值范围为
0≤R≤1，决定系数R的值越接近1，表示样本数据对所选用的线性回归模型的
拟合很好。R直接反映回归方程中所有自变量解释了应变量Y总变异的百分比，
也可以说，R可以解释为回归方程使应变量Y总变异减少的百分比。
复相关系数（multiplecorrelationcoefficient）R，是决定系数的平方根，表示
p个自变量共同对应变量线性相关的密切程度。p=1时，R=r，r为简单相关系数。
调整的R（adjustedR-square）反映模型的拟合优度。定义为：
MS
(1-R²）=1-
n-p-1
MS
（11-9）
它增加了对方程中引人自变量的“惩罚”，当有统计学意义的变量进人方程
时，可使调整的R²增加；而当无统计学意义的变量进入方程时，调整的R反而
减少。因此，调整的R是衡量方程优劣的重要指标。
2.偏相关系数
当分析两个变量相关关系时，通常会有其他变量的影响在里面，使得计算
的相关系数难以体现所分析的两个变量间的真实相关关系。可以通过控制其他
变量的影响，在其他变量固定不变的情况下分析这两个变量的关系，这就是偏
相关分析。
偏相关系数（partialcorrelationcoefficient）用于反映其他变量一定时，任
意两个变量间的相关关系。
ry=±√SSm(x)/ss(p-1)
（11-10）
上式为X与Y的偏相关系数，其符号与偏回归系数b的符号一致。SS（x）
为偏回归平方和；SS（p-1）为去掉x后，Y对其余p-1个自变量作线性回归时
第十一章多重回归187
的残差平方和。
Ir愈接近1，则X与Y的线性关系愈密切，其检验假设为总体偏相关系数pv
为零
3.哑变量的设置
在多重线性回归模型中，回归系数b表示在其他自变量固定的情况下，X
每改变一个单位时，应变量Y的平均变化量。当自变量为连续型或二分类的变
量时，解释上是没有问题的，但是当X为多分类（特别是无序分类）变量时就
不能这样简单地直接分析，因为各个变量值只是以代码的形式选入方程，不
代表它们之间的数字上的差距。比如血型，A型、B型、AB型、O型之间是平
等的，不存在大小问题。这时，需要把原来的多分类变量转化为（水平数一1）
个哑变量（dummyvariable），每个哑变量只代表两个级别或若干个级别间的
差异。
哑变量适用于任何回归模型中自变量为多分类的情况，但是在Logistic
回归模型和Cox比例风险模型中应用较多。SPSS软件的Linear过程对话框里
没有提供对哑变量的支持，需要用户使用compute过程自行建立，这里只作
简要介绍。
根据分类自变量的特点，可分为多分类无序自变量和多分类有序自变量，
其具体设置的意义不全相同，具体可参考相关资料。此处以多分类无序自变量
为例，各类别是相互独立的，只是在代码上有大小关系，而本身无大小之分，
因此在拟合时需要采用哑变量选人模型。如前面所举的血型例子，4种血型，设
置3个哑变量，具体如表11-3所示。
表11一34种血型哑变量的设置
0型
A型
B型
AB型
X
0
1
0
0
X
0
0
1
0
X
0
0
0
1
从哑变量的取值特征可以看出，3个哑变量为0时，代表0型水平，说明它
188兽医统计学
是基础水平；X为1，其余哑变量为0时，代表A型水平；X为1，其余哑变量为
0时，代表B型水平；X为1，其余哑变量为0时，代表AB型水平。这些哑变量由
于是代表同一个变量的不同取值水平，因此在分析时应同时选人或同时剔除模
型，即使有部分哑变量具有统计学意义。
4.多重共线性
多重共线性（multi-colinearity）是多重回归分析时存在的一个普遍问题。
多重共线性是指自变量之间存在近似的线性关系，即某个自变量能近似地用其
他自变量的线性函数来表示。在实际回归分析应用中，自变量间完全独立很难，
所以共线性的问题并不少见。自变量一般程度上的相关不会对回归结果造成严
重的影响，然而，当共线性趋势非常明显时，它就会对模型的拟合带来严重
影响。
（1）偏回归系数的估计值大小甚至是方向明显与常识不相符；
（2）从专业角度看对应变量有影响的因素，却不能选人方程中；
（3）去掉一两个记录或变量，方程的回归系数值发生剧烈的变化，非常不
稳定；
（4）整个模型的检验有统计学意义，而模型包含的所有自变量均无统计学
意义。
当出现以上情况时，就需要考虑是不是变量之间存在多重共线性。
5.交互作用
多重回归模型中有多于2个自变量时，可能就存在自变量间的交互作用。如
果一个模型中X，X，“，X的一次项加起来仍不足以“解释”Y，有时还需要
考虑两个自变量联合的额外效应或交互效应（交互作用）。
例如，在生物化学过程中，常有两个因素联合效应不同于单独效应之和的
情形。如催化剂的单独效应为零，与其他因素配合却能较大地提高效应。
在回归分析中，若X，X存在交互效应，最常用的方法是在回归模型中增
加X，X的乘积项，如
y=bo+bx+bX+bxx2
(11-11)
在参数估计时，可令X=XX，按模型
第十一章多重回归189
y=bo+bx+bx+bx
(11-12）
估计参数。
事先判断是否存在交互效应主要靠专业知识。无专业知识可以依据时，应
首先按无交互效应拟合模型，然后通过残差分析判断是否需要考虑交互作用。
如果这一乘积项显著（X的系数具有统计学意义），即可认为X和X之间有交互
作用。
6.残差分析与回归诊断
多重线性回归模型的基本假设除了线性、独立、正态及等方差（即LINE条
件）外，还要求多个自变量之间相关性不要过强。LINE条件的核查一般采用残
差分析（analysisofresiduals）来进行。
残差分析主要包括以下两个方面。
（1）残差是否独立：实际上就是考察应变量Y取值是否相互独立。
（2）残差分布是否为正态：实际上就是考察应变量Y取值是否服从正态
分布。
残差图（residualplot），一般是将现有模型求出的各点残差e=Y-Y作为纵
坐标，相应的预测值Y或者自变量取值X作为横坐标来绘制的。如果数据符合
模型的基本假定，则残差与回归预测值的散点图不应有任何特殊的结构。如
图11-1（a）所示为较为理想的残差图，说明此数据用于拟合直线回归方程是
恰当的。图11-1的（b）、（c）、（d）和（e）中或存在异常点、或形状异常，
反映模型存在着不同的问题。图11-1（b）中可以明显地看到一个点的残差相
对其他点来说大很多，可判定是异常点，可以考虑删除或改用其他可减小异
常点影响的回归分析方法。图11-1（c）中的残差与回归预测值呈曲线关系，
提示在目前的直线回归模型中加人自变量的二次项将改善拟合效果。图11-1
（d）中的残差呈喇叭口形状，虽然围绕均线均匀分布，但是波动随着拟合值
的增大而增大，提示误差的方差不齐，模型假设不成立。应考虑某种对方差
进行稳定化的处理，如进行变量变换，或采用加权最小二乘法估计。图11-1
（e）表示残差之间不独立的情况，可以看到残差与各个观测的测量时间存在
较强的相关性。
190兽医统计学
Y
Y
Y
Y
Y
时间
B
b
C
P
e
图11-1残差示意图
回归前提条件和数据可靠性从统计方法上进行检查，就是所谓的回归诊断
（regressiondiagnosis）的内容，对这些检查的解释及进一步处理应充分结合专
业知识，不仅仅依赖于统计学上的方法。
第四节Logistic回归
【例11-2】
为了解羊布鲁氏菌病的影响因素，对某牧区进行流行病学调查，表
11一4为本次调查中获得的部分数据。其中，羊只调入隔离情况“1”表示采
取隔离措施，“0”表示未采取隔离措施；饲养方式“1”表示放养，“0”表
示圈养；对布鲁氏菌病知识了解程度“0”表示对布鲁氏菌病的危害预防知
识基本都懂，“1”代表了解一点，“2”代表不知道；布鲁氏菌病状态“1”
表示发现病例，“0”代表未发现病例。试以统计学相关知识推断这些因素
与羊布鲁氏菌病的发病状态是否有关联。
第十一章
多重回归
191
表11-4
某牧区布鲁氏菌病调查资料
基础母
基础母羊平
过去一年
羊只调人
对布鲁氏菌
饲养
布鲁氏菌
编号
羊数
均存栏时间
出栏数
隔离情况
病知识的了
方式
病状态
（头）
（月）
（头）
解程度
1
25
50
10
0
1
1
1
2
45
50
23
0
0
1
1
3
110
50
20
0
0
2
一
4
85
50
50
0
0
2
1
5
32
50
5
0
0
1
1
6
178
50
150
0
0
2
1
7
89
50
60
0
0
2
1
8
20
60
10
1
0
2
1
9
28
60
20
0
0
2
1
10
6
60
30
0
0
2
1
11
7
36
40
0
1
1
12
46
42
28
0
1
2
1
13
220
40
50
0
1
0
1
14
72
36
20
0
0
1
一
15
48
48
30
0
2
1
16
68
24
10
0
0
2
0
17
8
12
0
0
0
1
0
18
40
24
2
0
0
1
0
19
34
24
1
0
0
1
0
20
72
24
20
0
0
1
0
21
6
24
0
0
0
1
0
22
60
24
3
0
0
1
0
23
9
24
1
0
0
1
0
24
19
24
1
0
0
0
0
25
11
18
1
0
0
1
0
26
40
24
30
0
0
1
0
27
29
6
100
0
0
1
0
28
200
60
13
0
1
1
0
29
70
60
60
0
1
1
0
30
78
60
56
1
1
2
0
192兽医统计学
【问题11-2】
（1）在本例中各变量与例11-1中有何不同？
（2）在应变量为分类变量的情况下，还能直接使用多重线性回归吗？
【分析】
在第十章和本章第一节中，介绍了线性回归使用的要求，要求应变量Y
服从正态分布。在本例中，对应的应变量为取值仅为“0”和“1”的二分
类变量，显然不满足多重线性回归的使用条件。在本节将介绍Logistic回归
来解决这类问题。
在第十章介绍的回归模型中，应变量为区间（定量）变量，并且理论
上要求其服从正态分布等LINE（线性、独立、正态、等方差）假定条件。
本章所介绍的Logistic回归与多重线性回归之间主要的区别在于：应变量
的类型不同。通过一组预报变量（即一组自变量，也称为解释变量或协变
量），采用Logistic回归，可以预测一个分类变量每一分类所发生的概率。应
变量为分类变量，预报变量可以是区间变量，也可以是分类变量，还可以
是区间与分类变量的混合。如果自变量均为区间变量，则这类数据也可采
用第十二章所述的判别分析等方法进行分析，但通常情况下，Logistic回归
对预报变量（自变量）的假定条件较少，所以Logistic回归更为常用。
根据分类变量的类型，选用不同的Logistic回归模型，如表11-5所示。
表11-5不同的Logistic回归模型使用条件
分类变量
Logistic回归模型
使用条件
一般Logistic回归
成组资料
二项分类变量
条件Logistic回归
配对资料
有序分类Logistic回归
有序Logistic回归
等级或程度差别资料
无序多项分类变量
无序多分类Logistic回归
无序多项分类资料
二项分类Logistic回归是其他Logistic回归的基础，在本节中主要介绍用
于成组资料的二项分类Logistic回归。
第十一章多重回归193
二、回归模型
令应变量Y服从二项分布，其二项分类的取值为0，1，Y=1的总体概率为元
（Y=1），则m个自变量分别为X，X，"，X所对应的Logistic回归模型为：
exp（B+BX+βx2+...+βmxm)
1
1+exp[-(B+Bx+BX2++βmxm)]
(11-13)
与第十章的回归模型相同，B为截距（或称常数项），β是x（j=1，2，"，m）
对应的偏回归系数（partialregressioncoefficient，简称回归系数），exp（.）是
以自然对数e为底的指数。公式（11-13）有两个等式，后面一个等式是前面等
式的分子、分母同除以分子后获得，o即优势（odds）。
o=exp（B。+BX+βX+..+βmXm)
二、回归模型参数的意义及其解释
一般线性回归模型通过最小二乘法求解回归参数，而二项分类Logistic回归
则是通过最大似然估计方法求解回归参数。为了理解二项分类Logistic回归参数
的意义，首先需要理解优势（odds）与优势比（oddsratios）的概念。
1.优势与优势比
大多数人认为概率是定量事件出现可能性大小的“自然”方式，其取值范
围为（0，1）。如果事件肯定不发生，那么概率为0；如果事件肯定会发生，那
么概率为1。另一种代表事件出现可能性大小的“自然”方式是优势，其取值范
围为（0，∞）。
概率与优势之间的关系可以采用简单的公式来表达，如果事件概率用（二
项分类变量的非事件概率为1-p）表示，优势用6表示，则有优势
194兽医统计学
1-非事件概率
(11-14)
2.Logistic回归模型中的优势比
优势比的含义是：在其他自变量固定不变的情况下，某一自变量X改变一
个单位，应变量对应的优势比平均改变exp（b）个单位。下面以自变量x对应
的优势比为例，说明优势比的含义。在其他自变量不变的情况下，令x改变一
个单位，如X从一个任意实数a改变为a+1，则有
=_exp[bo+b,（a+1)+bx2+...+bmxm]
OR=
=exp（b)
oe
exp(ba+ba+b2X2+...+bmxm)
3.标准化Logistic回归系数
由于不同的变量其相应的度量衡单位可能不同，不能采用偏回归系数的绝
对值大小来比较各个自变量的相对作用大小，为此需要引入标准化Logistic回归
系数这一概念。
应该注意的是：标准化Logistic回归系数只是一个相对大小值，主要通过它
的绝对值大小来比较不同自变量对模型的贡献大小，而不能用于构建回归模型，
构建回归模型需要采用一般的回归系数。
标准化回归系数的估计值b’可采用以下公式
b=b，(S,/S)=b,S,/(π/√3)=0.5513b,S
（11-15)
来计算，式中b是一般的回归系数，即偏回归系数；S为第自变量的标准差；S
是随机变量Y的标准差，Logistic随机变量Y的标准差为π/√3=1.8138。
在例11-2中，所提供的资料符合二项分类Logistic回归的使用条件，在
此以统计软件SPSS为例进行分析。首先生成一个包含X、X2、X3、X4、X5、
X、Y个变量的数据文件，各变量分别代表基础母羊数、基础母羊平均存栏时
间、过去一年出栏数、羊只调入隔离情况、饲养方式、对布鲁氏菌病知识的
了解程度、布鲁氏菌病状态，依次输入各研究对象的具体数据。在SPSS中的
“Analyze一Regression→BinaryLogistic”，将变量Y选人应变量栏，将X、X、X、
第十一章多重回归
195
X、X选人协变量栏，X选人分类变量栏。自变量选择方法中选择需要的方法，
此处选择“enter”，对于有3个取值的X变量，在分类按钮弹出的对话框中设置取
值为“0”作为对照，点击确定，在SPSS运行得到结果后，观察得到表11-6。
表11-6某牧区布鲁氏菌病调查的Logistic回归分析结果
回归系数
标准误
Wald卡方值
df
P值
OR值
X
-0.015
0.011
1.816
1
0.178
0.985
X
0.160
0.063
6.366
1
0.012
1.174
X
0.017
0.031
0.285
1
0.593
1.017
X4
5.189
2.555
4.123
1
0.042
0.006
Xs
-0.991
1.538
0.416
1
0.519
0.371
X
3.148
2
0.207
X(1)
-2.738
1.907
2.062
1
0.151
0.065
X（2)
-0.505
2.170
0.054
1
0.816
0.603
常数项
-3.211
2.185
2.159
1
0.142
0.040
由表11-6可知，在这些自变量中仅X和X的P值小于0.05，即X2和X具有统
计学意义。根据公式，我们可以得到Logistic回归方程：
Logit[π（Y=1）]=-3.211+0.160X-5.189X
表11-6同时输出了0R值，即为优势比。如X和X的优势比分别为1.174、
0.006，根据优势比的定义可知，例11-2中的X取值为1对取值为0的养殖户（或
养殖场）的优势比小于1，仅为不隔离风险的0.006倍，即羊只调人采取隔离措
施为布鲁氏菌病的保护因素。实际上，我们也可以说不隔离患布鲁氏菌病的风
险是隔离的1/0.006=167倍。
三、回归模型的假设检验
1.全局性的假设检验
回归模型建立后，需要对整个模型的拟合情况作出判断，即检验H。β=
β==β=0；Hβ不全为0。在进行全局性假设检验时，在一般线性回归模型
196兽医统计学
拟合时是采用方差分析，而Logistic回归模型拟合时是采用似然比（likelibood
ratio）检验、得分（score）检验和Wald卡方检验，其中以似然比检验最常用。
获得得分（score）检验结果不需要选代，相对似然比检验更快速，所以
SPSS用这种检验作为逐步Logistic回归选取变量的标准，检验每一个变量以及所
有变量加入模型后是否有意义。
2.单个自变量的假设检验
一般线性回归分析对某一个自变量x的检验采用t统计量t=b/SE（b,），自
由度为n-m-1，来检验参数β是否为0。其中，n为观察个体总数，m为模型中自
变量个数。
而在Logistic回归中，某一个自变量X的检验采用Wald卡方检验，
xad=[b,/SE(b,）]，自由度为1
(11-16)
来检验参数β是否为0。如果拒绝HB=0，则表明该自变量X对于模型的作用有
统计学意义。在表11-6中输出了Wald统计量的大小，并计算P值，可直接根据
输出的P值大小作出判断。
也可采用有与无某一个自变量X的-2LL（对数似然函数loglikelihood，LL）
改变量作为卡方统计量，来检验自变量X有无统计学意义，特别当回归系数的
值很大时，后者尤其有用。
第五节Logistic回归的应用与注意事项
一、Logistic回归的应用
随着Logistic回归分析方法的发展、完善和统计软件的普及，Logistic回归用
第十一章多重回归197
于统计分析的应用也日益广泛。
（1）用Logistic回归进行危险因素分析时参数意义清楚，得到某一因素的回
归系数b，后，可以估计出这一因素在不同水平下的优势比（该值近似等于相对
危险度），适合于流行病学研究。在本章例11-2中，就可通过计算调查对象各研
究因素对布鲁氏菌病发病情况的回归系数，估计每个因素的危险度，为今后防
护提供建议。
（2）预测与判别Logistic回归模型是概率模型，因此可通过已经得到的资
料，结合已经得到的Logistic回归方程，计算事件是否会发生的概率。
二、应用Logistic回归时的注意事项
（1）与多重线性回归相同，对应无序分类变量应采用哑变量进行分析。下
面以职业（J）为例，说明一种哑变量编码方法。假如职业分类为工、农、商、
学、兵5类，则可定义比总分类数少1个，即5-1=4个哑变量，分别记为J，J2，
J，J4。编码方法见表11-7。
表11-7哑变量编码方法
哑变量
职业（J）
J
J3
J4
工
1
0
0
0
农
0
1
0
0
商
0
0
1
0
学
0
0
0
1
兵
0
0
0
0
如果某个体的职业为农民，则将J，J2，J3，J分别编码为0，1，0，0；如
果某个体的职业为军人，则将J，J，J3，J分别编码为0，0，0，0。这样J，J2，
J3，J这4个哑变量分别代表以“兵”为参照的工、农、商、学职业。如果J对
应的回归系数为b，那么b就是其他自变量取固定值时，相对于“兵”，职业为
198兽医统计学
农民的个体影响应变量的对数优势。
注意：在回归模型中，无论某哑变量（如，，，J）有无统计学意义，
哑变量都是同时出现或不出现。某个哑变量的统计学意义只是相对于参照组而
言，为了检验这个分类变量（如职业）有无意义，可采用“有与无”这些哑变
量的-2LL改变量作为卡方统计量，哑变量的个数作为自由度，根据卡方分布确
定其检验结果。
（2）样本量Logistic回归的所有统计推断都建立在大样本基础上，样本量过
少时，参数估计值不稳定。方程中变量的个数越多，需要的例数相应也越大。
（3）模型拟合优度的评价。建立模型并进行假设检验仅说明模型以及向归
系数是否具有统计学意义，但模型拟合的效果需要进行拟合优度检验，评价拟
合优度的指标主要有Pearsonx”、偏差（deviance）、广义决定系数等，具体可参
见宇传华主编的《SPSS与统计分析》
第十二章
判别分析
200
兽医统计学
【例12-1】
奶牛酮病严重影响奶牛的健康和生产性能的发挥，为奶牛养殖带来较
大的经济损失。已知奶牛患酮病时乳中β-羟基丁酸及尿酮含量会发生改变，
现试图根据疑似病例乳中β-羟基丁酸及尿酮含量的检测来推断是否患有酮
病，为此对20头疑似病例奶牛进行乳中B一羟基丁酸及尿酮含量检测，并同
时采用血清学检查（血糖和血酮含量检测）确定实际患病情况，所获得数
据如表12-1。试提出利用乳中B-羟基丁酸及尿酮含量来确定奶牛是否患有
奶牛酮病的方法。
表12-120头奶牛乳中β-羟基丁酸及尿酮含量
尿酮
尿酮
β-羟基丁酸
实际患
β-羟基丁酸
实际患病
编号
(mg/
编号
(mg/
（μmol/L)
病情况
（μmol/L）
情况
L)
L）
1
544
126
是
11
542
167
是
2
386
89
是
12
63
22
否
3
453
97
是
13
88
88
否
4
280
124
是
14
358
205
是
5
85
25
否
15
413
168
是
6
220
87
是
16
73
24
否
7
352
230
是
17
243
136
是
8
246
110
是
18
29
20
香
9
67
35
否
19
76
26
香
10
103
45
否
20
367
236
是
【问题12-1】
是否可以应用多重回归或者Logistic回归建立判别的方法？需要注意哪
些方面？
第十二章判别分析201
【分析】
在例12一1中，需要根据已知的两个变量，对个体作出属于是否患病的
判断，其实是需要对个体类别归属作出判断，由于结果为“是”和“否”
的二分类，而不是连续的变量，故不符合多重线性回归的使用条件。由于
应变量为二分类变量，因此可用Logistic回归进行分析判别。
本章将介绍一种新的分析方法一判别分析（discriminantanalysis），
是明确类别的一种分类技术，它根据观测到的某些指标对所研究的对象进
行分类。在兽医研究中经常遇到这类问题，例如根据病畜症状、体征、实
验室检查、病理学检查等对其作出是否患有某种疾病的诊断或对几种可能
患有的疾病进行鉴别诊断。Ledley等认为医学诊断的推理过程可用数学的方
法来精确描述。判别分析常用于临床辅助鉴别诊断，通过判别分析还可对
各指标所起判断作用的大小作出估计。
第一节判别分析的基本思想
下面用一个实例来说明判别分析的基本思想。
已知奶牛患有乳房炎会对生产的牛奶中的血清白蛋白含量（ALB）和血清
丙氨酸氨基转移酶（ALT）含量产生影响，现在已对采集到的牛奶样品进行检
测，测得这两项指标的具体数值，X为ALB的数值，X为ALT的数值。根据实
测资料（常称训练样本）用判别分析方法可建立判别函数：Y=aX+bX（通过
相应计算方法可以获得a、b的值）；并确定判别准则为：将某只奶牛的X、X
实测值，代入上述判别函数可得Y值，Y>Y则判断为乳房炎，若Y<Y则判断为
非乳房炎。该判别函数是否有实用价值还需要进行考核；如考核的结果，其诊
断符合率达到临床要求则可应用于实践。通过此例子，可得出判别分析的一般
202兽医统计学
步骤，见图12-1。
判别分析方法
建立判别函数
已知分类
判别
合格
未知样本
训练样本
考核
函数
判别归类
图12-1判别分析步骤
判别分析通常都要建立一个判别函数，然后利用此判别函数来进行判别。
为了建立判别函数就必须有一个训练样本。判别分析的任务就是向这份样本学
习，学出判断类别的规则，并作多方考核。训练样本的质量与数量至关重要。
每一个体所属类别必须用“金标准”予以确认；解释变量（简称为变量或指标）
X、X、“、X必须确实与分类有关；个体的观察值必须准确；个体的数目必
须足够多。
训练样本的内容与符号如表12-2所示。其中，变量Y表示个体所属类别，
在1，2，，g中取值；X、X、、X为判别指标；X、X、、Xm、Y为第
个个体的信息。
表12-2训练样本的数据内容与符号
判别指标
类别变量（Y）
X
X
...
X,
Xm
1
Xi
X12
X
X1m
Y
2
X21
X22
**
X2
X2m
Y
：
i
Xn
X2
...
Xi
...
Xm
Y
：
：
n
Xn1
Xn2
"X
.·
Xnm
Y
判别分析的方法很多，根据不同的判别准则可以分为不同的判别方法，判
别分析按判别的组数来分，有两组判别分析和多组判别分析；按区分不同总体
所用的数学模型来分，有线性判别和非线性判别；按判别对所处理的变量方法
第十二章判别分析203
不同，有逐步判别、序贯判别等；按判别准则不同，有距离判别、Bayes判别、
Fisher判别等。比较经典的判别分析方法有Fisher判别和Bayes判别。近年来，这
些方法又有了发展，同时也不断有学者提出一些新的方法。本章着重介绍Fisher
判别和Bayes判别等判别方法。
第二节Fisher判别
Fisher判别又称典则判别（canonicaldiscriminant），其判别思想是选择方向
适当的投影轴，使所有样品点都投影到这轴上得到一投影值，对投影轴的方向
要求是使每一类内的投影值的类内离差尽可能小，而不同类的投影值的类间离
差尽可能大。此准则一般用于二类判别。
一、二类判别
1.Fisher判别
Fisher判别的原理。已知观察对象根据一定标准可分为A、B两类，A类有n
例，B类有n例，分别记录了X，X，“，X个观察指标，称为判别指标或变量。
Fisher判别就是找出一个线性组合
Z=C,X,+CX2+.+CX
(12-1)
使得综合指标Z在A类的均数Z与在B类的均数Z的差异Z-ZI尽可能大，同
时使两类内综合指标Z的变异S+S尽可能小，即令
S+S²
(12-2)
达到最大，这就是Fisher准则。此时公式（12-1）称为Fisher判别函数，C，
204兽医统计学
C，，C称为判别系数。对求导，解方程组（式12-3）可得到判别系数
="3"++²+5"
="²++“s+5
(12-3)
=5S++5S+5S
式中D=x(A-x），x，x分别是A类和B类第个指标的均数（=1,2,,m）;
S是X，X，，X的合并协方差阵的元素。
2.判别规则
解出方程组，得到判别系数后，可以建立判别函数，按公式（12-1）计算
每一例判别函数值Z，进一步求Z的两类均数Z、Z与总均数Z，按下式计算
判别界值
ZA+ZB
Z=
（12-4)
2
判别规则：
[Z,>Ze
判为A类
Z,<Ze,
判为B类
(12-5)
Z=Z，判为任意一类
现应用上述方法对例12-1进行分析。按是否患病排序，以X、X表示-羟基丁
酸及尿酮，整理表格得表12-3：
表12-320头奶牛酮病患病情况判别分析结果
NO
Y
X
X2
Z
RESULT
1
1
544
126
24.840
1
2
1
386
89
23.130
2
3
1
453
97
23.500
1
4
1
280
124
24.740
1
第十二章判别分析
205
（续）
NO
Y
X
X
Z
RESULT
5
1
220
87
23.040
2
6
1
352
230
29.620
1
7
1
246
110
24.100
1
8
1
542
167
26.720
1
9
1
358
205
28.470
1
10
1
413
168
26.770
1
11
1
243
136
25.300
1
12
1
367
236
29.900
1
13
2
85
25
20.190
2
14
2
67
35
20.650
2
15
2
103
45
21.110
2
16
2
63
22
20.052
2
17
2
88
88
23.088
2
18
2
73
24
20.144
2
19
2
29
20
19.960
2
20
2
76
26
20.236
2
（1）计算变量的类均数及类间均数差。计算结果列于表12-4。
表12-4
变量的均数及类间均数差
类别
例数
X
X2
1
12
367.0
147.9
2
8
73.0
35.6
类间均数差D
294.0
112.3
（2）计算合并协方差矩阵。利用统计分析软件SPSS获得，在SPSS中的
“Analyze→Classify→Discriminant”，将变量Y选入分组变量栏，将X、X选人
自变量栏，在分组变量下定义分组变量的范围（此处最小值为1，最大值为2），
选择“一起输人自变量”，统计量中的函数系数选择“Fisher（F）”，矩阵选择
“组内协方差”，点击确定，在SPSS运行得到结果后，得到协方差矩阵
7482.11665.56
S:
665.561918.38
206兽医统计学
代入公式得
7482.11C+665.56C=294
665.56C+1918.38C=112.3
解方程组得
C=0.035，C=0.046
所以判别函数为
Z=0.035X+0.046X
根据该函数计算表中每一例的Z，同时计算得到Z=25.84、Z=20.68
（3）确定判别界值。按照公式计算Z=（25.84+20.68）/2=23.26，根据判别
分析规则，将Z<23.26判为非奶牛酮病个体，将Z>23.26判为奶牛酮病个体。判
别结果在数据表中最后一列，共有2例错判。
二、判别效果的评价
建立判别函数后，需要对该函数的判别效果进行评价。一般使用误判概率
P来衡量，且P=n误判/n总。一般要求判别函数的误判概率小于0.1或0.2，误判概率
太大则失去了应用价值。
误判概率可根据计算方法分为前瞻性和回顾性两类。回顾性误判概率估计
是指用建立判别函数的样本回代判别，例12-1中即为此种方法，将已经用来计
算获得判别函数的观察对象的各项数值代入函数，作出判别，如表12-3中的最
后一列（RESULT），本例有2例误判，则2/20=10%作为误判概率的估计，需要
注意的是回顾性误判概率估计往往夸大判别效果，低估误判概率。一般而言，
建立判别函数前要将样本随机分成两个部分一训练样本和验证样本，分别占
总样本量的85%和15%。前者用于建立判别函数，后者用于考核判别函数的判
别效果。建立判别函数后，用验证样本计算得到的误判概率作为前瞻性误判概
率估计，前瞻性误判概率估计则比较客观，样本充足时可以使用。
第十二章判别分析207
第三节Bayes判别
Bayes判别是基于Bayes准则的判别方法，该方法是根据样本归为各类概
率的大小进行判别的，要求各类近似服从多元正态分布。当进行多类判别时，
Fisher判别过程较为复杂，而Bayes判别则更为直接，所以进行多类判别时多采
用Bayes判别。
1.Bayes准则
Bayes准则寻求一种判别规则使得属于第k类的样品，在第k类中取得最大
的后验概率。
基于Bayes准则，假定已知各类出现的先验概率P（Y），且各类近似服从
多元正态分布，根据各类的协方差阵是否相等，可获得两种不同的Bayes判别
函数。
当各类的协方差阵相等时，可得到线性Bayes判别函数：
"x1++²x+x+=
Y=Co2+C2x+C2X+·.+Cm2xm
(12-6)
：
“x++x+x+
其中，C是判别系数（j=0，1，2，，m；k=0，1，2，，G）。通过统计分
析软件SPSS可得到各判别系数Cko
2.判别规则
（1）按判别函数值判别：逐例计算判别函数值Y，Y2，，Yg，将判别对象
判为函数值最大的那一类。
（2）按后验概率判别：计算每一例属于第k类的后验概率
Y=max(Y)
∑exp(Y-Y)
(12-7)
/=1
208兽医统计学
将判别对象判为后验概率值最大的那一类。
根据后验概率判别的公式可知，两种判别规则判别结果是完全一致的。
3.Bayes判别应用
【例12-2】
某牧区暴发疫情，对死亡动物进行体外检查和解剖，得到指标X、X2、
X3、X4、X五个指标，数据如表12-5，并结合病原学检查将死亡动物死因归
为甲、乙、丙三种疫病（分别以1、2、3编号）。由于病原学检查成本较高，
现希望能根据X、X2、X3、X4、X这五项相对容易获得的指标，区别甲、
乙、丙这三种当地较为常见的疫病，试提出解决方法。
表12-524例死亡动物5项体外检查、解部指标观测结果
X
X2
X,
X
X
原分类
Y
Y2
Y
判别结果
14.0
0
1
15.0
9.400
1
2.8788
5.4692
-1.9570
1
7.0
0
1
42.0
6.971
1
4.6623
0.6006
0.8898
1
1.3
0
0
10.0
7.650
1
-3.2009
-9.5269
-3.5971
1
8.5
2
1
18.0
4.011
1
4.8561
-0.3743
0.7481
1
9.0
0
0
32.0
1.300
1
-1.9029
3.8914
-1.5225
3
4.0
0
1
51.0
13.900
1
5.6933
0.0518
2.9415
1
43.0
0
1
15.5
1.002
1
2.6396
1.8882
-2.2707
1
15.0
0
5.0
1.463
1
1.7034
-6.3666
-4.3389
1
85.0
0
1
48.0
2.600
2
5.3972
7.7752
3.2740
2
31.0
2
0
21.0
2.740
2
-0.3658
0.0747
1.2063
3
133.0
0
0
75.5
6.471
2
2.4353
14.5144
8.3043
2
97.0
2
0
73.0
5.456
2
4.0470
15.4142
10.0661
2
第十二章判别分析
209
（续）
X
X2
X
X
Xs
原分类
Y
Y2
Y3
判别结果
61.0
0
0
77.5
2.329
2
1.8413
9.1952
5.8677
2
19.0
0
0
60.02.627
2
0.2867
2.1880
2.4879
3
49.0
0
1
65.0
3.000
2
6.4090
7.8960
4.4300
2
85.0
0
74.0
5.275
2
1.9217
10.2396
6.5499
2
4.0
0
0
68.0
4.400
3
0.8668
2.2248
3.3180
2
13.0
0
0
23.0
5.067
3
-2.3172
5.7199
-1.9943
3
37.0
0
0
43.011.433
3
0.3263
-0.5671
2.1448
3
13.0
1
0
78.014.567
3
3.2913
5.8971
7.9472
2
73.0
0
0
39.046.900
3
1.6553
-2.4242
7.8275
3
85.0
0
0
15.0
12.900
3
1.9507
-1.9882
0.2215
3
13.0
2
0
37.5
4.757
3
0.8276
1.4567
3.0558
2
121.0
0
0
50.027.900
3
1.7113
6.0578
7.8505
3
【分析】
在本例中可应用本节所学的Bayes判别进行分析，分析步骤如之前介绍
的各步骤，利用统计分析软件SPSS进行分析。首先在SPSS中建立包含X、
X2、X3、X4、Xs和Y（表示3种病因）的数据文件，录入数据。在SPSS中的
“Analyze→Classify→Discriminant”，将变量Y选入分组变量栏，将X、X2
X3、X、X选入自变量栏，在分组变量下定义分组变量的范围（此处最小
值为1，最大值为3），选择“一起输入自变量”，统计量中的函数系数选择
“Fisher（F）”，其他选项根据需要选择，点击确定，在SPSS运行得到结果
后，在结果中找到表12-6。此即为SPSS分析得到的Bayes判别函数的系数和
常数项。
210兽医统计学
表12-6SPSS对例12-2的Bayes判别分析结果
Y
1
2
3
X
0.007
0.086
0.029
X2
1.052
2.178
1.634
X
5.526
2.212
0.388
X4
0.073
0.192
0.126
Xs
0.057
-0.118
0.145
(Constant)
-4.376
-10.656
6.004
根据此表，可以得到Bayes判别函数：
Y=-4.376+0.007X+1.052X+5.526X+0.073X+0.057X
Y=-10.656+0.086X+2.178X+2.212X+0.192X-0.018X
Y=-6.004+0.029X,+1.634X+0.388X+0.126X+0.145X
计算各例的Y.Y.Y列入表12-5中，选择Y，YY中值最大对应的类
别，作为其判定类别，并列入表12-5的最后一列中，以1、2、3分别代表甲、
乙、丙三种疫病。根据得到的结果，可知误判概率为3/24=12.5%，结果比
较理想。
第四节逐步判别
在多重回归中，作用不大的变量进人方程后不但无益，反而降低了回归方
程的效能。在判别分析中也有类似情况，解释变量并非越多越好。解释变量的
特异性越强，判别能力越强，这类解释变量越多越好；相反，那些判别能力不
第十二章判别分析211
强的解释变量如果引人判别函数，不但增加了搜集数据和处理数据的工作量，
而且还可能削弱判别效果。因此在建立分类函数时既不要遗漏有显著判别能力
的变量，也不要引入不必要的判别能力很弱的变量。
逐步判别分析（stepwisediscriminantanalysis）是达到上述目标的重要方法。
它像逐步回归分析一样，可以在候选变量中选择部分有重要作用的变量来建立
分类函数，使方程内的变量都较重要而方程外的变量都不甚重要。
一、基本原理
在多重回归自变量的筛选中，逐步回归是根据自变量偏回归平方和的大小
来筛选变量的，自变量的选人或剔除会导致偏回归平方和增大或减小。而逐步
判别则是根据多元方差分析中介绍的Wi证ks统计量A来筛选判别指标，判别指标
的选人或剔除会导致人的减小或增大。根据每次选人或剔除一个判别指标，考
察由此是否引起A明显减小或增大，从而实现判别指标筛选的目的。A统计量
计算较为复杂，在此仅介绍在统计分析软件SPSS中的操作方法，可参考相关书
籍。剔选判别指标需设立剔选标准，类似于逐步回归，事先须设定选入变量和
剔除变量的域值A。和A，并根据F与A分布的关系，计算出对应的F。和F。α一
般取0.05，0.1等，根据实际要求选择；一般常取β=2α。
二、筛选步骤
第一步。有n个变量候选。计算n个变量的类内离差平方和矩阵与总离差平
方和矩阵。
第二步。假定已有r个变量入选，有n-r个变量候选。计算r个变量的离差平
方和矩阵与总离差平方和矩阵。根据以下方法，对待选入的变量和已选人的变
量进行考核，决定待选入变量是否人选和已选人变量是否剔除。
（1）待选人变量：对候选变量计算A，如果max（A：）≥A。，将相应的变
量选入，紧接着对已选人变量作变量剔除考核。
212兽医统计学
（2）已选人变量：对人选变量逐一计算A，如果max（A）<A，将相应
的变量剔除。接着考察是否还有入选变量能被剔除，如果没有，则进人变量选
入过程。
第三步重复第二步直至入选变量不能被剔除，候选变量不能被选人为止，
则变量选择结束。变量选择完毕后，假定人选了r个变量，再根据Bayes判别准
则建立包含r个已选人变量的判别函数。
三、实例应用
【例12-3】
利用表12-5中的数据作逐步判别。
首先在SPSS中建立包含X、X2、X、X、X和Y（表示3种病因）的数
据文件，录入数据。在SPSS中的“Analyze一Classify一Discriminant”，将
变量Y选入分组变量栏，将X、X、X3、X4、X选入自变量栏，在分组变
量下定义分组变量的范围（此处最小值为1，最大值为3），选择逐步方法
（stepwisemethod），在方法中选择第三项Mahalanobis距离，标准使用默认F
值。统计量中的函数系数选择Fisher（F），其他选项根据需要选择，点击确
定，在SPSS运行得到结果后，观察各个结果，找到表12-7。
表12-7对例12-2进行逐步判别分析的结果
Y
1
2
3
X
0.002
0.077
0.022
X
5.355
1.856
0.121
X
0.067
0.179
0.116
Xs
0.051
0.131
0.135
(Constant)
-4.053
-9.273
-5.226
第十二章判别分析213
此即为SPSS分析得到使用逐步判别后的判别函数的系数和常数项。根
据此表，可得到Bayes判别函数：
Y=-4.053+0.002X+5.355X+0.067X+0.051X
Y=-9.273+0.077X,+1.856X+0.179X4-0.131X
Y=-5.226+0.022X,+0.121x+0.116X+0.135X
计算各例的Y、Y2、Y3，选择Y、Y2、Y中值最大对应类别作为其判定类
别。根据得到的结果，可发现有两例错判，误判概率为2/24=8.3%，较未使
用逐步判别时候的错判率有所减小。由此可知，在变量进行筛选之后，判
别效能得到了提高。
第五节判别分析中应注意的问题
（1）为使样本资料具有较好的代表性，要求样本足够大。获取的样本必须
保证知晓其实际类别，若训练样本的实际类别有误，会减小类别间的差异，同
时也会增大类别内的变异，从而得不到可靠的判别函数，降低判别效能。判别
指标的选择要适当，而不在于多，如逐步判别中的说明，纳人不必要的判别指
标反而可能会增加误判概率。
（2）由于回顾性误判概率估计往往夸大判别效果，低估误判概率，因此判
别函数的判别能力不能根据训练样本的回代情况作出结论。同样，小样本资料
建立的判别函数回代时可能有很低的误判率，但训练样本以外的样品误判率不
一定低，因此要预留足够的验证样品。
（3）如第四节中先验概率的确定方法，各类型先验概率可以由训练样本中
各类的构成比作为估计值，需注意训练样本构成比是否对总体具有足够的代表
214兽医统计学
性。若不具有足够代表性，如取样存在选择性偏倚，此时就不能用构成比来估
计先验概率，此时先验概率取1/g更为妥当。
（4）判别函数建立后，可在判别函数的实际应用中收集新的数据、资料，
将更多的对象作为训练样本，逐步完善，建立更为稳定的判别函数。
（5）对于两类判别，Fisher判别、Bayes线性判别以及二值回归判别是等价的，
它们都是线性判别。另外二分类Logistic回归也可以用于两类判别，称为Logistic判别，
1，属于A类
o，属于B类，建立Logistic回归模型
exp（β+βX+...+βmXm)
P(Y=1)=
1+exp（B。+BX+···+βmX)
(12-8）
用Newton-Raphson迭代获得βo，β，"，βm的最大似然估计。公式（12-8）就
是Logistic判别函数。判别规则如下：
[P(Y=1)≥0.5，判为A类
逐例计算判别函数值P（Y=1），如果
[P(Y=1)<0.5，判为B类°
第十三章
聚类分析
216兽医统计学
【例13-1】
某研究者收集了24种菌株，其中有几个已知的标准菌株，它们分别取
自牛、羊、犬、猪、鼠，其他的为未知菌株，测得菌株的16种脂肪酸百分
含量，要了解哪些未知菌株在全部指标上最为接近？
【分析】
这个问题的本质是希望能够找到一种合理的方法，将这批菌株分类，与上
一章判别分析有所不同的是，此例并不知道这些菌株的类别，也不知道能分成
几类，那么就不能用判别分析进行解答，聚类分析则能很好地解决该问题。
【例13-2】
某研究者收集了24种菌株，测得菌株的16种脂肪酸百分含量，要求将
这16种脂肪酸分为几类，该如何实现？
【分析】
这个问题的本质是希望能够找到一种合理的方法，将这批测得的脂肪酸
分类，与上一章判别分析有所不同的是，此次是对变量进行归类；判别分析
只能对样本而不能对指标进行分类，这种情况下同样也应选择聚类分析。
第一节聚类分析基本思想
聚类分析（clusteringanalysis）是按照“物以类聚”的原则，将特性相近
的变量或观察单位进行归类的一种统计分析方法。在现实生活中，样品或指标
（变量）之间存在着程度不同的相似性（亲疏关系），因此可以利用一批样品的
第十三章聚类分析217
多个观测单位，找出能够度量样品或指标之间相似程度的统计量，并将这些统
计量作为分类的依据，将一些相似程度较大的样品（或指标）聚合为一类；把
另外一些彼此之间相似程度较大的样品（或指标）再聚合成为另外一类。以此
类推，直到所有的样品（或指标）聚合完毕。由此得知，聚类分析的任务有两
个，一是找到合理的度量事物相似性的统计量，二是寻找合理的分类方法。近
年来随着基因组计划的实施，聚类分析已成为发掘海量基因信息的首选工具。
与十二章所学的判别分析相比，虽然都是研究分类问题的多元统计方法，
但前者是在已知分为若干个类的前提下，判定观察对象的归属，而后者是在不
知道应分多少类合适的情况下，试图借助数理统计的方法用已收集到的资料找
出研究对象的适当归类方法。
在聚类分析中，通常根据分类对象的不同，分为Q型聚类分析和R型聚类分
析两大类。Q型聚类分析是对样本中进行分类处理，又称为样本聚类分析，其
自的在于将分类不明确的样品按性质相似程度分为若十组，从而发现同类样品
的共性和不同样品间的差异；
R型聚类分析是对指标进行分类处理，又称为指标聚类分析，其目的在于
将分类不明确的指标按性质相似程度分为若干组，使得在信息尽可能不损失的
情况下，用少量的指标来代替原来的多个指标。
例如从牛、羊、猪、鼠、绵羊等动物上取得m种菌株，测得各菌株的n种脂
肪酸含量：可以利用指标聚类分析，把n种脂肪酸含量按照所反映的问题按照侧
重点的不同分成几类，也可以利用样品聚类分析将m种菌株分为几类。
第二节相似系数
无论是R型聚类或是Q型聚类的关键是如何定义相似性，即如何把相似性数
量化。聚类的第一步需要给出两个指标或两个样品间相似性的度量一相似系
数（similaritycoeficient）的定义。
218兽医统计学
一、R型聚类的相似系数
X，X，"，X表示m个变量，R型聚类常用简单相关系数r的绝对值定义
变量X与X间的相似系数
∑（x-x）（x-x）
=
√∑(x,-x)²∑(x-x,)²
(13-1)
r绝对值越大表明两变量间相似程度越高。同样也可考虑用Spearman秩相
关系数r定义非正态变量X与X间的相似系数。当变量均为定性变量时，最好用
列联系数C定义X与X间的相似系数。
C=
√x²+n
(13-2)
其中x²是以X、X为边际变量的R×C表Pearsonx。
二、Q型聚类常用相似系数
将n例（样品）看成是m维空间的n个点，用两点间的距离定义相似系数，
距离越小表明两样品间相似程度越高。
（1）欧氏距离：欧氏距离（Euclideandistance）d的计算公式为
d=√∑（x,-x）²
(13-3)
（2）绝对距离：绝对距离（Manhattan
distance）d的计算公式为
d=√≥1x-x,1
(13-4)
（3）Minkowski距离：其d的计算公式为
d=∑1x-x,19
（13-5)
第十三章聚类分析219
绝对距离是q=1时的Minkowski距离。欧氏距离是g=2时的Minkowski距离。
Minkowski距离的优点是定义直观，计算简单；缺点是没有考虑到变量间的相关
关系。基于此引进了马氏距离。
（4）马氏距离：用S表示m个变量间的样本协方差矩阵，马氏距离
（Mahalanobisdistance）d的计算公式为
d=x's-'x
(13-6)
其中向量X=（X-Xn，X-X，，Xm-Xm）’。不难看出，当S=I（单位阵）时，
马氏距离就是欧氏距离的平方。
以上定义的4种距离适用于定量变量，对于定性变量和有序变量必须在数量
化后方能应用。
第三节系统聚类
系统聚类（hierarchicalclusteringanalysis）是将相似的样品或变量归类的最
常用方法，聚类过程如下：
（1）开始将各个样品（或变量）独自视为一类，即各类只含一个样品（或
变量），计算类间相似系数矩阵，其中的元素是样品（或变量）间的相似系数。
相似系数矩阵是对称阵；
（2）将相似系数最大（距离最小或相关系数最大）的两类合并成新类，计
算新类与其余类间相似系数；
（3）重复第二步，直至全部样品（或变量）被归为一类。
一、类间相似系数计算
系统聚类的每一步都要计算类间相似系数，当两类各自仅含一个样品或变量
220兽医统计学
时，两类间的相似系数即是两样品或变量间的相似系数d或r，按定义计算。当
类内含有两个或两个以上样品或变量时，计算类间相似系数有多种方法可供选
择，下面列出五种方法。用G，，G分别表示两类，各自含有np，n个样品或变量。
相似系数的定义以及类间相似系数定义的不同将导致系统聚类结果有所差异。
（1）最大相似系数法。G，类中的n，个样品或变量与G。类中的n个样品或变
量两两间共有n，n个相似系数，以其中最大者定义为G，与G的类间相似系数。
当相似系数最大时两类间距离最小。
（2）最小相似系数法。与最大相似系数法相反，此时以相似系数中最小者
定义G，与G的类间相似系数。此时两类间距离最大。
（3）重心法（仅用于样品聚类）。定义类间距离等于两类的重心之间的距离
（重心指类内所有样本的均数坐标）
（4）类距离法（仅用于样品聚类）定义类间距离等于两类中所有样本的所
有平方距离求平均。类平均法是系统聚类方法中较好的方法之一，它充分反映
了类内样品的个体信息。
（5）离差平方和法。又称Ward法，仅用于样品聚类。定义类间距离等于两
类中所有样本的离均差平方的和。此法效仿方差分析的基本思想，即合理的分
类使得类内离差平方和较小，而类间离差平方和较大。
二、类间相似系数逐步计算
根据聚类过程可知，当样品（变量）个数较多时，由于每步并类都要计算
类间相似系数，聚类过程比较繁琐。Wishart在1969年发现前面提到的各种类间
相似系数，不管相似系数用哪种定义，都可以用一个统一的递推公式来计算合
并出的新类G={GG与其他类G之间的类间相似系数
D²=αD²+aD²+βD²g+y丨D²-D²
（13-7)
其中，系数αp，α，β，随类间相似系数的定义不同而取不同值。表13-1列出了
各种定义下系数的取值，后三种定义未作详细介绍。
第十三章聚类分析221
表13-1类间相似系数递推公式参数
ap
ag
β
y
最大相似系数
0.5
0.5
0
0.5
最小相似系数
0.5
0.5
0
0.5
重心
n/n,
n/n,
-nn/n?
0
类平均
n,/n,
n/ns
0
0
nk+np
nt+ng
nk
离差平方和
0
nk+n,
n,+n,
n+n,
中间距离
0.5
-0.5
-0.25≤β≤0
0
可变类平均
（1-β）n/n
(1-β）n/n,
<1
0
可变法
（1-β）/2
（1-β）/2
<1
0
表中n,，ng，n分别是G。，Ga，G类的样品（变量）数，统计软件如SAS、
SPSS等的系统聚类模块都采用递推公式（13-7）编程。
三、聚类分析实例
相似系数的定义以及类间相似系数的定义的不同将导致系统聚类分析结果
有所差异，聚类分析的结果解释除了要了解聚类方法外，还必须结合专业知识。
（1）Q型聚类分析
【例13-1】
收集了24种菌株，其中有几个已知的标准菌株，它们分别取自牛、羊、
犬、猪、鼠，其他的为未知菌株，测得菌株的16种脂肪酸百分含量，要了
解哪些未知菌株在全部指标上最为接近？
222兽医统计学
25.42
7.30
3.94
7.52
27.13
21.79
11.39
3
8.96
2
5
2i
X
0.00
0.00
0.00
0
7
7
0
00
X
27.06
24.65
26.12
1
3
3
0
0
.
0.00
0.23
5.89
4
4
19
0
0
0
0
0
0
0
0
0
Elx
2.12
1.53
15
3
9
75
8
X12
00:0
0.00
0
00
0
0
0
0.10
X
11.76
37.58
38.52
51.97
32.02
8.26
0.00
0
000
17.93
000
9.30
8.35
17.92
表13-2不同菌株16种脂肪酸的百分含量
0.00
0.00
00
6X
24.92
22.54
83
2.
9
0
3
6
17
p
二
1
3
3
2
2
二
2
4
5
0.00
0.00
0.00
0.00
0.00
00'0
D.00
00'0
00'0
0.00
00'0
0.00
0.00
X
0.00
0.00
0.00
0.00
0.00
0.00
0.00
13.79
11.71
0.00
0
0.00
0.00
0.00
0.00
10.44
12.24
000
0.00
0.0
0.00
0.00
00
00:0
0.00
0.00
10
1
0.00
0.06
0
0.00
0.00
0.00
0
0.00
00'0
0.00
0.00
0.00
0.00
16.27
19.35
20.46
5.51
1.91
11.45
15.64
15.44
10.10
SX
0.0
0
00
0
00
8.59
20.18
6.21
32.59
25.81
30.62
38.05
/
906
3
3
3i
EX
0.00
0.00
2
0
0.20
0.19
0
X
0.77
0.81
0.42
0.70
0.48
2.82
0.88
0.48
0.50
0.74
2
0.89
0.91
2.66
0.77
4
L
X
00
一
100
0.0
0
菌株号
2
第十三章
聚类分析
223
【操作过程】
利用SPSS软件选择：分析一聚类分析→系统聚类。选择样品聚类、组
间距离法、欧式距离法测度距离。得到如下结果（表13-3）。
表13-3聚集时间表
类合并步骤
聚类指标第一次出现步骤
步骤
相关系数
下一个步骤
聚类指标1
聚类指标2
聚类指标1
聚类指标2
1
13
16
3.433
0
0
9
2
2
3
4.354
0
0
5
3
12
18
4.960
0
0
7
4
15
19
7.827
0
0
9
5
2
7
9.986
2
0
13
6
21
24
10.145
0
0
8
7
10
12
11.202
0
3
15
8
21
23
11.778
6
0
12
9
13
15
12.718
1
4
14
10
11
20
13.247
0
0
21
11
1
6
13.334
0
0
19
12
21
22
15.786
8
0
17
13
2
4
17.205
5
0
20
14
13
14
17.452
9
0
17
15
10
17
17.963
7
0
18
16
8
9
19.216
0
0
19
17
13
21
21.378
14
12
18
18
10
13
22.696
15
17
21
19
1
8
23.678
11
16
22
20
2
5
26.495
13
0
22
21
10
11
30.011
18
10
23
22
1
2
32.562
19
20
23
23
1
10
49.938
22
21
0
224兽医统计学
【解释】
24种菌株分别用1至24代替，步骤为变量个数减1，本例24个样品的聚
类过程共23步，前5步的过程如下，后面依次类推：
第一步：第13个与第16个变量合并；
第二步：第2个变量与第3个变量合并；
第三步：第12个变量与第18个变量合并；
第四步：第15个变量与第19个变量合并；
第五步：第2、3个变量与第7个变量合并。
2413
2316
2215
2119
2014
1921
1824
1723
1622
1512
1418
1310
1217
1111
1020
9
1
8
6
7
8
6
9
5
2
4
3
3
7
2
4
1
5
5
10
15
20
25
图13-124种菌株的系统聚类图
由图13-1可以看出，将这24种菌株分为四类比较合适，其中2、3、4、
5、7分为一类，1、6、8、9分为一类，11和20分为一类，10、12、13、14、
15、16、17、18、19、21、22、23、24分为一类。
第十三章聚类分析225
【例13-2】
欲对兽医体系效能评估（PVS）进行聚类分析，以发现哪些省、自治区
在指标上更为接近。结果详见表13-4。
表13-4PVS全国等级统计
地区（省、
兽医专
乡村兽医、
动物卫生
动物疫病
兽医机构
执业
兽医主管
市、自治
业技术
村级动物
监督机构
预防控制
建设
兽医
部门人员
区）
人员
防疫员
人员
机构人员
1黑龙江
4
2
1
3
4
3
3
2北京
5
2
I
3
5
4
4
3河北
5
1
4
5
5
5
5
4内蒙
4
2
2
3
1
3
4
5辽宁
5
2
3
4
3
3
6吉林
5
1
2
3
5
3
3
7上海
4
2
2
3
5
5
5
8江苏
4
5
2
3
5
1
3
9浙江
2
1
2
3
1
1
2
10安徽
4
4
1
3
5
3
3
11福建
3
1
2
3
3
1
3
12江西
2
1
2
3
4
3
13山东
4
3
2
3
5
1
3
14湖北
4
3
1
4
5
1
5
15湖南
4
1
1
3
5
4
3
16广东
5
1
2
3
5
4
4
17广西
5
2
2
3
4
3
3
18海南
4
1
1
3
5
3
3
19重庆
4
2
2
2
5
5
5
20贵州
4
1
1
3
4
3
3
21云南
4
2
2
3
5
3
3
22甘肃
4
2
1
3
5
3
3
23山西
4
2
1
4
4
3
3
24陕西
5
3
2
3
5
4
5
226
兽医统计学
【操作过程】
用SPSS软件在菜单中选择：分析一聚类分析→系统聚类。选择样品聚
类、组间距离法、欧式距离法测度距离。得到结果如表13-5和图13-2。
表13-5
聚类表
群集组合
首次出现阶群集
阶
系数
下一阶
群集1
群集2
群集1
群集2
1
1
23
10000.000
0
0
7
2
21
22
10000.000
0
0
7
3
18
20
10000.000
0
0
6
4
7
19
10000.000
0
0
14
5
5
17
10000.000
0
0
9
6
15
18
15000.000
0
3
10
7
1
21
20000.000
1
2
9
8
6
16
20000.000
0
0
12
9
1
5
22500.000
7
5
10
10
1
15
27222.222
9
6
12
11
2
24
30000.000
0
0
14
12
1
6
38888.889
10
8
17
13
8
13
40000.000
0
0
16
14
2
7
40000.000
11
4
17
15
11
12
60000.000
0
0
19
16
8
10
60000.000
13
0
18
17
1
2
80000.000
12
14
21
18
8
14
86666.667
16
0
21
19
9
11
100000.000
0
15
20
20
4
9
130000.000
0
19
22
21
1
8
135000.000
17
18
22
22
1
4
191184.211
21
20
23
23
1
3
244347.826
22
0
0
第十三章聚类分析227
0
5
10
15
20
25
24
23
23
22
21
21
22
20
5
17
18
18
17
20
16
15
15
6
14
16
13
12
19
11
1024
9
8
8
13
7
10
6
14
5
11
4
12
3
9
2
1
图13-224个省、自治区、直辖市的系统聚类图
【解释】
24个省、自治区、直辖市分别用1至24代替，步骤为变量个数减1，本
例24个样品的聚类过程共23步，前5步的过程如下，后面依次类推：
第一步：第1个变量与第23个变量合并；
第二步：第21个变量与第22个变量合并；
第三步：第18个变量与第20个变量合并；
第四步：第7个变量与第19个变量合并；
第五步：第5个变量与第17个变量合并。
228
兽医统计学
（2）R型聚类分析
【例13-3】
收集了24种菌株，测得菌株的16种脂肪酸百分含量，要求将这16种脂
肪酸分为几类，该如何实现？（数据见表13一2）
【操作过程】
利用SPSS软件在菜单中选择分析一聚类分析一系统聚类。选择指标聚
类、类间聚类、相关系数测度距离。得到结果如表13-6。
表13-6
聚集表
类合并步骤
聚类指标第一次出现步骤
步骤
相关系数
下一个步骤
聚类指标1
聚类指标2
聚类指标1
聚类指标2
1
1
7
0.768
0
0
2
2
1
12
0.697
1
0
7
3
4
5
0.685
0
0
12
4
11
14
0.634
0
0
8
5
8
15
0.512
0
0
9
6
6
10
0.479
0
0
11
7
1
3
0.371
2
0
12
8
11
16
0.270
4
0
11
9
2
8
0.266
0
5
13
10
9
13
0.170
0.
0
14
11
6
11
0.158
6
8
14
12
1
4
0.150
7
3
13
13
1
2
0.006
12
9
15
14
6
9
0.061
11
10
15
15
1
6
0.176
13
14
0
第十三章聚类分析229
【解释】
16种菌株分别用X至X代替，步骤为变量个数减1，本例16个指标的聚
类过程共15步，前5步的过程如下，后面依次类推。
第一步：X与X，合并；
第二步：X、X与X12合并；
第三步：X与X合并；
第四步：X与X合并；
第五步：X与X合并。
X,
X,
X2
12
X
3
X4
Xs
5
X8
8
X1s
15
X2
2
Xg
9
X13
13
X
6
X10
10
X
11
X14
14
X16
16
-5
10
15
20
25
0
图13-316种脂肪酸的系统聚类图
由图13-3可以看出，16种脂肪酸可以分为四类，其中X、X3、X4、X5
X、X12分为一类，X2、Xg、X1s分为一类，X9、X13分为一类，X、X10
X1、X14、X16分为一类。
230兽医统计学
四、动态样品聚类
当待分类的样品较多时，如海量数据挖掘，系统聚类分析将耗费较多的计
算资源来储存相似系数矩阵，计算速度缓慢。另外，用系统聚类方法聚类，样
品一旦归类后就不再变动了，这就要求分类十分准确。针对系统聚类方法的这
些缺陷，统计学者提出所谓动态聚类分析方法，这种分类方法既解决了计算速
度问题，又能随着聚类的进展对样品的归类进行调整。动态样品聚类的原理是：
首先确定几个有代表性的样品，称之为凝聚点，作为各类的核心，然后将其他
样品逐一归类，归类的同时按某种规则修改各类核心直至分类合理为止。动态
样品聚类方法中最常用的一种是k-means法，此法的聚类步骤如下：
（1）指定拟分类数目k，随机选择k个样品作为凝聚点各自成一类，各类的
重心分别是k个样品观测值构成的向量，记作X，X，"，X
（2）顺序选择n个样品中的一个，用Y表示其观测向量，分别计算Y与X，
X，“，X间的欧氏距离，将该样品归类到距离最小的那一类，同时计算该类
的重心即均数向量；重复此过程直至n个样品全部归类，k类新的重心仍记作X，
X2，，Xk；
重复第2步，直至所有样品的归类与上一步相同为止。
这种方法原理简单，分类快速，一般经过几轮归类就收敛了，即使样品很
多也能迅速得到分类结果。此法的缺点是要事先知道分类数目。在某些具体问
题中分类数目根据专业知识是完全可以事先确定的，而在有的问题中分类数目
则难以确定。为了克服这个缺点，人们提出了多种改良办法，这些改良办法虽
然无需事先指定分类数目，但必须给定类似如逐步回归分析中剔选的域值。如
果事先难于确定分类数目，一般建议尝试指定几个分类数目，结合实际考察分
为多少类时分析结果比较合理。为了消除量纲的影响，分类前要将观测指标标
准化。
第十三章聚类分析231
五、有序样品聚类
前面讲到的样品聚类分析方法，适用于无序样品的分类。在科学研究中
存在另一类型的资料，各样品在时域或空域存在自然顺序，如生长发育资料
的年龄顺序，发病率的年代顺序和地理位置。我们称这种样品为有序样品。
对有序样品分类时要考虑到样品的顺序特性这个前提条件，分类时不破坏样
品间的顺序，由此形成的样品聚类方法称为有序样品聚类（ordinalclustering
methods)
（1）设有n个样品，每个样品有m个观测值，观测值向量用X，X2，，X
表示，自然排列在直线上，
XX2
X
X
X
个
个
个
个
↑
有n一1个自然分割点（箭头所示）。欲将n个样品分割成k段（类），根据排列组
n-1
合原理共有k-1种分法，找出其最优分割。
（2）分类数目k的确定。分类数目k的确定视具体问题而定。对于有些兽
医学问题凭专业知识完全可以事先确定分类数目，例如疫病的病程，疫病的
等级等；很多问题中分类数目则难于事先确定。此时以离差平方和法衍生出
的有序样品最优分割法为例，最优分割法所对应的目标函数值用p（n，k）记
之，计算k=2，3，"，n-1所对应的p（n，k）并绘制散点图，用折线连接
散点。一般图形的X轴表示分类数目k，Y轴描述p（n，k）。随着分类数目k
的增加，p（n，k）迅速递减，当k=n时，p（n，k）=0。分类数目k确定原则
是使得p（n，k）变动相对较小的最小k值，相当于图形中曲线拐点处X轴的
坐标。
232兽医统计学
第四节注意事项
（1）聚类分析方法常用于数据的探索性分析，聚类分析的结果解释应密切
结合专业知识，同时尝试用多种聚类方法分类，才能获得较理想的结论。
（2）聚类前应对变量作预处理，剔除无效变量（变量值变化很小）、缺失值
过多的变量。一般需对变量作标准化变换或极差变换，以消除量纲和变异系数
大幅波动的影响。
（3）较理想的样品分类结果应使类间差异大，类内差异较小。分类后单变
量时应用方差分析，多变量时应用多元方差分析检验类间差异有无统计学意义。
第十四章
主成分与因子分析
234兽医统计学
【例14-1】
从疫病生态学的研究角度和猪丹毒流行学出发，整理调查了甘肃省平
凉地区1975一1989年15年中猪丹毒的发病及分布情况（见表14-2）。猪饲养
量、发病数、死亡数、流行乡、发病率、致死率、年平均气温、年降水量、
湿度指数等指标试图从分布流行区域的气候环境因素中找出该传染病与气
候因子间的关系。
【例14-2】
为研究昭觉县现代畜牧业发展情况，采用8个指标进行分析，分别为存
栏母猪数（X）、肥猪出栏量（X）存栏母牛数（X3）出栏肉牛数（X）
存栏母羊数（Xs）出栏肉羊数（X。）种草面积（X）草产量（Xg），试对
其发展情况作出评价。
【解释】
例14-1和例14-2中所测量的指标间不仅多而且还具有一定的相关性，
由于共线性的存在，运用多元线性回归直接建立的多元线性回归方程具有
不稳定性，甚至无法求得偏回归系数。若采用逐步回归，则不得不删除一
些自变量，这亦与初衷相悖。有没有什么方法既能保留原始资料的信息，
又能使得数据能进行深入的处理？本章所学的主成分分析和因子分析可以
很好地解决这种问题。
第十四章主成分与因子分析235
第一节主成分分析
主成分分析（principalcomponentsanalysis）也称主分量分析，于1901年由
Pearson首先引l入，1933年由Hotelling作了进一步的发展。主成分分析的基本思
想是通过降维过程，将多个相互关联的数值指标转化为少数几个互不相关的综
合指标的统计方法，即用较少的指标来代替和综合反映原来较多的信息，这些
综合后的指标就是原来多指标的主要成分。
进行科学研究时，经常遇到受到多个指标影响的实际问题，虽然含有多个
指标的数据可以提供丰富的信息，但同时增加了分析问题的复杂性和难度。而
且不同指标之间往往存在一定的相关性。那么，能否用较少的、相互独立的指
标来代替原来的多个指标，使其既减少了指标的个数，又能综合反映原指标的
信息？在实际工作中，目标问题所涉及的众多指标之间经常是有相互联系和影
响的，从这一点出发，希望通过对原始指标相互关系的研究，找出少数几个综
合指标，这些综合指标是原始指标的线性组合，它们既保留了原始指标的主要
信息，又互不相关。这样一种从众多原始指标之间相互关系人手，寻找少数综
合指标以概括原始指标信息的多元统计方法称为主成分分析。
主成分就是由原来的X～X变量线性组合出来的m个互不相关、未丢失任
何信息的新变量，也称为综合变量。多指标的主成分分析常用来寻找判断某种
事物或现象的综合指标，并对综合指标所蕴含的信息进行恰当解释。
236兽医统计学
第二节主成分分析的数学模型
设有m个指标X，X，，X，欲寻找可以概括这m个指标主要信息的综合
指标Z，Z，…，Zm。从数学上讲，就是寻找一组常数a，a，""，am（i=1，2，，
m），使这m个指标的线性组合：
Z=ax+a2x2+..+amxm
Z=a21x+a22X+..+amxm
(14-1)
Zm=amx+am2X2+..+ammXm
能够概括m个原始指标X，X，"，X的主要信息。且Z（i=1，2，"，m）满
足互不相关，var（Z）≥var（Z）≥≥var（Zm），
a²+a2²+…·+aim²=1（i=1，2，·.，m)
则称Z是原始指标的第i主成分i=1，2，"，m。
由上述定义可知，当i≠时主成分Z与Z是互不相关的，并且乙是原始指标
x，X，，X的一切线性组合中方差最大者，Z是与Z，Z2，，Zm-都不相关的、
除Z，Z，"，Zm-以外的X，X，"，X的一切线性组合中方差最大者。
第三节主成分分析的求法及性质
一、主成分分析的求法
主成分分析的具体求解是十分复杂的过程，需要用到复杂的数理方法。在
进行主成分分析时常借助SAS、SPSS等统计软件完成，故在因子求解过程中所
第十四章主成分与因子分析237
用的具体方法本书不进行深人讨论。
下面讨论怎样由一组X，X，"，X的样本观测值求出主成分。假设收集
到的原始数据共有n例，每例测得m个指标的数值，记录如表14-1的形式。
表14一1主成分分析的原始数据表
观测指标
样品号
X
X
Xm
1
X1
X2
Xim
2
X21
X22
X2m
：
：
Xn
Xn2
Xm
主成分的求法大体包括以下几个步骤
（1）对各原始指标数据进行标准化；
（2）计算相关系数矩阵；
（3）求出相关矩阵的特征值和特征值所对应的特征向量。
二、主成分的性质
1.各主成分互不相关。即Z与Z的相关系数为零。
2.主成分的贡献率和累积贡献率。各主成分的方差和为
且各原始指
标X，X，"，X的方差和与各主成分Z，Z，，Z的方差和相等：将数据标
准化后，原始指标的方差和为m，即有"=
一般地，称
u
（14-2)
i=1
为第i主成分的贡献率。这个值越大，表明乙这个指标综合原始指标x，X，·
238兽医统计学
X的能力越强。也可以说，由乙的差异来解释的X，X，·，X差异的能力越强。
而称
（14-3)
为前k个主成分的累积贡献率。
3.主成分个数的选取。通常并不需要全部的主成分，只用其中的前几个。
一般说来，主成分的保留个数按以下原则来确定：
（1）以累积贡献率来确定。当前k个主成分的累积贡献率达到某一特定的值
时（一般以大于70%为宜），则保留前k个主成分。
（2）以特征值大小来确定。即若主成分乙的特征值L≥1，则保留Z，否则就
去掉该主成分。
当然，在实际工作中，究竞取前几个主成分，除了考虑以上两个原则之外，
还要结合各主成分的实际含义来定。一般说来，保留的主成分个数要小于原始
指标的个数。
4.因子载荷。为了解各主成分与各原始指标之间的关系，在主成分的表达
式（14-1）中，第i主成分Z的特征值的平方根√与第/原始指标X的系数a的
乘积
qy=√A.a
（14-4）
为因子载荷（factorloading）。因子载荷g就是第i主成分Z与第/原始指标x之
间的相关系数，它反映了主成分Z与原始指标x之间联系的密切程度与作用的
方向。
5.样品的主成分得分。对于具有原始指标测定值（Xn，X2，，Xm）的
任一样品，将原始数据标化，然后代人各主成分的表达式
Z=aX'+anX'+..·+amXm（i=1，2，，m）
求出该样品的各主成分值。这样求得的主成分值称为该样品的主成分得分。利
用样品的主成分得分，可以对样品的特性进行推断和评价。
第十四章主成分与因子分析239
三、实例分析
【例14-1】
从疫病生态学的研究角度和猪丹毒流行学出发，整理调查了甘肃省平
凉地区1975一1989年15年中猪丹毒的发病及分布情况，详见表14-2。从分
布流行区域的气候环境因素中找出该传染病与气候因子间的关系和主成分。
表14-2
甘肃省平凉地区1975一1989年15年中猪丹毒的发病及分布情况
年平均
年降
湿度
猪饲养量
发病数死亡数流行乡
发病率
致死率
年份
气温
水量R
指数
（万只）
（只）
（只）
（个）
（%)
（%)
T(C）（mm）
1975
44.33
248
122
6
0.56
49.19
8.30
637.50
0.81
1976
59.25
917
409
7
1.55
44.60
8.60
487.40
0.57
1977
51.63
315
132
9
0.61
41.90
8.80
467.70
0.53
1978
46.36
518
225
17
1.12
43.44
8.80
464.20
0.53
1979
43.77
525
196
18
1.20
37.33
9.10
506.90
0.56
1980
43.37
209
73
16
0.82
34.92
8.60
475.90
0.55
1981
41.11
0
0
0
0.00
0.00
8.20
618.30
0.75
1982
38.73
6
0
3
0.02
0.00
8.40
318.10
0.38
1983
39.10
5
3
2
0.01
60.00
8.40
632.00
0.75
1984
41.04
3
1
3
0.01
33.33
7.80
543.40
0.70
1985
49.52
4
0
5
0.01
0.00
8.20
513.00
0.63
1986
49.91
0
0
0
0.00
0.00
8.30
315.40
0.38
1987
43.16
51
30
1
0.12
58.82
9.50
476.50
0.50
1988
44.40
18
7
1
0.04
38.89
8.70
427.70
0.49
1989
48.30
136
2
6
0.28
14.71
8.50
525.70
0.62
在SPSS软件中选择：分析一降维一因子分析，
完成分析。经过KMO
和Bartlert检验，KMO统计量为0.320偏相关性弱，球形Bartlert检验P<0.05，
240兽医统计学
表明这些数据适合进行因子分析。在因子分析之后，得到的是因子载荷，
再根据g=√Aa计算出主成分分析的相关系数。计算结果如表14-3。
表14-3猪丹毒四项变量主成分
年平均
年降
湿度
累计贡
贡献率
主成分
发病率
气温
水量R
指数
特征值
献率
(%)
T（C）
（mm)
I
(%)
Z
-0.1380
-0.3897
0.6223
0.6647
2.1578
53.944
53.944
Z2
0.7542
0.5459
0.3179
0.1790
1.2893
32.233
86.178
Z3
-0.6419
0.7248
0.2412
0.0659
0.5495
13.738
99.916
Z4
0.0140
0.1572
0.6734
0.7223
0.0034
0.084
100.000
【解释】
（1）主成分个数的选取。依据表14一3的各项数据，第一个特征值为
2.1578大于1，第二个特征值1.2893大于1，且前两个主成分的累计贡献率已
达到86.178%，故本题取前两个主成分就可以了。
（2）列出主成分表达式X~X分别代表标准化后的发病率、年平均气
温、年降水量、湿度指数数据。
Z=-0.138X-0.3897X+0.6623X,+0.6647x
Z=0.754X+0.5459X+0.3179X+0.1790X4
由此可知，第一主成分主要反映了年降雨量与湿度指数指标的信息，
而第二主成分主要反映了原始指标中猪自身的病原微生物和免疫系统有关
方面的信息，还有年平均气温的信息。
由上述讨论可知，将四个具有一定相关性的原始指标降为2个独立的主
成分，这就为利用主成分作进一步统计分析奠定了基础。
第十四章主成分与因子分析241
第四节主成分分析的应用
主成分分析主要有以下几方面的应用：
（1）对原始指标进行综合。从方法学上讲，主成分分析的主要作用是在基
本保留原始指标信息的前提下，以互不相关的较少个数的综合指标来反映原始
指标所提供的信息，为进一步的统计分析奠定基础。
（2）探索多个原始指标对个体特征的影响作用。主成分分析可以视为一种
探索性方法，对于多个原始指标，求出主成分后，可以利用因子载荷阵的结构，
进一步探索各主成分与多个原始指标之间的相互关系，弄清原始指标对各主成
分的影响作用。
（3）对样品进行分类。利用主成分分析还可对样品进行分类。求出主成分
后，如果各主成分的专业意义较为明显，可以利用各样品的主成分得分来进行
样品的分类。
第五节因子分析的基本思想
因子分析是一种旨在寻找隐藏在多变量数据中，无法直接观察到却影响或
支配可测变量的潜在因子，并估计因子对可测得的变量的影响程度，以及潜在
因子之间的相关性的一种多元统计方法。
其基本思想是从分析多变量数据的相关关系入手，寻找支配这种相关关
系的少数儿个独立的潜在因子，并通过建立起这些潜在因子与原变量之间的
数量关系来预测潜在因子的状态，帮助发现隐藏在原变量之间的某种客观规
律性。
242兽医统计学
例如，随着年龄的增长，动物的体长、体重、体高会随着变化，具有一定
的相关性，体长和体重之间为何会有相关性呢？因为同时存在着一个同时支配
或影响着体长和体重的生长因子。那么能否通过对多个变量的相关性研究，找
出同时影响或支配所有变量的共性因子呢？因子分析就是从大量的数据中寻找
出影响或支配变量的多变量统计方法。
第六节因子分析数学模型
假设对n例样品观测了m个指标，即X，X2，，X，得到观测数据。因子
分析的任务就是从一组观测数据出发，通过分析m个指标X，X，"，X之间的
相关性，找出起支配作用的潜在因子，使得这些因子可以解释各指标之间的相
关性（为方便，这里的X为标准化数据）。
X=aF+a2F2+...+aF+e
X=a2F+a22F2+...+a2qFa+e2
（14-5）
Xm=amF+am2F2+...+amgF+em
（1）各X的均数为0，方差为1（X=0，s²=1）；各公因子F的均数为0，方差
为1（F=0，sF²=1）；各特殊因子e的均数为0，方差为o²，即e=0，s²=o²。
（2）各公因子之间的相关系数为0，即r.F=0；各特殊因子之间的相关系数
为0，即re，=0；各公因子与各特殊因子之间的相关系数为0，即rr，=0。
第十四章主成分与因子分析243
第七节因子分析的性质
，²的大小反映了全体公因子对原始指标X的影响，
k=1
因子的线性组合来表示，而与特殊因子无关；当h接近于0时，表明原始指标
X，X，，X受公因子的影响不大，而主要是由特殊因子来描述的。因此“公
共度”h²反映了原始指标X对所有公因子的依赖程度。
=l
始指标的影响，称g为公因子F对所有原始指标的“贡献”。显然，g²的值越大，
则F对原始指标的影响也越大。
注意到数据标准化后，s=1，故全部原始指标的总方差等于指标个数m，则
a
g
(14-6)
m
m
为公因子F对原始指标的方差贡献率。
3.因子载荷及因子载荷矩阵。根据公式及假设可以推算出：
a=rxpF)
即a就是X与F之间的相关系数。
a作为X与F之间的相关系数，它反映了X与F之间相互联系的密切程度；
另一方面，a作为公因子的系数，它又体现了原始指标X的信息在公因子F上的
反映，因此称a为原始指标X在公因子F上的因子载荷，而称矩阵A=（a）mxg
为因子载荷矩阵。
a1
21
am2
244兽医统计学
第八节因子载荷的求解
因子载荷的具体求解是一个十分复杂的过程，需用到矩阵，条件极值，迭
代等求解方法。如今在进行因子分析时常借助SAS、SPSS等统计软件完成。
一、因子载荷求解的主要计算步骤
因子载荷求解的主要计算步骤如下：
（1）收集原始数据并整理，详见表14-1；
（2）对各指标作标准化；
（3）求指标间的相关系数矩阵；
（4）求指标间的约相关矩阵：估计指标间的约相关矩阵的方法很多，如：
主成分解、主因子解、最大似然因子解；
（5）求出约相关矩阵所有大于零的特征值2及相应的特征向量；
（6）根据特征值写出因子载荷矩阵A，并得出原始指标X的公因子表达式；
1p
a12...
alg
A=(√1√1√1g）mxg=
d21
a22
：
am1am2
dmg
X=aF+aF+...+aqF
X=a2F+a22F2+...+a2qF
Xm=amF+am2F2+...+amgFg
这里，得到的原始指标X的公因子的表达式实际上是近似的。
根据因子模型的性质及因子载荷阵的求解过程可知，在进行因子分析时希
望获取：
第十四章主成分与因子分析245
（1）保留的公因子个数g远小于原始指标个数m。一般按以下原则来确定：
①若L≥1，则保留其对应的公因子；②若前k个公因子的累积贡献率达到特定
数量（一般认为达到70%以上为宜），则保留前k个公因子，使m个原始指标的总
方差基本上能被所保留的公因子解释。
（2）各共性方差h²（i=1，2，，m）接近于1，即各原始指标X的方差绝
大部分能由所保留的公因子解释。
（3）各原始指标在同一公因子F上的因子载荷的绝对值a丨（i=1，2，m）。
即竖读因子载荷阵A之间的差别应尽可能大，使得公因子F的意义主要由一个或
几个a值大的原始指标所表达。
二、实例分析
【例14-2】
采用8个指标进行分析昭觉县现代畜牧业发展情况，这8个指标分别
为存栏母猪数（X）、肥猪出栏量（X2）、存栏母牛数（X）、出栏肉牛
数（X）、存栏母羊数（X）、出栏肉羊数（X）、种草面积（X）、草产量
（X），试分析找出几个潜在的因子，对其发展情况作出评价，其原始数据
见表14-4。
表14-4昭觉县各乡（镇）畜牧业生产整理数据表
母猪数
猪出栏
母牛数
牛出栏
母羊数
羊出栏
种草面产草量
乡镇名
(X）
数（x）
（X）
数（X）
(X)
数（x）
积（X）
(Xg)
新城镇
2378
22189
750
846
3772
6063
9280
8352
城北
1488
5238
733
340
1286
1030
6171
5554
谷曲
1249
7391
773
565
4021
5599
6513
5860
树坪
308
2596
176
153
2834
1802
3100
2790
达洛
647
2325
424
158
2225
1183
5565
5008
龙恩
897
3548
753
234
4367
4048
6360
5724
246
兽医统计学
（续）
母猪数
猪出栏
母牛数
牛出栏
母羊数
羊出栏
种草面
产草量
乡镇名
（X）
数（x）
（X）
数（x）
（X）
数（x）
积（X）
（X）
美甘
982
4972
109
366
3529
1886
5800
5220
四开
3105
9730
1780
720
8280
5066
7975
7177
大坝
1660
8752
647
1114
2512
5902
5870
5283
地莫
3380
10712
1202
740
7234
8738
7342
6607
柳且
1713
6635
950
430
7607
4725
7605
6844
博洛
1145
8606
687
651
5017
8667
8582
7723
库莫
1038
10068
753
995
8372
14545
8608
7747
三岗
1024
3325
539
684
8077
16133
7000
6299
洒拉地坡
3009
5372
850
797
8978
36183
12483
11234
三岔河
1407
3395
580
390
7216
4195
6978
6280
解放
1601
4788
795
350
11277
17937
8254
7428
尼地
896
3601
300
730
4598
15371
4000
3596
碗厂
1044
2470
240
252
3714
4960
5513
4961
普诗
3100
4165
278
725
4776
13129
7561
6804
玛增依乌
2215
3304
223
255
2834
3810
5255
4729
塘且
623
3930
359
390
2671
3426
4313
3881
久特洛古
1136
2934
361
298
3027
6730
7070
6363
特口甲谷
951
4158
241
415
7013
7419
9000
7587
齿可波西
1238
6433
786
603
2495
6868
0006
7712
补约
1212
4077
495
376
5069
2985
4988
4489
竹核
2355
7672
1253
355
7101
6939
8218
7396
庆恒
2368
6252
917
496
6707
4969
4820
4338
格吾
973
3340
219
192
4160
2689
3694
3324
特布洛
2163
6734
1137
191
7989
3085
7087
6378
色底
909
2828
468
372
5075
3100
4061
3654
拉一木
1649
4409
843
370
4987
3751
4186
3767
阿并洛古
2602
5147
988
545
6694
2923
6310
5679
比尔
2180
12125
1471
1920
4010
14250
6500
5850
库依
1700
8850
1040
675
7350
17150
6450
5805
金曲
850
3999
288
250
5469
6500
5000
4480
宜牧地
1130
3902
569
486
5217
5830
5000
4506
波洛
775
4042
457
425
3379
4057
5200
4680
第十四章主成分与因子分析
247
（续）
母猪数
猪出栏
母牛数
牛出栏
母羊数
羊出栏
种草面
产草量
乡镇名
(X）
数（X）
(X）
数（x）
(X)
数（X）
积（X）
(Xx)
央摩祖
784
4367
1462
1110
6775
8994
4200
3830
永乐
795
3519
341
300
2230
3200
3510
3141
则普
1896
5076
719
964
7092
5087
5800
5086
哈甘
3513
6678
1123
623
6196
7748
5490
4811
目哈
1700
4433
565
810
5442
8580
11600
10248
且莫
1938
5939
457
770
5608
9870
8904
7746
龙沟
712
2969
279
232
3464
2682
4182
3538
甘多尔古
682
4389
232
520
2838
4361
5800
5083
支尔莫
895
3520
296
221
3534
2508
3960
3510
解：在SPSS软件中选择：分析一降维一→因子分析，
完成分析。见表
14-5、表14-6。
经过KMO和Bartlert检验，KMO统计量为0.646偏相关性弱，球形
Bartlert检验P<0.05，适合因子分析。
表14-5
因子载荷矩阵、特征值、贡献率、累计贡献率
变量
因子1
因子2
因子3
因子4
因子5
母猪数（X）
0.7211
0.2516
0.2116
-0.3044
-0.5248
猪出栏（X）
0.6443
0.5014
-0.3828
-0.1397
0.1474
母牛数（X）
0.6708
0.5324
0.3381
-0.0744
0.2037
牛出栏（x）
0.6382
0.3886
-0.2501
0.5561
-0.0188
母羊数（x）
0.6520
-0.2136
0.6401
0.0284
0.2313
羊出栏（X）
0.6845
-0.4066
0.0785
0.5073
-0.1715
种草面积（X）
0.8219
-0.4233
-0.2738
-0.2197
0.0764
产草量（Xg）
0.8333
-0.4129
-0.2630
-0.2168
0.0751
特征值（）
4.0560
1.3097
0.9282
0.7803
0.4334
贡献率（%)
50.70
16.37
11.60
9.75
5.42
累积贡献率（%）
50.70
67.07
78.67
88.43
93.84
248兽医统计学
表14一6主成分因子分析后的公共度
X
X,
X
X
X
"X
X,
X8
0.7207
0.8325
0.8532
0.9300
0.8813
0.8974
0.9780
0.9810
【解释】
由表14-5前两个特征值大于1，但其累计贡献率仅为0.6707，不足80%，
故考虑取前四个公因子，这是累计贡献率为88.43%
由表14-5可知，因子1在多数原始指标上都有较大载荷，因子2在猪出
栏、母牛数、羊出栏、种草面积、草产量上有较大载荷，因子3则在母羊
数、猪出栏和母牛数上有较大载荷，因子4在牛出栏和羊出栏上具有较大载
荷。由此可知除了因子1可初步认定为综合因子外，其余三个因子的意义不
明显。
由表14-6可知，各共性方差均超过70%，这说明4个因子已经能够很好
地反映各指标所包含的大部分信息。得到的因子方程为：
X=0.7211F,+0.2516F+0.2116F-0.3044F
X=0.6443F,+0.5014F-0.3828F-0.1397F
：
X=0.8333F-0.4129F-0.2603F-0.2168F
第九节因子旋转
建立因子分析模型的目的不仅是找出公因子，更重要的是弄清各公因子的
专业意义，以便对实际问题进行分析。然而在很多情况下，因子分析的主成分
解、主因子解及极大似然解中的各公因子的典型代表变量并不是很突出，容易
第十四章主成分与因子分析
249
使各公因子的专业意义难于解释，从而达不到因子分析的主要目的。
对于这个问题，可以通过因子旋转来解决。线性旋转不改变变量间的关联
联系，所以任何旋转变换都不会改变一组指标内隐藏的潜在因子的个数及潜在
因子的实际意义。
旋转的方法有很多，可以分为正交旋转和斜交旋转两大类，前者包括方差
最大法（varimax），四次方最大旋转（quartimax）和均方最大旋转（equamax）
等方法，后者最常用包括Promax法等。
将此题用方差最大法旋转后，列出表14-7、表14-8。
表14-7旋转后因子载荷矩阵、特征值、贡献率、累计贡献率
变量
第一因子
第二因子
第三因子
第四因子
第五因子
母猪数（X）
0.2395
0.2632
0.2247
0.1133
0.8979
猪出栏（X）
0.3257
0.8396
0.0015
-0.0500
0.2018
母牛数（x）
0.0184
0.6388
0.6148
-0.0095
0.3289
牛出栏（X）
0.0530
0.7388
0.0240
0.6133
0.0708
母羊数（X）
0.2771
-0.0136
0.8817
0.2416
0.1488
羊出栏（X）
0.3981
0.0012
0.2628
0.8295
0.1056
种草面积（X）
0.9346
0.1665
0.1559
0.1930
0.1453
产草量（X）
0.9298
0.1756
0.1682
0.1974
0.1546
特征值（）
4.0560
1.3097
0.9282
0.7803
0.4334
贡献率（%）
0.5070
0.1637
0.1160
0.0975
0.0542
累积贡献率（%）
0.5070
0.6707
0.7867
0.8843
0.9384
表14-8
旋转后主成分因子分析后的公共度
X,
X
X;
X4
Xs
X
X,
X8
0.7207
0.8325
0.8532
0.9300
0.8813
0.8974
0.9780
0.9810
250兽医统计学
【解释】
由表14-7可知，因子1在草面积、草产量上有较大载荷，视为草业因
子；因子2在猪出栏、牛出栏上有较大载荷，视为猪、牛产品因子，因子3
则在母羊数上有较大载荷，视为羊资源因子；因子4在羊出栏上具有较大载
荷，视为羊产品因子。其余与旋转前无差别。由表14-6和表14-8可知各共
性方差在旋转前后无差别。
，第十节因子分析注意事项
1.因子分析的解不唯一
这里所说的因子分析的解不唯一具有两个方面的意义：
（1）同一问题可以有不同的因子分析解，如主成分解、主因子解、极大似
然解等。在处理实际问题时，可根据具体情况选择不同的方法来获得符合客观
实际的解。
（2）可以通过各种方法进行因子旋转以获得更为满意的解。这里，选用何
种方法进行因子旋转，亦需根据专业意义来确定。需要指出的是，如果一次旋
转所得结果不够理想，可以用迭代的方法进行多次旋转，直到最后相邻两次旋
转所得的因子载荷阵改变不大时即可停止。
2.因子得分问题
因子得分指的是模型中潜在因子的取值。建立因子得分函数F=μX+
μpX+"+μpXpj=1，2，，P，再由因子得分函数计算样品的因子得分，值得
注意的是，因子得分函数中变量的个数p小于原变量的个数m，所以求出的因
子得分为估算值。此外，还可以利用回归估计法、Bartlett估计法等估计因子
得分。
第十四章主成分与因子分析251
3.主成分分析与因子分析之间的关系
（1）两者的分析重点不一致。从数学模型上看，主成分的数学模型为原始
变量的线性组合；而因子分析的数学模型为公因子与特殊因子的线性组合。由
此可见，两者的分析重点不一致：主成分分析重点在综合原始变量的信息，而
公因子分析则重在解释原始变量之间的关系。此外，主成分分析中各主成分的
得分是可以准确计算的，而因子分析中各公因子得分只能进行估计。
（2）两者之间具有密切的联系。主成分分析经过变换后可以成为无特殊因
子的公因子模型。另一方面在某些情况下，因子分析的结果（主成分解）即为
主成分分析的结果，此外，因子分析的主因子解也常常由主成分分析的结果作
为h的初始值来计算的。
第十五章
时间序列分析
254兽医统计学
【例15-1】
某疫控机构长期连续收集全省动物疫情的资料。（1）2009年1月至2013
年12月新城疫疫情月发生次数；（2）2009年1月至2014年5月猪丹毒病的月
发病数。
【问题】
（1）上述资料属于什么性质的资料？有何特点？
（2）统计预测方法一般有哪些？上述资料常用何种统计方法预测
分析？
（3）使用该方法进行统计预测时，有何注意事项？
【分析】
（1）上述依据时间顺序组成的观察资料称之为时间序列资料。这些资
料的本质特征是相邻观测值之间有依赖性，或称自相关性。
（2）统计预测分析方法有很多种，如定性预测方法中的德尔菲法、主
观概率法和交叉概率法等；定量预测方法中的回归分析法、灰色模型法、
时间序列法、马尔科夫链预测法等。目前，常用时间序列法对上述资料进
行统计分析，从而达到预测的目的。
（3）使用时间序列方法进行定量预测是有条件的，通常是假定某现象
的发展变化规律、趋势以及速度在未来仍将以一定的方式持续。因此，时
间序列预测方法一般是做短期预测。时间序列预测方法是以历史值为依据
的，只有收集足够多的数据才能有可能发现该现象的规律，从而获得比较
满意的结果。
第十五章时间序列分析255
第一节时间序列分析概述
按某种（相等或不相等的）时间间隔对客观事物进行动态观察，由于随机
因素的影响，各次观察的指标x（=1，，n）都是随机变量，这种按时间顺序
排列的随机变量（或其观测值）称为时间序列，一般用（x表示。在兽医领域，
很多数据都是以时间序列形式呈现，比如某个省份有关动物疫情的逐月监测数
据，如口蹄疫、猪瘟、禽流感、新城疫、猪丹毒等的月度发病资料等。
时间序列分析方法可以分为描述性时序分析和统计时序分析。描述性时序
分析通过直观的数据比较或绘图观测，寻找序列中蕴含的发展规律。这种方法
操作简单、直观有效，并且是进行统计时序分析的第一步。
统计时序分析根据分析目的的不同，又可以划分为时域分析和频域分析两
个类别。时域分析将序列的观察值视为历史值的函数，重点分析事物随时间发
展变迁的趋势，常用于人口、经济、医学等研究领域；频域分析将序列视为不
同频率的正弦或余弦波叠加的结果，重点分析其频率特征，常用于电力、工程
等方面。本章仅介绍时间序列的时域分析方法。
事物的发展通常都具有一定的惯性，这种惯性用统计的语言来描述就是序
列值之间存在着一定的相关关系，这种相关关系通常具有某种统计规律。通过
寻找出序列值之间相关关系的统计规律，并拟合出适当的数学模型来描述这种
规律，进而利用这个拟合模型预测序列未来的走势。
时间序列分析方法往往涉及大量的计算，通常需要借助计算机软件才能完
成。随着计算机科学的发展，目前可用的软件比较多，如SAS、SPSS、Matlab、
S-plus、Gauss、TSP和Eviews等。每个软件都有自已的特点，其中SAS系统中
的ETS模块是专门用来分析时间序列，是进行时间序列分析的理想软件。SPSS
以操作简单见长，不需要编程（但SPSS软件提供编程的操作）就可以完成常见
的时间序列模型的建立。
256兽医统计学
第二节指数平滑法
一、指数平滑方法的理论与数学模型
平滑法是处理时间序列资料常用的一种方法，它利用修匀技术，削弱短期
随机波动对序列的影响，使序列平滑化，从而显示出序列变化的规律。常用的
平滑方法有移动平均法和指数平滑法。移动平均法基本思想是假定在一个比较
短的时间间隔里，序列值之间的差异主要由随机波动造成。根据这种假定，可
以用一定时间间隔内的平均数作为某一期的估计值。
移动平均法实际上是用一个加权平均数作为某一期趋势的估计值。故移动
平均法面临两个难题，其一是给当前值和历史值同等权重不合理，一般而言，
未来值总是和邻近时点的值关系更密切：其二是窗宽（指计算移动平均数时使
用数据的个数）的确定没有一个明确的标准，使用5日移动平均数还是15日难有
定论。而且，如果使用5日移动平均数，那么5日之前的观察值等于赋予权重0，
而5日内的观察值均有相等权重0.2，这也与实际情况不符合。
指数平滑法的思想来源于对移动平均法的改进，其基本思想是对大多数随
机事件而言，一般都是近期的结果对现在的影响会大些，远期的结果对现在的
影响会小些。为了更好地反映这种影响作用，考虑到时间间隔对事件发展的影
响，使用无穷大为窗宽，各期权重随时间间隔的增大而呈指数袁减。本节仅介
绍指数平滑法，指数平滑法用公式表达如下：
θx-j
X
X1==0
Eθi
j=0
(15-1)
j=0
式中，0≤0≤1；j=0，1，2，；=1，2，；t>j。x表示观测序列，x，表示
预测序列（下同），分母为正则化常数，其作用是保证权重之和为1。
第十五章时间序列分析257
时间序列一般有随机波动、长期（线性或非线性）趋势和周期性（稳定性
或不稳定性）波动三方面特征，根据这些特征，指数平滑法又有多种具体的方
法：简单指数平滑法（Simple法），Holt法，Winters法等。本节仅介绍Simple法
与Holt法的数学模型。
（1）Simple法。本法为单参数的指数平滑模型，适用于无长期趋势和无周
期性波动的序列。Simple法预测的数学模型为：
xi+1=ax,+（1-a）x
（15-2）
（2）Holt法。本法称为Holt双参数指数平滑法，适用于有线性趋势而无季节
性趋势的时间序列。HolIt法的数学模型为
B=y（x-x-1)+（1-)B-1，B=0,0≤y≤1
（15-3)
令
x=αx+（1-α)（x-1+B1），21=z1，0≤α≤1
（15-4)
则
x1+m=x+mB
m为预测的领先时间间隔。
二、指数平滑法的四个重要参数
以上是两种最简单的指数平滑法。但在实际工作中，往往需要考虑以下
几个因素：①最邻近的值。许多（有可能是大多数）时间序列有正自相关
性，这意味着每一个值能与它的前一个时间点值紧密相关。②整体均数。当
不能找到序列的规律性时，这常是最好的预测值。③整体趋势。例如考察一
定时期内一个羊群的数量，如果数量每个月增加5%，应该调整预测值使它
能够反映这种趋势。④季节性。如果要预测秋季羊群的数量，就必须注意存
栏羊群的季节性规律。这些因素的作用需要用到指数平滑法四个重要参数来
反映。
指数平滑预测方法往往需要借助计算机完成。这里介绍在SPSS统计软件中
是如何定义和分析这四个参数的。
258兽医统计学
1.常规参数a。它可以控制加载到近期观察值的权重，用以决定序列的整
体水平。当α=1时，仅使用最近的一个观察值；当α=0时，全部观察值赋予一
样的权重。
2.趋势参数y。只用在序列显示了趋势性。当y值较高时，则从序列最邻近
点的趋势为基础进行预测；当y值较低时，则从整个序列所有的点得到的趋势性
为基础进行预测。
3.季节参数。只用在序列显示了季节性。若模型的值较高时，则主要从
邻近的时间点估计季节性；若模型的值较低时，则从整个序列所有的点得到的
季节趋势性为基础进行预测。
4.趋势性衰减π。当序列显示了某种趋势性，但这种特性被逐渐抑制或消
失时，则用π取代y。当π的值较高时，模型对趋势性衰减的迹象会作出迅速的反
应；当π的值较低时，估计趋势性的衰减应以整个序列为基础。
以上四个参数确定了指数平滑模型在生成时间序列过程中各种特征参数的
变化速度。从序列的起始位置开始进行指数平滑，每次一个时间段，依次往下
进行，每一步都采用邻近的值，并校正序列的均数；必要时还对趋势性、季节
性及趋势衰减的估计值进行校正。
三、指数平滑法的计算
【例15-1】
（1）某省2009—2013年新城疫疫情的月发生次数资料详见表15-1，请
对该省新城疫疫情月发生次数采用指数平滑法进行分析预测。
表15-1某省2009一2013年新城疫疫情月发生次数
年份
月份
发生次数
年份
月份
发生次数
2009
1
3
2009
3
4
2009
2
3
2009
4
4
第十五章时间序列分析
259
（续）
年份
月份
发生次数
年份
月份
发生次数
2009
5
6
2013
3
9
2009
6
5
2013
4
8
：
2013
5
8
2009
12
2
2013
6
0
2013
1
8
：
2013
2
9
2013
12
9
注：资料来源于农业部《兽医公报》2009一2013年月报数据
首先，绘制新城疫疫情月发生次数序列图，如图15-1所示。通过观察
这一个序列是否显示了趋势性或季节性等，确定哪一个参数是不需要的，
然后找到最适合序列的值。
12.5-
10.0-
发
生次数
7.5-
5.0-
2.5-
2009
2010
2011
2012
2013
图15-1某省2009一2013年新城疫疫情月发生次数序列图
对于新城疫疫情月发生次数序列，序列图并没有显示明显的趋势性
（故y和π是不必要的），同时也没有明显的季节性（故也是不需要的）。因
此，仅需估计a这个唯一的参数。由于指数平滑法参数估计的计算量比较
260兽医统计学
大，因而在实际中都是采用软件完成，本节采用SPSS进行指数平滑处理。
在SPSS20.0中，选择Simple法（即仅含一个常规参数a的模型），则可以输
出参数估计以及其他的结果，见表15-2。由表15-2知，常规参数α=0.360，
P=0.001，表明建立的模型有统计学意义。
表15-2指数平滑法参数估计及检验
模型
参数值
标准误
统计量
P值
Simple
0.360
0.100
3.593
0.001
图15-2反映了内样本（所谓内样本是指参加拟合的所有实际数据，相
对应地外样本是指未参加模型拟合的所有实际数据）的拟合效果，可以看
到，拟合值序列的线形轨迹与原始序列比较接近（但极个别极端值除外，
如月发生次数为0次的情形）
实测值
拟合值
12.5-
10.0
7.5-
5.0
2.5
0.0
图15-2指数平滑的内样本回代结果
内样本拟合的残差如图15-3所示。通常，残差是随机分布的，没有任
何可辨别的规律。如果任何模型的残差分布显示了一定的规律，那么这个
第十五章时间序列分析261
模型是不合适的。图15-3的残差没有显示规律性，因而说明拟合结果是合
理的。
10-
伞
差值
10
图15-3残差图
最后可以利用建立的指数平滑模型对未来进行预测。根据常规参数a的
估计结果可确定模型的口径为xx1=αx，+（1-α）x=0.36x+0.64x，x和x分
别为第t期的实际值和预测值。需要注意的是，使用简单指数平滑法一般只
做未来1期的预测。
第三节ARIMA模型
自回归滑动平均混合（Autoregressiveintegratedmovingaverage，ARIMA）
模型又称博克斯-詹金斯（Box-Jenkins）模型，是由美国统计学者G.E.P.Box和
262兽医统计学
英国统计学者G.M.Jenkins于1970年首次系统提出。ARIMA是Box-Jenkins方法
中的重要时间序列分析预测模型，它是多个模型的混合，可分为：①自回归模
型（AR）；②滑动平均模型（MA）；③自回归滑动平均模型（ARMA）；④自回
归滑动平均混合模型（ARIMA）
一、ARIMA模型结构
设时间序列为{X}，ARIMA模型的数学结构为：
①(B)Vx=O（B)
E(e)=0,Var（e,)=o²，E(8c）=0,s≠t
（15-5）
1>SA0=3xg
式中，E，Var分别表示数学期望和方差，Vs<t表示对任意的s<t。下面对模型
中涉及的其他符号及基本概念简单介绍如下：
（1）差分运算。V为d阶差分运算，所谓d阶差分：相距一期的两个序列
之间的减法运算称为1阶差分运算，对1阶差分后序列再进行1阶差分运算称为
2阶差分，依此类推，对d一1阶差分后序列再进行1阶差分运算称为d阶差分，
记v"x为x的d阶差分，有vx=V-x-V-x-1另外，常用的差分运算还有k步差
分：相距k期的两个序列值之间的减法运算称为k步差分运算，记vx为x的k步差
分，有：Vx=x-x-k。k步差分主要用在有周期规律的序列中。
（2）延迟算子。延迟算子类以于一个时间指针，当前序列值乘以一个延迟
算子，就相当于把当前序列值的时间向过去拨了一个时刻。记B为延迟算子，
有x=Bx。可以发现，引l人延迟算子后，Vx=（1-B）x
（3）白噪声序列。如果序列{z}满足E（z,）=μ，Var（z,）=o²，Cov（zz）
=0，s≠t（即序列的期望和方差为常数，且协方差为0），则序列{z称为白噪声
序列，也称纯随机序列。在ARIMA模型中，为t时刻的误差或偏差，表示不能
用模型说明的随机因素，序列c为零均数白噪声序列。
（4）自回归系数多项式。式中，Φ（B）=1-B-"-B”，为模型的自回
归系数多项式。
第十五章时间序列分析263
（5）移动平滑系数多项式。式中，（B）=1-0B-…-0B，为模型的移
动平滑系数多项式。因此，ARIMA模型文可以表达为：
(1-B)x，=px-+px-2+.+px-+8-0-1-2e-2-...-8e-q
（15-6)
以上两种模型的形式均可简记为ARIMA（p，d，q），P、d、q分别为时间序列的
自回归、差分和移动平均阶数。特别地，当d-O，q=O，ARIMA（p，0，0）=AR（p），
即为p阶自回归模型；当d=0，p=0，ARIMA（0，0，q）=MA（q），即为q阶滑
动平均模型；当d=O时，ARIMA（p，O，q）=ARIMA（p，q），即为自回归滑
动平均模型。
注意，在ARIMA模型中，由AR（p）和MA（q）结构可知，这两个模型均
是经过中心化变换的模型。所谓中心化变换实际上就是非中心化的序列平移一
个常数位移，以非中心化的AR（p）模型为例介绍中心化变换。非中心化的AR
（p）模型结构为：
x=+x-+x2+...+x-n+
（15-7)
令，μ=1-9-…一
，y=x-μ，则{vy}为{x}的中心化序列。SPSS20.0输
出的截距项为口、因此确定最终模型的口径时（如果截距项有统计学意义），需
要进行一次变换，即=μ（1一@）。
ARIMA方法依据的基本思想是：将预测对象随时间推移而形成的数据视为
一组依赖于时间的随机变量，这组随机变量所具有的自相关性表征了预测对象
发展的延续性，一旦这种自相关性被相应的数学模型描述出来，就可以从时间
序列的过去值和现在值预测未来的值。它是用变量自身的滞后项以及随机误差
项来解释该变量。
运用ARIMA方法进行预测的前提条件是：作为预测对象的时间序列经过差
分后可以转化为一平稳时间序列。根据限制条件的严格程度，平稳时间序列分
推移而发生变化时，该序列称为严平稳序列。当序列只要保证其低阶矩（二阶）
平稳，就认为该序列宽平稳。直观地说，平稳时间序列的折线图无明显的上升
或下降趋势。但是，实际中大多数现象随着时间的推移，总表现出某种上升或
264兽医统计学
下降趋势，构成非平稳的时间序列。因此，应用ARIMA模型进行预测前，通常
需要对时间序列先进行差分平稳化处理，成为ARMA模型。ARIMA模型实质上
是差分运算与ARMA模型的组合。
二、ARIMA模型的自相关分析
ARIMA方法是以时间序列的自相关分析为基础的，以便识别时间序列的模
式，实现建模和完成预测的任务。自相关分析就是对时间序列求其本期与不同
滞后期的一系列自相关系数和偏自相关系数，据此识别时间序列的特性。
1.自相关系数。对于时间序列{x}，{x}是其滞后1期数据形成的序列，
{x2}是其滞后2期数据形成的序列，{x}是其滞后k期数据形成的序列。时间
序列相差k个时期两项数据序列之间的依赖程度或相关程度可用自相关系数r
（autocorrelationcoefficient）表示。自相关系数r与相关分析中的相关系数一样，
取值范围在-1到1之间，r的绝对值与1越接近，说明时间序列的自相关程度越高。
自相关系数可提供时间序列及其模式构成的重要信息。对于纯随机序列，即一
个由随机数字构成的时间序列，其各阶的自相关系数将接近于零或等于零。而
具有明显的上升或下降趋势的时间序列或具有强烈季节变动或循环变动性质的
时间序列，将会有高度的自相关。这种信息的有用之处在于：对现有的时间序
列数据及其模式无需有任何了解，就能得到其自相关系数。这些系数可以用来
揭示所研究的时间序列数据的特性，并能帮助选定一个合适的模型。
2.偏自相关系数。在多元回归中，通过计算偏自相关系数以便了解在有
多个因素时两个变量之间的联系。在时间序列中，偏自相关是时间序列x在给
定了{x}，{x2}，{xx-}的条件下，{x}与滞后k期时间序列之间的条件相关。它
用来度量当其他滞后1，2，3，，k-1期时间序列的作用已知的条件下，{x与
{x之间的相关程度。这种相关程度可用偏自相关系数中u（partialautocorrelation
coeficient）来度量。在ARIMA中偏自相关系数用来配合自相关系数，共同辨认
适当的ARIMA预测模型。在自回归模型的识别中，可以用偏自相关系数来初步
判定模型的阶数；在滑动平均模型中，可以用自相关系数来识别滑动平均模型。
第十五章时间序列分析
265
3.自相关分析图。将时间序列的自相关系数和偏自相关系数绘制成
图，并标出一定的置信区间，这种图称为自相关分析图，包括自相关函数
（autocorrelationfunction，ACF）图和偏自相关函数（partialautocorrelation
function，PACF）图，详见图15-4。ARIMA方法中的自相关分析主要是利用自
相关分析图来完成的。利用自相关分析图可以分析时间序列的随机性、平稳性
和季节性。时间序列的随机性，是指时间序列各项之间没有相关关系的特性。
测定时间序列的随机性，就是判定这个时间序列是否为纯随机序列。
ACF
PACF
ARIMA（0,0,1),0>0
1
0
ACF
PACF
ARIMA（1,0.0).Φ>0
0
0
(b)
ACF
PACF
ARIMA（1,0,1)，Φ<0，0>0”
图15-4几种常见ARIMA模型自相关分析标准图
266兽医统计学
三、ARIMA模型的建模步骤
ARIMA建模过程主要包括以下步骤：
（1）序列平稳性检验。平稳性检验有图检验法、自相关函数和偏自相关函数
检验法、特征根检验法、参数检验法、逆序检验法等。图检验法主要通过序列图
（或散点图）确定序列是否是平稳的。根据平稳时间序列均数、方差为常数的性
质，平稳序列的序列图应该显示出该序列始终在一个常数值附近随机波动，而且
波动的范围有界、无明显趋势及周期特征。其余检验方法请参考相关专著。
（2）差分运算。若序列为非平稳序列，则需要进行差分运算使其平稳。差
分运算的实质是使用自回归的方式提取序列中的确定性信息。理论上讲足够多
的差分运算可以充分提取序列中的非平稳确定性信息。但在实际中，不宜过度
差分，因为每次差分都有信息的损失。差分方式的选择主要有以下情形：①只
要序列蕴含着显著的线性趋势，一阶差分就可以实现趋势平稳。②序列蕴含着
曲线趋势，通常低阶（二阶或三阶）差分就可以提取出曲线趋势的影响。③对
于蕴含看固定周期的序列进行步长为周期长度的差分运算，通常可以较好地提
取周期信息。
（3）模型识别。ARIMA分析中关键的一步，但也带有一定的主观性。即必
须确定ARIMA（p，d，q）过程中的三个整数p，d和q。根据Box-Jenkins提出
的方法，用样本的自相关系数和偏自相关系数的截尾性（可以通过ACF和PACF
图判断）来初步识别ARMA模型的阶数。若平稳序列{x的自相关系数r呈g阶
截尾，而偏自相关系数拖尾，则识别{x为MA（q）模型；若r拖尾，而k
呈p阶截尾，则识别{x为AR（p）模型；若r和均拖尾，则判断{x为ARMA
（p，9）模型。例如图15-4的（a）图部分，为标准的自相关系数1阶截尾，偏自
相关系数拖尾，所以判断为MA（1）；类似地，（b）图部分为AR（1），（c）图
部分为ARMA（1，1）。
（4）参数估计与检验。根据以上模型识别的结果给出p，d和g的初始值后，
SPSS20.0软件ARIMA程序能够估计模型的参数，获得拟合值、预测值、误差
第十五章时间序列分析267
（残差）及置信限，并给出参数检验的结果。
（5）模型诊断。常用的模型诊断包括参数是否有统计学意义，残差序列是
否为白噪声序列。白噪声检验常用的检验方法是Box-LjungQ统计量，详细检
验方法请参考相关专著。SPSS20.0会输出Box-LjungQ统计量的检验结果，若
P<0.05，则说明序列为非白噪声序列（原假设序列为白噪声序列）。如果参数有
统计学意义，且残差序列为白噪声序列，可认为模型达到了较好的效果。
（3）～（5）为ARIMA建模的关键步骤，往往需要反复进行，逐渐完善以选
择最优模型。在模型参数有统计学意义的前提下，最优模型的选择一般遵循以
下原则：参数简约化原则，即模型使用的参数越少越好：拟合优度统计量BIC
（Bayesianinformationcriterion）或AIC（Akaikeinformationcriterion）最小准则，
即BIC或AIC越小越好
（6）最后可以根据模型的结构和参数估计的结果确定模型的数学表达式，
从而实现预测。一般来说，ARIMA模型只适宜作短期预测。
【例15-1】
某省2009一2014年5月猪丹毒病的每月发病数资料见表15-3，请对该省
猪丹毒病的月发病数采用ARIMA模型进行预测分析。
表15-3某省2009-2014年5月猪丹毒病的月发病数
年份
月份
发病数
年份
月份
发病数
2009
1
255
2009
9
475
2009
2
138
2009
10
466
2009
3
252
2009
4
210
2014
1
242
2009
5
234
2014
2
103
2009
6
294
2014
3
168
2009
7
439
2014
4
137
2009
8
359
2014
5
203
注：资料来源于农业部《兽医公报》2009—2014年5月的月报数据。
268兽医统计学
在本例中，为了说明ARIMA模型预测的效果，将数据分为两部分，
2009—2013年的数据用来建立ARIMA模型，2014年1~5月的数据用来作外
样本效果验证。
首先，绘制2009一2013年月发病数的序列图（图15-5）。然后按照上述
步骤分析如下：
800-
600-
发病数
00
例
200
图15-5某省2009一2013年猪丹毒月发病数序列图
（1）序列平稳性检验。在用ARIMA模型进行拟合前，应先检查序列图
是否是平稳的，详见图15-5。图15-5表明，序列的均数大约在250的位置上
下波动，极个别值在600以上，并且无明显趋势及周期特征。因此没有必要
进行差分运算，d=0。
（2）模型识别。首选绘制序列ACF和PACF的图形，详见图15-6、图
15-7。除了相关函数，ACF和PACF图显示了95%的置信限。PACF图1阶截
尾，ACF图2阶截尾但不典型，即自相关系数并未在2阶后迅速衰减到0值附
近。因此分别尝试拟合ARIMA（1，0，2）、ARIMA（1，0，0）、ARIMA（0，
0，2），即ARMA（1，2）、AR（1）、MA（2）。
第十五章时间序列分析
269
相关系数
1.0
可信区间上限
可信区间下限
0.5
0.0
-0.5
1.0
12345678910111213141516
延迟阶数
图15-6自相关函数
相关系数
1.0-
可信区间上限
可信区间下限
0.5-
CF
0.0
P
-0.5-
1.0-
12345678910111213141516
延迟阶数
图15-7偏自相关函数
（3）参数估计与检验。表15-4给出了三个模型参数估计及检验的结果。
可以发现，除模型ARMA（1，2）中有部分参数无统计学意义外，模型AR
（1）和MA（2）的参数均有统计学意义。
270
兽医统计学
表15-4
三个模型参数估计及检验结果
模型
待估参数
参数值
标准误
统计量
P值
ARMA（1,
截距
251.256
47.371
5.304
<0.001
2）
AR1
0.582
0.206
2.825
0.007
MA1
-0.263
0.232
-1.134
0.261
MA2
-0.151
0.191
-0.792
0.432
AR(1)
截距
248.048
53.905
4.602
<0.001
AR1
0.744
0.088
8.433
<0.001
MA(2)
截距
255.324
32.971
7.744
<0.001
MA1
-0.802
0.118
-6.773
<0.001
MA2
-0.461
0.120
-3.844
<0.001
（4）模型诊断。由于模型ARMA（1，2）中有部分参数无统计学意义，
因此仅列出模型AR（1）和MA（2）残差序列白噪声检验的结果，见表
15-5。可以发现，两个模型的残差均为白噪声序列（自相关系数延迟1~6
阶，P值均大于0.05）。SPSS20.0默认输出自相关系数延迟18阶的检验结果，
在这里为了简化，只列出了1～6阶的结果。
另外，模型AR（1）和MA（2）对应的BIC分别为9.565和9.684。因此，
无论依照参数简约化原则还是BIC最小的原则，模型AR（1）均优于MA
（2）。如果这两个原则出现相反的情形，可以根据实际情况综合判断。
表15-5两个模型残差序列白噪声检验的结果
Box-Ljung检验结果
模型
延迟阶数
自相关系数
标准误
统计量
自由度
P值
AR
1
0.140
0.126
1.233
1
0.267
(1)
2
0.063
0.125
1.485
2
0.476
3
-0.051
0.124
1.655
3
0.647
4
-0.086
0.123
2.151
4
0.708
第十五章时间序列分析
271
（续）
Box-Ljung检验结果
模型
延迟阶数
自相关系数
标准误
统计量
自由度
P值
AR
5
-0.221
0.122
5.454
5
0.363
(1)
6
-0.210
0.120
8.487
6
0.205
MA
1
0.094
0.126
0.553
0.457
（2)
2
0.152
0.125
2.036
2
0.361
3
0.201
0.124
4.662
3
0.198
4
-0.047
0.123
4.809
4
0.307
5
-0.090
0.122
5.360
5
0.374
6
-0.121
0.120
6.361
6
0.384
（5）预测。根据模型的结构AR（1）和参数估计的结果，确定模型的
口径如下（注意模型中包含截距项u）：
x=+x-+8,=μx（1-）+x+c,=63.500+0.744x+8
利用建立的模型该省2014年1~5月猪丹毒病进行预测（SPSS可输出预
测值、置信区间等），结果见表15-6。预测的平均绝对误差（meanabsolute
error，MAE）为46.6，平均绝对百分误差（meanabsolutepercentageerror，
MAPE）为27.3%
MAE：
MAPE
x和x分别为时间点t时的实
n
X,
际值和预测值，n是预测的期数。
表15-6某省2014年1-5月猪丹毒病月发病数AR（1）模型预测结果
月份
实测值
预测值
95%CI下限
95%CI上限
1
242
108
-115
331
2
103
144
-134
422
3
168
171
134
475
4
137
190
-128
509
5
203
205
-120
531
272兽医统计学
以上例子只是ARIMA模型最简单的形式（甚至不能称之为通常意义上
的ARIMA模型，因为没有差分运算），此外ARIMA模型还有疏系数模型，
季节模型，带输入变量的ARIMA模型（动态回归模型，ARIMAX）等，有
兴趣的读者可以了解相关专著。
第十六章
抽样调查
274兽医统计学
【例16-1】
某县级动物疫病预防控制中心计划了解辖区某村家禽散养户的平均养
殖数量和家禽存栏总量，已知全村共有750户养殖家禽，如何进行科学高效
的调查？
【例16-2】
为了解猪口蹄疫疫苗接种的有效率，某县计划对全县养猪量300头以上
的养殖场进行调查统计，检验产生抗体的猪的比例是否达到不低于70%的
标准。已知该县养猪量大于300头的养殖场共有46个，各养殖场存栏量介于
300～5000头之间，存栏总量为50000头。怎样确定调查的样本量和抽取样
本，进行进一步的调查分析？
【例16-3】
某养猪大县动物疫病预防控制中心为了解全县猪瘟感染情况，需要对
全县范围的养猪场进行调查和监测。该县生猪养殖总量比较大，存在多种
不同规模的养猪场，构成较复杂，如何进行调查能科学高效地达到研究
目的？
【例16-4】
某山区县动物疫病预防控制中心计划了解该县散养生猪猪瘟流行情况，
该县有500个自然村，散养生猪约80000头，由于各村散养户地理分布较分
散且山区村落交通较为不便，如何进行科学高效的调查分析？
【例16-5】
某市计划对全市的猪瘟流行情况进行调查，该市共有10个县，各县养
猪量介于10万头到57万头之间，初步计划选取5个县来进行进一步的调查分
析，如何较科学地选取这5个县？
第十六章抽样调查275
上述案例是实际工作中很可能碰到的情况，由于需要调查研究的总量
很大以及研究经费和时间等的限制，不可能也没必要对每个研究对象都实
施调查，这时通常选用抽样调查的方法来获取需要的信息，进而评估总体
特征，达到研究的目的，本章将介绍如何进行抽样调查。
第一节抽样调查概述
一、抽样调查的概念
survey）两种。普查就是对研究总体中的每个个体都进行调查研究，其得到的
结果真实完整。但由于研究总体的规模通常都很大，进行普查需要耗费巨大的
人力、物力和财力，有些总体甚至是无限总体，而且有些调查分析具有破坏性，
因此很多研究很难或无法进行普查，只能进行抽样调查。
抽样调查是从总体中抽取一部分单元组成样本，通过对所抽取的样本进行
调查研究来推断总体特征。抽样调查具有节药成本、时效性强和所得数据质量
高的优点，在调查研究中被广泛使用。抽样调查的主要缺点是存在抽样误差和
调查结果不能反映总体的全部情况。抽样调查主要适用于一些流行病、寄生虫
病、慢性传染病和非传染性病及一些病因未明疫病等的调查，不太适用于疫情
暴发、病程短的疫病和发病率非常低的疾病（如肿瘤、罕见性中毒等）调查。
二、抽样调查的步骤
抽样调查的过程就是一个解决问题的过程，其具体步骤一般为：
276兽医统计学
1.明确调查目的
调查目的是调查的出发点，调查工作要围绕这个核心展开。从统计的角度
看，调查研究一般的目的分两种：一是了解相关参数，如调查研究家禽出栏体
重，家畜寄生虫患病率等；二是研究指标或变量间的关系，从而探索其内在关
联，如调查研究猪INHA基因多态性与猪产存数量的相关性分析。
2.确定调查总体和调查指标
为了实现调查目标，需要明确调查对象的范围和界限，确定调查的总体。
养禽场主必须明确自己想调查的是哪些家禽，是某一栏舍，还是全部家禽。这
样既可以防正偏差，又能提高调查效率。在抽样调查实施之前，需要严格考虑
某个体是否属于总体。在实际调查中，即使有总体和样本清单，也仍有必要使
用过滤性问题识别合格的调查对象。
调查目的是选定调查指标的依据，而调查指标是调查目的的具体体现，通
过对指标的分析来达到调查的目的。调查指标的确定一般遵循代表性、客观性
和可行性的原则。
3.制定抽样框
确定总体后，需要编制总体单元清单一抽样框（samplingframe）。抽样
总体必须要先体现成为抽样框，然后根据抽样框在总体中进行抽样。因此，编
制一个好的抽样框是抽样调查的前提和基础。
为了能够等概率地从总体中抽取出个体，同时兼顾抽样的便利性，通常会
将总体划分成互不重叠的儿个部分，每个部分称为抽样单元。例如，需要调查
全县生猪高致病性猪蓝耳病感染状况，可以将养猪场/户作为抽样单元。包含所
有抽样单元的清单就称为抽样框。兽医领域抽样调查中常见的抽样框有养殖场
户名册、家畜耳标号和屠宰场名录等。如果没有现成的抽样框，调查人员需要
自己来编制。使用现成的抽样框时，需要对抽样框的信息进行检查、核对，避
免重复、遗漏等情况的发生，以提高样本对总体的代表性。
4.选择抽样方法
根据不同的研究目的、研究经费、时间限制和问题性质等，选择不同的抽
样方法，这将在后续小节里详细讲解。
第十六章抽样调查277
5.确定样本量
抽样方法确定后，就要计算样本量。从理论上来讲，抽取的样本量越大，
对总体的估计就越准确。但是样本量的大小直接关系着调查成本和费用，样本
量越大，调查所需的时间、人力、物力等也越多。样本量的确定需要综合考虑
估计精度和客观约束条件。
6.制订抽样计划
明确上述问题后，就需要制订详细的抽样计划。抽样计划内容包括调查目的、
任务、精度要求、经费预算、抽样方法、计量方法及标准等，抽样计划必须详细、
清晰。在抽样调查实施之前，需要先进行预调查抽样或对抽样计划进行讨论研究。
7.调查实施
调查的实施阶段也就是取得样本数据的过程。为确保调查质量、保障原始
数据准确，应事先进行调查员培训，并制定各种质量控制措施。
8.数据整理和分析
抽样调查实施完成后，需要对原始数据进行整理、编码、录入。分析数据
前，要按一定规则检验、处理原始数据中存在的异常数据。
数据分析的目的就是回答最初调查目的中提出的问题。研究人员通过对样
本数据的分析估计总体特征值，如总值、均数、比例和相关性等。此外，抽样
误差估计也是必不可少的步骤，应对数据质量进行评估，以便判断数据有效性。
数据质量评估包括调查方法描述、误差来源和度量指标。最后根据数据分析结
果撰写调查报告。
第二节抽样方法
根据抽取样本的方式，可将抽样调查划分为概率抽样（probabilitysampling）
和非概率抽样（non-probabilitysampling）。概率抽样也称为随机抽样，是指根
278兽医统计学
据随机的原则，按照某种事先设计的程序，从总体中抽取部分单元的抽样方
法。常用的概率抽样有简单随机抽样、系统抽样、分层随机抽样和整群抽样
等；非概率抽样是相对于概率抽样而言的，其特点是选取样本时有很大的主观
性和随意性。常用的非概率抽样主要有判断抽样、偶遇抽样、定额抽样和雪球
抽样等。
一、概率抽样
概率抽样也称为随机抽样，是指根据随机的原则，按照某种事先设计的程
序，从总体中抽取部分单元的抽样方法。概率抽样由于抽样过程是随机的，因
此抽取的样本代表性强，在实际的调查抽样中应用最多。
1.简单随机抽样
简单随机抽样也叫单纯随机抽样（simplerandomsampling），是一种保证
总体中每一个个体都有同样的机会被抽出来的抽样方法。具体实施方法是将
调查总体的全部观察对象进行编号，得到抽样框，然后在抽样框中随机抽取
部分观察对象组成样本。简单随机抽样由于需要包含每个研究对象信息的完
整的抽样框，因此一般适用于研究总体数目较小的情况，或者已经有现成抽
样框的情况。
简单随机抽样分为放回抽样与不放回抽样两种方式。放回抽样也称重复抽
样，就是每次从总体中抽取的样本，经过研究后仍把它放回总体中，继续参加
抽样。不放回抽样也称不重复抽样，是指已被抽中的样本不再放回总体，而是
在未被抽中的总体单元中继续进行抽样。不放回抽样没有信息重复，提供的信
息量更多，抽样效率更高。
确定样本量之后，简单随机抽样需要获取一组相应的随机数字，然后据此
通过抽样框抽取所需的样本。如需要抽查30头猪来反映某养猪场猪寄生虫感染
情况，则需要获取30个随机数字，然后根据这30个随机数字从抽样框中找到相
应的猪的编号和信息，进而对相应的猪进行寄生虫检测和分析。常用的获取随
机数的方法有以下几种：
第十六章抽样调查279
（1）随机数表。随机数表（本章附录1）是常用的取随机数的方法，使用
时首先将总体单元编上号码（从1到N），根据N的位数确定从表上应该抽取几位
数，即V是几位数就抽取几位数字；然后确定取随机数的起点，从任意列（行）
开始，横向（纵向）依次取数，遇到属于总体编号范围内的就选取为样本，若
遇到超出编号范围或抽取过的数字，就放弃，直到抽取预定的n个样本为止。例
如，假定需要在养殖量为65的养猪场抽取5头进行检测。这时，N=65，n=5，
需要在表上取两位数。然后，任意选一个起点，抽取不大于65的两位数，抽中
的数字大于65，则不予采纳，继续抽取，遇到重复号码也同样舍弃，直至抽满5
个样本单元为止。
（2）随机数骰子。随机数骰子是一个正二十面体，一套随机数骰子通常由
一个兼做容器和摇具的盒子、一个保护骰子不受损伤的泡沫塑料垫和若干个不
同颜色的般子组成。一个般子一次产生一个0～9的随机数，要产生一个m位数
的随机数，需要同时使用m个般子。
（3）电脑软件。当拥有数据库或电子表格形式的抽样框时，使用统计软件
（4）随机数获取网站。在网址http://www.randomizer.org可以免费获取随机
数（网上相关资源很多，有兴趣的读者可以自行查找，这个网站是其中一个）。
简单随机抽样的优点是简单直观易操作，缺点是当研究的总体较多时，很
难对每个个体进行编号，而且抽到的样本可能会比较分散，不方使进一步的调
查研究。
2.系统抽样
系统抽样（systematicsampling）又称机械抽样，是对研究的个体按某种顺
序编号后，随机抽取一个号码作为第一个调查个体，然后根据某种规则顺次抽
取其余样本。最简单和常用的系统抽样为等距抽样，其步骤为：①将总体中的
全部个体进行排序；②根据需要的样本量大小，计算出抽样间隔；③从随机
选出的一个个体开始，按顺序每隔一个抽样间隔，抽取相应个体进入研究样本。
例如在对屠宰场的动物进行检验检疫时，由于是生产线作业，经常采用系统抽
样的方法采集样本。
280兽医统计学
在系统抽样前如何排序总体内各个单元与系统抽样结果有密切关系，通常
有两种排列总体单元的排序方式：
（1）无序排列。根据研究总体名单上自然位置进行排列，总体内各单元的
排序完全是随机的。如养殖户按照村委会户口册上顺序自然排列、或按姓氏排
名等。无序排列方式利于工作，因为不仅可以直接利用现成的名册，还可以直
接用简单随机抽样的方法计算和估计样本数据：
（2）有序排列。有序排列是指利用已知信息，按研究变量或研究变量相关
指标的大小顺序排列总体单元。例如，对疫病感染情况的抽样调查中，可以将
养殖场按前几年的感染率由低至高顺序排序。这种按有关指标排列总体单元的
系统抽样也称有序系统抽样。
系统抽样方法可以使特征值高低不同的个体都选人样本，因而抽样误差比
较小。但是，对于有序系统抽样，其抽样方差的估计是有偏倚的，这也是系统
抽样无法避免的缺点。实际工作中，运用系统抽样方法，若无特别要求，可不
对总体单元进行有序排列。
期性变动的数据会造成很大的误差。虽然可以在抽样过程中采取种种方法避免
抽样间隔与个体特征变动的周期性相耦合，但在实际工作中，当怀疑某种现象
有周期性变动趋势时，为确保抽样准确性，不宜采用系统抽样。
如调查某地最大羊屠宰场羊肉寄生虫感染情况，由于屠宰羊是生产线作业，
可选用系统抽样的方法：确定抽样间隔后，随机从一只羊开始，每隔一个抽样
间隔选取一只羊，直到达到所需的样本总量，然后对选取的羊进行寄生虫检测。
3.分层抽样
分层抽样（stratifedsampling）又称分类抽样或类型抽样，是先按对主要研
究指标影响较大的某种特征将总体分为若干个类别（即统计上讲的“层”），再
从每一类别内随机抽取一定数量的个体组成样本。例如，在口蹄疫感染情况调
查中，可将调查对象按畜种分类，分为猪、牛、骆驼、绵羊、山羊等，分别实
施调查。
分层随机抽样通过分层增加了同一层内样本的同质性，使各层的抽样误差
第十六章抽样调查281
减小。在样本量相同的情况下，分层抽样的标准误一般小于单纯随机抽样、系
统抽样和整群抽样；各层可根据调查对象的特征采取相同或不同的抽样方法；
统计分析内容更丰富，可以对不同层进行独立分析，也可以比较不同层间的
差异。
（1）分层依据。如果分层合理，分层抽样能够提高精度。常用的分层标准
有以下几个：
①按行政区划分层，为了抽样实施方便，可按行政管理机构设置进行分
层。例如，以县级界为标准分层。
②按调查对象类型分层，使得层内差异小而层间差异大。例如，按不同畜
种、禽种分层。
③按个体标志值进行分层，有的调查对象没有自然属性或行政类别，可以
用标志值作为分层标准。例如，以养殖规模和养殖数量为标准进行分层。
（2）层数的确定。理论上说，层数越多抽样精度就越高。然而层数超过到
一定程度后，抽样误差的增加值会消耗掉精度的提高值，与工作量和花费相比
得不偿失。根据已有理论，层数不宜大于6层。实际抽样工作中，是否需要将层
次再细分，可参考两个标准：一是层间是否有比较大的差异；二是是否需要特
别了解该层情况。
4.整群抽样
整群抽样（clustersampling）是先将总体分成若干群，然后从中随机抽取几
个群，被抽中群内的全部个体组成调查的样本。应用整群抽样时，要求群内各
单位差异大，群间差异小。这种方法便于组织、节约人力、物力，多用于大规
模调查。缺点是当不同群之间的差异较大时抽样误差大。
整群抽样中群的分法大致有两种：一是根据行政、地域以及自然形成的群
体划分，如按县、乡（镇）或村等划分；二是由调查人员根据需要确定。此时
需保证群和群之间的差异尽量小、群内差异尽量大。
5.多阶段抽样
前边讲述的四种抽样方法都是一次抽样产生一个完整的样本，称为单阶段
抽样（singlestage sampling）。在实际调查中，面临的总体有时很庞大，情况复
282兽医统计学
杂，需要观察的单位很多，而且分布面广，往往不能通过一次抽样产生完整的
样本，而是根据实际情况将整个抽样过程分为若干阶段来进行，称为多阶段抽
样（multistagesampling）。在不同阶段，可采用相同或不同的抽样方法。例如，
对全国羊寄生虫感染情况进行调查，就可采取五阶段抽样。全国为总体，全国
抽省，省抽县，县抽乡镇，乡镇抽村，村抽养殖户，再从养殖户中抽取羊作为
样本进行检测。其中，省为初级单元，县为二级单元，乡镇为三级单元，自然
村为四级单元，养殖户为五级单元。
与简单随机抽样相比，多阶段抽样抽到的个体相对集中，因而更加省时省
力和节省费用。与整群抽样相比，在样本量相同的条件下，多阶段抽样的样本
在总体中分布更加均匀，因此较整群抽样更有代表性。多阶段抽样的缺点主要
有两个：一是抽样阶段较多时，误差会增大，因为每一级抽样都会带来误差；
二是抽样要分多阶段实施，在运用样本数据估计总体特征值时，需要综合各级
抽样结果，比较复杂。
6.PPS抽样
（1）不等概率抽样。前面涉及的许多抽样方法中，具体抽取单元时，一般
采用简单随机抽样，总体中每个单元被抽出的概率相同，这种抽样称为等概率
抽样。但在实际工作中，总体中的单元在重要程度、代表性等方面可能会有明
显的差异，比如某些县是该省的重点养殖大县，而有些县的养殖量很小。在这
种情况下，勉强采取等概率抽样就有些不切实际。对此，人们提出了不等概率
抽样法：按照某一尺度，将不同单元匹配以不同的抽样概率，使重要的、代表
性大的单元以较大的概率被抽取，不太重要或代表性较差的单元以较小的概率
被抽取，这样得到的样本的代表性可能更好，能更加准确地反映总体信息。
（2）PPS抽样。不等概率抽样中，不同单元在重要程度、代表性方面的差
异往往体现在它们所包含的子单元的数量上。按初级单元容量（所含二级单元
的数量）在总体中所占的比例来分配各初级单元被抽中的概率，所占比例越高，
被抽中的概率越大，这种不等概率抽样方法称为与容量成比例的概率抽样，简
称比例概率抽样，常记为PPS抽样（probabilityproportionatetosizesampling）。
研究证明，PPS抽样是抽样效率最高的不等概率抽样。
第十六章抽样调查283
二、非概率抽样
非概率抽样主要是依据研究者的意愿、判断或方便程度等条件来抽取调
查对象，它不考虑随机抽样中的等概率原则，往往产生较大的抽样误差（而
且无法估计误差），难以保证样本的代表性，因此在大规模的正式调查研究中
一般很少用非概率抽样，常常是在探索性研究或在研究的初期采用。对于总
体无法确知的一些调查，只能采用非概率抽样。有时，组织较好的非概率抽
样也能起到预期的作用。如果调查者能够准确把握调查对象的实际情况，也
能通过非概率抽样抽出代表性很高的样本，获得较高的抽样效率。例如，研
究人员清楚了解本地散养禽畜对于某种疫病的易感性、养殖密度和养殖场/户
生物安全措施等情况，那么在疫病易发季节，就可以有针对性地实施调查，
并采取风险预防措施。这样，无需大规模抽样就能初步掌握疫病情况，简便
快捷，灵活方便。
1.立意抽样（purposivesampling）
又称目的抽样或判断抽样，是一种凭研究人员主观意愿、经验和知识，从
总体中选择具有典型代表性个体构成调查样本的一种非概率抽样方法。重点调
查和典型调查就属于判断抽样。例如，动物疫病防控人员为了初步判断是否有
疫情出现，选取几个疫病多发的养殖户进行调查。
2.偶遇抽样（accidentalsampling）
又称为便利抽样或自然抽样，指调查者根据实际情况使用对自己最为便利
的方式来选取样本。例如，在对家禽进行抽样检测时，调查人员经常会抓最近
的、最易抓到的家禽，这种抽样方式就是典型的便利抽样。这种遇上哪个就选
哪个的抽样方法往往被有些人误认为是随机抽样。其实不然，因为不能保证总
体中的每个个体都有同等机会被遇上。
3.滚雪球抽样（snowballsampling）
仅称链式抽样、网络抽样和连带抽样等，是指研究人们不了解或者很难找
到研究对象时，以一些个体为“种子”样本，然后以滚雪球的方式，获取更多
284兽医统计学
样本的抽样方法。例如，发现疫情时，调查员首先访问几个发病场/户，然后让
他们提出曾经接触过染病禽畜的其他养殖户、屠宰场以及市场，如此逐步扩大
样本，找到其他染病禽畜。
4.定额抽样（quotasampling）
又称配额抽样，研究者首先根据那些可能影响研究指标的各种因素对总体
进行分层，并确定各层样本占总体的比例，再在各层中抽取样本。因此，配额
抽样可看成是分层抽样的延伸，但它不是在层中随机抽样。配额抽样中选哪些
个体做调查，由调查员来决定，因此其样本代表性存在一定问题，选择性偏倚
较大，调查员可能会去调查那些容易找到的对象。配额抽样分类的步骤与分层
抽样的相同之处在于：都是将研究对象按某些特征，如畜种、饲养方式、行政
区等，分为几类，然后再实施进一步的抽样。不同之处在于：配额抽样抽取层
内样本时运用主观判断，而分层抽样采用随机抽样。
第三节样本量估算
样本量的大小会直接影响抽样估计结果，一般来说，样本量越大，误差就
越小，成本越高。实际工作中，样本量的确定就是在多种约束条件下的折中过
程。本节以简单随机抽样为例介绍抽样调查中样本量估算的一般方法和步骤，
对于分层抽样和整群抽样等别的抽样方法，其样本量的估算以简单随机抽样为
基础，根据层数和群数等的不同分别有更复杂的估算方法，有兴趣的读者可以
查阅相关专著。
一、确定样本量的步骤
在简单随机抽样的实际工作中，样本量的确定可以按以下步骤实施：
第十六章抽样调查285
1.计算费用
明确调查、实验室检测等所需费用，并考虑现有人力、物力等资源，估算
抽样调查可能的最大样本量；
2.确定抽样调查的精度
包括误差限和置信度。置信度1一a确定后，查表即可知z的取值；
3.估计总体方差。2
总体方差常常是未知的，需要进行估计。有5种方法可以估计总体方差：
（1）利用以前的调查结果和经验；
（2）进行预调查，计算样本方差，然后对总体方差进行估计；
（3）运用相似或有关二手数据的结果；
（4）利用某些理论上的结论（例如，进行总体比例估计时常取o=0.25）；
（5）请富有经验的专家进行判断，如可请教上一级单位中有抽样经验的工
作人员。
4.计算初始样本量
运用相关公式，计算理论初始样本量。
5.估算所需样本量
根据经验或预调查情况，获知有效回答率，并根据有效回答率对样本容量
进行调整，初步确定实际所需的样本量：
实际样本量=初始样本量/预计有效回答率
6.最终确定实际抽样样本量
除上述步骤外，还必须权衡费用、时间、可动用各种资源的限制。样本量
的确定应坚持保守主义原则，就是尽量大一些，以便保有余地，在发生特殊情
况、无法达到原有样本量时，还能保证抽样的精度。
二、样本量简易查表法
实际调查中，可使用查表的方法快速估算简单随机抽样的样本量。
286兽医统计学
1.估计总体平均数时的样本量查表法
查表法采取放回抽样的样本量计算公式，估计总体平均数时，计算方法
如下：
其中，n为样本量，△是绝对误差限，a是检验水准α下的双侧Z值，o是总体标
准差。
虽然实际工作中往往采用不放回抽样，但在一定精度要求下，放回抽样
的样本量计算公式所计算出的样本量比不放回抽样大，所以并不影响抽样精
度。样本容量表（本章附录2）中，左边列为o/△的整数值，上面行为o/△的
小数值。因此确定了置信度1一α、误差限△和总体标准差。，就能查表得知抽
样所需样本量。
例如，要了解某养禽场的平均出栏体重，要求最大误差不超过0.5干克，即
A=0.5千克，置信度为95%（即α=0.05）。据以往调查，总体标准差o=3千克。
则，o/△=3/0.5=6，α-0.05，在本章附录2中查表可得所需样本量n=141，因此需
抽取141羽家禽样本。
2.估计总体比例值时的样本量查表法
估计总体比例时，查表法同样是采取放回抽样的样本量计算公式：
za2P(1-P)
n=
#
其中，P是总体比例估计值，在流行病学调查中，一般指的是疫病的总体阳性
感染率，可参考以往的调查结果，或进行预调查获取。如果没有以往的调查数
据，可直接令P=0.5，此时计算出样本量是最大的，可以得出样本量的最保守估
计值。
可以根据不同的置信度要求（a值），查表得出样本量，表（本章附录3）中
左边第一列为误差限△的取值，上边第一行为总体比例P的取值，对照即可知相
应样本量。
第十六章抽样调查
287
例如，拟了解某县鸡新城疫的染病率，要求最大误差不超过3%，即
△=3%，置信度为95%（即α=0.05），该县没有以往有关该病感染率数据。从便
利角度出发，取总体比例P=0.5对样本量进行保守估计。则α=0.05，4=3%，
P=0.5，查表得知所需样本量n=1067，因此需在该县抽取1067只鸡作为
样本。
3.发现抽样
发现抽样的目的是确定一个地区是否存在感染，只要检测到一例感染动物，
就可以证明这个地区存在感染。为方便工作，表16-1列出了不同感染率情况下
所需的抽样数量（置信水平95%）。
表16-1发现抽样样本量估算表
感染率
动物数
0.1%
1%
2%
5%
10%
20%
10
10
10
10
10
10
8
50
50
50
48
35
22
12
100
100
96
78
45
25
13
500
500
225
129
56
28
14
1000
950
258
138
57
29
14
10000
2588
294
148
59
29
14
>10000
2995
299
149
59
29
14
例如，某生猪饲养大县为确定是否猪瘟无疫开展调查，县里生猪存栏约100
万头。根据近期监测数据，动物感染率为5%。如果采用随机抽样，根据查表结
果，应该抽取59头作为抽样样本。
三、运用免费软件进行样本量计算
样本量计算的软件也很多，WinEpiscope和SurveyToolbox是较常用的软件，
读者可以自行搜索下载和使用。
288兽医统计学
第四节案例分析和示范
一、案例分析
【例16-1】
该村有750个农户乔殖家禽，总规模不算很大，而且因为都是散养户，
各家的存栏数差异也不大，因此可选用简单随机抽样的方法。首先，将全
村750个养禽户从1~750进行编号，组成抽样框。然后估算样本量，由于不
知道750个农户间养殖家禽的差异情况，抽取5户进行预调查，得知他们养
殖家禽的存栏数分别为20、11、8、10和3羽，得到其平均数为10.4羽，方差
为38.3，从而估算总体方差为38.3。设定误差△=2（羽），α取0.05，0=38.3，
则o/△~3.094，查本章附录2，左边第一列取整数3，上边第一行取小数0，
对应的样本量为38，然后根据随机数表或通过网站、统计软件等获取38个
随机数，通过抽样框得到这38个随机数对应的农户，然后对这些农户养殖
家禽的情况进行调查分析，从而推断全村的家禽养殖情况。
【例16-2】
该县有46个需要研究的养猪场，数量不是很多，可以实现每个都抽取
样本进行调查研究。设定预估的猪口蹄疫疫苗接种的有效率为70%，即p为
70%，α取0.05，误差率设为不超过3%，即△=3%。采用查表法（本章附录
3），左边第一列取A为0.03，上边第一行取P值为0.3（有效率为0.7即无效率为
0.3，运用此表时这两个P值对应的样本量一样），对应的样本量为896头。然
后可根据各养殖场生猪存栏量确定该场的抽取样本数，如存栏量为500头，则
需要抽取896×（500/50000）=8.96头，取整数为9头，然后采用简单随机抽
第十六章抽样调查289
样的方法，从该养殖场随机抽取9头猪进行免疫有效情况调查。在实际调查
过程中，每个养猪场可以根据实际情况选取适当的方法进行采样，如有的养
殖场很难对每头猪进行编号组成抽样框，则可以采用系统抽样的方法选出样
本。对于存栏量大的养殖场，如存栏量为5000头，其需要抽取的样本为896×
（5000/50000）=89.6头，取整数为90头，样本数较多，该养殖场还可以考虑采
用分层抽样的方法，如对猪分性别或年龄进行抽样。当然，根据调查需要，
也可以对每个养殖场都分猪的性别或年龄等进行抽样。最后，综合46个养殖
场的情况，评估该县300头以上养猪场口蹄疫免疫接种有效率情况。
【例16-3】
该县城生猪养殖总量较大，不同养猪场和养猪户的养殖规模大小不一，
适合进行分类调查分析，因此可考虑采用分层抽样的方法。首先获取各类养
殖场的规模和存栏量等信息，然后根据实际情况，将相似度大的调查单元分
在一起，使层内变异小而层间变异大。此案例根据实际情况最终划分为5层，
分别为存栏量1～9头划分为散养户层；10~99头为养殖专业户层；100~2999
头为小型养殖场层；3000～9999为中型养殖场层；存栏量大于等于10000头划
分为规范化养殖场层。根据实际工作经费的情况，计划检测500头生猪。由于
不知道各层猪瘟发病率的总体方差，所以采用比例分配的方法分配各层样本
量。该地区规范化养殖场、中型养殖场、小型养殖场、专业户和散养户的存
栏量占总存栏量的比例分别为7%、7%、34%、24%和28%，因此得到这几层
的样本数量分别为35、35、170、120和140。得到各层的样本量后，采用简单
随机抽样的方法，在各层内选取一个或多个养殖场进行进一步抽样。
【例16-4】
该县散养户地理分布分散且地形较复杂、交通不方便，该县动物疫病
预防控制中心对散养户的数量和每户存栏情况也不掌握，很难对每头生猪
290兽医统计学
编制完整的抽样框。因此，本案例可考虑采用整群抽样的方法。首先对该
县的500个自然村从1～500进行编号，组建抽样框。根据研究经费情况暂定
抽取3个自然村进行调查，则采用简单随机抽样的方法从500个自然村中抽
取3个自然村，然后对抽取的自然村的全部散养生猪进行调查。
【例16-5】
因为各县生猪养殖量并不相同且有较大差异，说明在抽样调查时各县
的代表性并不相同，不宜采取简单随机抽样使每个县被抽中的概率相同，
此时可考虑采用比例概率抽样，即PPS抽样的方法。首先，将10个县进行编
号，确认各县的生猪养殖量，并进行累计，标出各县所包含的范围，养殖
量越大的县，包含的范围越大，因此被抽中的概率越高，这种抽样的方法
也称列表累计法。已知该市生猪养殖总量为232万头，利用随机数表，从1
到232中随机抽取5个数字，如抽到的为025，044，229，103和157，则根据
表16-2，得到抽取的县编号为2，3，5，8和10，因此暂定抽取这5个县作为
抽样调查的初级样本，对这5个县的猪瘟流行情况进行进一步的调查。
表16-2某省列表累计抽样
县编号
养殖量X（万头）
X累计值
各县范围
抽中的随机数字抽中的县编号
1
11
11
1 ~ 11
2
17
28
12~28
025
2
3
23
51
29~51
044
3
4
10
61
52~61
5
44
105
62~105
103
5
6
18
123
106~123
7
25
148
124~148
8
57
205
149~205
157
9
12
217
206~217
10
15
232
218~232
229
10
合计
232
第十六章抽样调查291
二、案例
此案例以问卷调查和抽样调查相结合的方式，向读者示范抽样调查在实际
调查研究中的应用。
1.调查目的
为了解某省农村居民狂犬病KABP（知识、态度、信念和行为）水平及其与狂犬
病发病率之间的关系，探索提高农村居民狂犬病防治知识水平的策略，实施该调查。
2.调查对象和方法
对该省12岁以上农村居民进行抽样问卷调查，根据资金和人力等情况发放
问卷2000份，回收有效问卷1902份。调查问卷中设置了个人基本信息、媒介使
用情况和狂犬病KABP信息3部分内容。见表16-3。
表16-3狂犬病防治知识问卷调查表概览
狂犬病防治知识问卷
问卷编号：
★第一部分：基本信息
1.您的性别是？
（1）男
（2）女
2.您今年多少岁了？
（1）小于15
（2）15~30
（3）31~46
（4）46以上
3.您的文化程度（以您取得的最高文凭为准）？
（1）小学及以下
（2）初中
（3）高中/中专/中技
（4）大专及以上
★第二部分：媒介使用情况
1.您平时接触的大众传播媒介是（多选）
（1）报纸
（2）电视
（3）广播
（4）网络
（5）手机
（6）书籍
（7）杂志
（8）音像制品
（9）其他
2.您平时一周有几天看过电视？（如果平时不看，不做这一题）
292兽医统计学
3.一周时间内，您每天收看电视的时间大约有多长？（如果平时不看，不做这一题）
（1）0.5小时以内（2）0.5~1小时
（3）1~2小时
（4）2~3小时
（5）3小时以上
............
★第三部分：疯狗病KABP情况
1.疯狗病是传染病吗？
（1）是
（2）否
（3）不知道
2.您觉得疯狗病可以治好吗？
（1）治不好
（2）可以治好
（3）根据犯病程度而定
（4）不清楚
3.哪些动物会得疯狗病？
（1）蛇
（2）鸡鸭等家禽
（3）狗猫等宠物、人和野生动物
（4）不清楚
.............
非常感谢您的配合和支持！
3.抽样方法
采用多阶段抽样的方法，综合运用分层抽样、PPS抽样和简单随机抽样的
方法抽取相应的县、乡（镇）、村和农户。根据该省各市农业人口规模分配其调
查的户数；根据不同市区各县狂犬病发病数将其分成高、中和低3个层次，每层
随机抽取1个县作为调查县；对于抽中的县，对其辖区的乡（镇）进行编号，确
认各乡（镇）的狂犬病发病人数，并进行累计，标出各乡（镇）所包含的范围，
狂犬病发病人数越多的乡（镇），包含的范围越大，因此被抽中的概率越高，采
用PPS抽样的方法抽取2个乡（镇）；每个乡（镇）再采用PPS抽样的方法抽取2
个村；最后在抽取的村运用简单随机抽样的方法获取调查农户。
这次调查中，首先采用分层抽样的方法抽取调查县，这么做有助于抽取出
不同狂犬病发病情况的县便于比较分析：运用PPS抽样的方法抽取乡镇和村，
有助于抽取出狂犬病发病人数较多的乡镇和村，以使进行进一步研究；在抽中
的村中，采用简单随机抽样的方法便于调查的实施和保障抽取样本的代表性
4.研究内容
调查研究内容包括5个方面：一是掌握农村居民关于狂犬病KABP的基本情
况；二是分析农村居民狂犬病防治知识掌握情况与狂犬病发病率之间的关系；
第十六章抽样调查293
三是探索人口统计相关因素对KABP的影响；四是研究农村居民媒介接触使用
情况与KABP之间的关系：五是提出针对农村居民狂犬病防治知识传播的策略。
附录1
随机数表
行
(1)
(2）
(3)
(4)
(5)
(6)
(7)
(8)
(9)
（10)
(11)
（12）
列
32044
69037
29655
92114
81034
40582
01584
77184
85762
46505
53633
15371
2
23821
96070
82592
81642
08971
07441
09037
81530
56195
98425
21533
64827
3
82383
94987
66441
28677
95961
78346
37916
09416
42438
48432
16744
59182
4
68310
21792
71635
86089
38157
95620
96718
79554
50209
17705
29755
02090
5
94856
76940
22165
01414
01413
37231
05509
37489
56459
52983
96409
59779
6
95000
61958
83430
98250
70030
05436
74814
45978
09277
13827
52953
71540
7
20764
64638
11359
32556
89822
02713
81293
52970
25080
33555
90262
31720
8
71401
17964
50940
95753
34905
93566
36318
79530
51105
26952
54105
48221
9
38464
75707
16750
61371
01523
69205
32122
03436
14489
02086
67582
66521
10
59442
59247
74955
82835
98378
83513
47870
20795
01352
89906
19305
26904
11
11818
40951
99279
32222
75433
27937
46214
48872
26536
41042
40596
25017
12
66785
6837
96483
00230
58220
09756
00533
17614
98144
82427
62138
69210
13
05933
69834
57402
35168
54138
44850
11527
05692
84810
44109
55109
39017
14
31722
97334
77178
70361
15819
35037
46319
21085
37957
05102
93335
66817
15
95118
88373
26934
42991
00142
90852
14199
93593
76028
23664
47180
76234
16
14347
69760
76397
91159
85189
84766
88814
90023
62928
14789
53471
00822
17
64447
95461
95772
84261
82306
90347
97519
03144
16530
52542
21857
19942
18
82291
62993
93884
69165
14135
25283
35685
47029
62941
37099
72881
03865
19
45631
73570
53937
02803
60044
85567
10497
26882
50000
47039
04120
19431
20
59594
78376
47900
30057
94668
04629
10087
13562
13800
15764
91658
66838
21
72010
44720
92746
82059
42361
54456
66699
77103
47491
65161
86859
71560
22
35419
04632
07000
25529
72128
90404
05118
34453
42189
82994
18450
69697
23
71750
86044
76982
81606
93646
00776
06017
10638
08818
94242
65467
43308
24
84739
48460
08613
88344
27585
44997
58464
68682
56828
78191
53879
64035
25
38929
79307
78252
14446
21545
34737
48625
61374
32181
17834
22256
27132
26
67690
88918
06316
08110
24591
38729
53296
64295
87158
64938
62955
91406
27
64601
76493
91280
23056
21242
26983
34203
40045
82157
65050
41256
26715
28
72065
44093
88240
17510
73412
88774
96914
05702
17130
20916
58746
11631
29
90225
74930
08500
64177
13202
15085
15734
57555
63812
57696
22222
10157
3028621
0599760429260546563227972429328109049530359188037222246
294
兽医统计学
附录2
估计总体平均数时所需样本量（左边列为o/△的整数值，上面行为o/△的小
数值）
a=0.05
o/△
.0
.1
.2
.3
.4
.5
.6
.7
.8
.9
1
7
8
9
9
11
12
13
14
15
17
2
19
20
22
23
25
27
29
31
33
35
3
38
40
42
45
47
50
53
56
58
61
4
64
68
71
74
77
81
84
88
91
95
5
99
103
107
111
115
119
123
128
132
137
6
141
146
151
156
160
165
170
176
181
186
7
191
196
202
207
213
219
225
231
237
243
8
249
255
261
268
274
281
288
294
301
308
9
315
322
329
336
343
351
358
366
373
381
10
389
396
404
412
420
428
437
445
453
462
11
470
478
487
496
505
514
523
532
541
550
12
559
569
578
588
597
607
617
626
636
646
13
656
667
677
687
697
708
718
729
740
750
14
761
772
783
794
805
816
828
839
851
862
15
874
885
897
909
921
933
945
957
969
982
16
994
1006
1019
1032
1044
1057
1070
1083
1096
6011
17
1122
1135
1149
1162
1175
1189
1203
1216
1230
1244
18
1258
1272
1286
1300
1311
1329
1343
1358
1372
1387
19
1402
1416
1431
1446
1461
1476
1491
1507
1522
1537
20
1553
1568
1583
1600
1616
1631
1647
1663
1680
1696
估计总体平均数时所需样本量（左边列为o/△的整数值，上面行为o/△的小
数值）
α=0.01
o/△
.0
.1
.2
.3
.4
.5
.6
.7
.8
.9
1
11
12
14
15
17
19
21
23
26
28
2
31
34
36
39
43
46
49
53
56
60
3
64
68
72
77
81
86
90
95
100
105
4
110
116
121
127
133
139
145
151
157
164
5
170
177
184
191
198
205
213
220
228
235
6
243
251
260
268
277
285
294
303
312
321
7
331
340
350
360
370
380
390
400
411
421
8
432
443
454
465
476
487
499
511
522
534
第十六章
抽样调查
295
（续）
0/△
.0
.1
.2
.3
.4
.5
.6
.7
.8
.9
9
546
559
571
583
596
609
622
635
648
661
10
674
688
702
715
729
743
758
772
787
801
11
816
831
846
861
876
892
907
923
939
955
12
971
987
1004
1020
1037
1054
1070
1087
1105
1122
13
1139
1157
1175
1193
1211
1229
1247
1265
1284
1303
14
1321
1340
1359
1379
1398
1417
1437
1457
1477
1497
15
1517
1537
1558
1578
1599
1620
1641
1662
1683
1704
16
1726
1747
1769
1791
1813
1835
1858
1880
1903
1925
17
1948
1971
1994
2017
2041
2064
2088
2112
2136
2160
18
2184
2208
2232
2257
2282
2307
2332
2357
2382
2408
19
2433
2459
2485
2551
2537
2563
2589
2616
2643
2669
20
2696
2723
2750
2778
2805
2833
2860
2888
2916
2943
附录3
估计总体比例时所需样本量
α=0.05
0.50
0.45
0.40
0.35
0.30
0.25
0.20
0.15
0.10
0.05
△
0.200
24
24
23
22
20
18
15
0.180
30
29
28
27
25
22
19
0.160
38
37
36
34
32
28
24
0.140
49
49
47
45
41
37
31
25
0.120
67
66
64
61
56
50
43
34
0.100
96
95
92
87
81
72
61
49
0.090
119
117
114
108
100
89
76
60
43
0.080
150
149
144
137
126
113
96
77
54
0.070
196
194
188
178
165
147
125
100
71
0.060
267
264
256
243
224
200
171
136
96
0.050
384
380
369
350
323
288
246
196
138
73
0.045
474
470
455
432
398
356
304
242
171
90
0.040
600
594
576
546
504
450
384
306
216
114
0.035
784
776
753
713
659
588
502
400
282
149
0.030
1067
1056
1024
971
896
800
683
544
384
203
0.025
1537
1521
1475
1398
1291
1152
983
784
553
292
0.020
2401
2377
2305
2185
2017
1801
1537
1225
864
450
0.015
4268
4226
4098
3884
3585
3201
2732
2177
1537
811
0.010
9604
9508
9220
8740
8067
7203
6147
4898
3457
1825
0.005
38416
38032
36879
34959
32269
28812
24586
19592
13830
7299
296
兽医统计学
估计总体比例时所需样本量
α=0.01
P
0.50
0.45
0.40
0.35
0.30
0.25
0.20
0.15
0.10
0.05
△
0.200
41
41
40
38
35
31
27
0.180
51
51
49
47
43
38
33
0.160
65
65
62
59
54
49
41
0.140
85
85
81
77
71
63
54
43
0.120
115
114
105
97
86
74
59
0.100
166
164
159
151
139
124
106
85
0.090
205
203
197
186
172
154
131
104
74
0.080
259
257
249
236
218
194
166
132
93
0.070
339
335
325
308
284
254
217
173
122
0.060
461
456
442
419
387
346
295
235
166
0.050
664
657
637
604
557
498
425
338
239
125
0.045
819
811
786
746
688
614
524
418
295
156
0.040
1037
1026
995
944
871
778
664
529
373
197
0.035
1354
1341
1300
1232
1138
1016
867
691
488
257
0.030
1843
1825
1770
1677
1548
1382
1180
940
664
350
0.025
2654
2628
2548
2415
2230
1991
1699
1354
956
504
0.020
4147
4106
3981
3774
3484
3111
2654
2115
1493
788
0.015
7373
7299
7078
6710
6193
5530
4719
3760
2654
1401
0.010
16589
16424
15926
15096
13935
12442
10617
8461
5972
3152
0.005
66358
65694
63703
60386
55740
49768
42469
33842
23889
12608
第十七章
研究设计
298兽医统计学
【例17-1】
欲在广西隆林县进行不同的传播方式干预对狂犬病风险公众狂犬病相
关知识、态度、信念和行为（KABP）影响效果的研究。
【问题17-1】
试作出该研究的研究设计。
【分析】
要了解不同传播方式对狂犬病风险公众狂犬病KABP影响的效果，属于
实验性研究设计，要在当地进行不同的传播方式干预。详细步骤参见本章
最后的研究实例。
第一节观察性研究设计
观察性研究分为描述性研究和分析性研究两类。描述性研究主要是对动物
群的疫病或健康状态在动物群间、时间和空间的分布（三间分布）和强度进行
描述，应用最多的方法是横断面研究。分析性研究的目的是探索疫病发生和传
播的各种风险因素，估计风险大小，并提出可能的干预措施。分析性研究常用
的方法有病例对照研究和队列研究。
一、调查设计的基本步骤
调查设计是对调查研究所作的周密计划，它包括资料的收集、整理和分析
全过程的统计设计和合理安排。调查设计的要点是要将调查研究目的转化为拟
第十七章研究设计299
分析的指标，再将分析指标转化为调查项目，并制定调查表进行资料的收集、
整理和分析。
1.明确调查目的与类型。各种调查的具体目的不同，应根据研究所期望
解决的问题，明确该次调查所要达到的目的，然后根据具体研究目的来确定采
用何种调查方式。如是为了了解某疫病在动物群间分布情况，则应采用横断面
研究。另外，按对象划分，观察性研究可分为全面普查、抽样调查和典型调查。
全面普查是对总体中所有的观察单位进行调查。抽样调查是从总体中选取一定
数量具有代表性的观察单位组成样本，然后用样本的信息来推断总体特征。典
型调查是有目的的选择典型的观察单位进行调查。
2.确定研究对象。确定合适的研究对象是顺利开展研究的关键环节。应根
据研究目的对调查对象的分布特征、地域范围以及时间点有明确的规定。在设
计时，可以将研究对象规定为某个区域内的全部动物或其中的一部分动物，也
可以为某一时点上的调运动物，如某年某月某日的免疫动物。
3.确定样本量和抽样方法。在抽样设计中，必须考虑样本量。样本量过
少，所得指标不稳定，用于推断总体的精度差，检验效能低；样本量过多，不
但造成浪费，也给调查的质量控制带来困难。
观察性研究中估计总体参数所需样本量所需的参数：
（1）置信度1一α。置信度值越大，置信区间估计的可靠性越好，但所需的
样本量越大。一般取α=0.05。
（2）总体的标准差o。总体标准差越大，相应所需的样本量越大，一般从以
前的研究资料或预调查中获得。
（3）容许误差8。容许误差是预计样本统计量与相应总体参数的最大相差控
制在什么范围。
用上面三个条件求得的样本量的意义是：当样本量为n时，用统计量来估
计总体参数，二者之差不超过o的可能性是1一α。不同的抽样方式，估计样本量
的方法各异。在相同样本量条件下，各种抽样方法的抽样误差一般是：整群抽
样误差≥单纯随机抽样误差≥系统抽样误差≥分层抽样误差。抽样方法详见第
十六章。
300兽医统计学
4.资料的收集。资料的收集方式主要有两种：一是通过测定或检查的方式。
如测量禽流感抗体是否阳性。另一种方法为用问卷的方式调查。这种方法用得比
较普遍。询问与调查动物群有关系人员，获取所要得到的信息。所有参与检验或
者检测人员以及调查员都须经过培训，以统一调查和检测标准，避免偏倚的产生。
5.资料的整理和分析。调查收到的资料必须经过整理和分析，应首先仔
细检查原始资料完整性和逻辑性。完整性检查是对调查表的所有项目进行检查，
核对填写是否有缺项。逻辑核查主要检查调查内容逻辑上的矛盾，如检查日期
与发病日期的矛盾。而后进行数据的编码与录入以及数据的分析工作。
二、横断面研究
横断面研究（cross-sectionalstudy）也称为患病率调查（prevalencestudy），
是一种在医学领域中常见的观察性研究方法。在某动物群中应用普查或抽样调
查方法收集特定时间内动物群中有关疫病与健康状况的资料，以描述疫病或健
康状况在地区、时间和动物群中的分布规律以及观察某些因素与疫病之间的关
联。横断面研究也是其他分析流行病学研究的基础。
【例17-2】
为了了解羊群布病感染情况，对该地存栏的10万只羊进行血清学检测，
以获取该地羊群感染率。请讨论：
（1）该调查属于什么研究类型，其调查设计有无问题？
（2）你认为要达到同样目的应怎么样设计？
【讨论】
该调查欲了解当时某地羊群布鲁氏菌病的感染情况，属于横断面研究。
由于需要的人力、物力太过巨大，对该地所有羊只进行血清学检测是不现
实的，因此可以采用抽样调查方法。
第十七章研究设计301
研究设计应该包括：①明确调查目的和类型：本地调查的目的为了解
该地羊群布病的感染情况，研究类型应为横断面研究。由于该地羊只数量
过多，采取普查是不现实的，因此用抽样调查的方式进行调查。②确定研
究对象：研究欲了解该地羊群情况，那么，调查对象应局限于该地的羊只。
③确定样本量和抽样方法：样本量估计就是在保证调查结果具有一定可靠
性的前提下，确定最少的样本例数。关于样本量的估计详见第十六章。抽
样方式采取随机抽样。（4资料的收集：本次调查资料收集方式应采用测定
方式，对羊群进行血清学确诊。5资料的整理和分析：由于本次欲了解感
染情况，最后资料应使用描述性分析方式呈现出羊群的布鲁氏菌病感染率。
在横断面研究中可能存在系统误差和随机误差，影响研究结果的可靠
性。在设计和实施中均要注意控制措施。常见的偏倚如下：
1.选择偏倚。包括选择性偏倚、无应答偏倚和幸存者偏倚，原因是研
究对象的选择不当而造成的偏倚。
2.信息偏倚。包括调查对象偏倚、调查者偏倚和测量偏倚，产生的原
因是收集信息的方法存在缺陷而造成的误差。
三、病例对照研究
病例对照研究是选择一组患某病的病畜（病例组），再选择一组不患该病的
对象（对照组），比较两组畜群之间在疫病发生之前有关可疑因素（危险因素）
的暴露情况，如果两组的暴露率确有差别，则可认为所研究疫病与因素之间存
在着关联。病例对照研究资料可按表17-1格式整理。
表17一1病例对照研究资料整理表
有暴露或特征
无暴露或特征
合计
病例组
a
b
a+b=n
对照组
C
d
c+d=no
合计
a+c=m
b+d=m
a+b+c+d=n
302兽医统计学
比较aln与c/no，如果有统计学意义，可认为此病与暴露的因素有关联（但
不一定是因果关系）
病例对照研究设计有以下特点：
（1）病例对照研究是一种回顾性调查研究。研究者不能主动控制病例组和
对照组对危险因素的暴露有无和暴露多少，因为暴露与否已是既成事实。
（2）病例对照研究是一种从“果”到“因”的调查。在研究疫病与暴露因
素的先后关系时，是先有结果，即已知研究对象患某病或未患某病，再追溯其
可能有关的原因。其调查方向是逆向的、从果到因的、回顾性的。
（3）病例对照研究设有对照组。对照组由未患所研究疫病的畜禽组成，与
病例组作对比分析。
【例17-3】
在对1998年江苏省猪链球菌感染性综合征流行因素研究中，根据链球
菌感染性综合征的诊断标准，选择临床症状典型，诊断依据可靠的链球菌
中毒休克综合征和链球菌脑膜炎型综合征病例作为研究病例。对每例病人，
选择同村、性别相同、年龄相差不超过5岁的健康人2名，且同时选择同村
或同乡、性别相同、年龄相差不超过10岁的屠宰场员工2人以上作为对照，
开展1：M配对调查。调查采用问卷调查，调查发病前1周对于猪的接触情
况，对病例调查直接询问本人，对于死亡病例则询问熟悉其情况的家属。
数据的分析采用logistic回归。
病例对照研究中常见偏倚为：
（1）选择偏倚。选择偏倚（selectionbias）是由于研究对象与非研究对
象间的特征有系统差别或选入的对象与未选入的对象之间，出现了某些特
征的系统差别而产生的误差。选择性偏倚包括Berkson偏倚、McNeyman偏
倚、无应答偏倚等。选择偏倚常发生于研究的设计阶段。
（2）信息偏倚。信息偏倚（informationbias）指在收集资料阶段调查暴
露史时两组标准不一或有缺陷以至两组结果不一所引起的偏倚。例如调查
第十七章研究设计303
者在询问时的诱导，被调查者在应答时的心理状态及记忆能力等均可导致
信息偏倚。信息偏倚主要发生在研究的实施阶段。
（3）混杂偏倚。混杂偏倚（confoundingbias）是当研究暴露因素与疫病
之间关系的时候，由于其他因素与所产生的效应干扰着欲研究的危险因素
与其所产生的效应，从而歪曲了这个研究的危险因素对疫病的影响，我们
把这些影响称为混杂偏倚，而那些其他因素则称为混杂因素。
四、队列研究
队列研究（cohortstudy）亦称为前瞻性研究（prospectivestudy），是一种
与临床试验非常相似的观察性研究方法，能够解决有关罕见暴露与数据收集的
时序方面的问题，并能够有效地判断风险因素与结局的关联，因此主要应用子
检验疫病的病因假设。在队列研究中，调查者可以确定群组（队列）和初始特
征（暴露状态），研究队列中可能包含或没有所关心的研究结局，研究者在一
定时期内随访队列并确定暴露和非暴露组的结局，特别重要的是队列研究中明
确有关风险因素（暴露）的信息先于疫病结局的观察，也就是说队列研究并不
知道结局阳性史，但知道队列人群处于结局的风险，即在基线或研究开始时确
定暴露，然后随访暴露和非暴露组并记录结局的发生情况，可能的结局指标包
括疫病发病、死亡、健康状况以及某些生物学参数变化，因此队列研究体现从
因到果的思路。队列研究是将特定动物群分为暴露于某因素与非暴露于某因素
的两种动物群或不同暴露水平的几个亚群，追踪观察其各自的结局，比较两组
或各组某结局的发生率，从而判定暴露因素与结局有无因果关联及关联程度
大小的一种观察性研究方法。所谓队列（cohort）是指具有共同经历、共同暴
露于某一因素或共同具有某一特征的一群动物。相同出生队列的动物可能暴
露于类似的环境与社会变化，这种在特别队列中的成员影响被称为队列效应
(cohorteffect)。
304兽医统计学
研究队列可分为固定队列和动态队列。固定队列指某特定事件发生时的所
有动物组成的队列；动态队列是指随时有可能增加或减少成员的观察畜禽。根
据研究目的和对象的不同，队列研究又分为前瞻性队列研究、回顾性队列研究
和双向性队列研究。前瞻性队列研究（prospectivecohortstudy）中，开始观察
的时间为现在的一个时间点，观察到将来研究对象的变化情况。回顾性队列研
究（retrospectivecohortstudy）中，开始观察的时间为过去的一个时间点，观察
这个时间点到现在这段时间中研究对象的变化情况，也称为历史性队列研究。
双向性队列研究（ambispectivecohortstudy）中，开始观察的时间为过去的一个
时间点，观察这个时间点到现在、再到将来的时间段研究对象的变化情况。
1.队列研究有以下基本特点：
（1）观察性研究。队列研究中的暴露不是人为给予或随机分配的，而是在
研究之前已客观存在的。
（2）设有对照组。为了更好地确定研究因素的作用，队列研究需要设立对
照组来进行比较。对照组可与暴露组来自同一动物群，也可以来自不同的动
物群。
（3）由“因”及“果”。在队列研究中，研究对象在升始研究时（疫病发生
之前）就确定了是否暴露于研究的因素，而后追踪观察疫病发生的情况，即先
确知因，再前瞻的观察果。
（4）能验证暴露与结局的因果联系通过队列研究可以获得研究对象的暴露
状况及结局事件的发生情况，所以能根据收集的数据估计所研究结局事件的发
生率，估计暴露人群发生某结局事件的危险程度。先因后果时间顺序清晰，因
而能对因果相互作用的关系作出推断。
2.在队列研究中疫病与暴露相关的指标：
（1）相对危险度。队列研究中描述暴露危险因素与疫病关联的指标之一是
相对危险度（relativerisk，RR），设暴露队列的发病率为P，非暴露队列的发病
率为P，相对危险度按下式计算：
RR=P
Po
(17-1)
第十七章研究设计305
相对危险度表示暴露于某危险因素的动物群中，发病风险是非暴露动物
群发病风险的多少倍，它反映了危险因素对疫病发生风险的作用程度。相对
危险度越大，表明危险因素致病作用越强，与疫病发生关系越密切。相对危
险度主要具有流行病学和病因学方面的意义，说明暴露因素与疫病发生的病
因关联。
（2）归因危险度。队列研究中描述暴露因素与疫病关联的另一指标是归因
危险度（attributablerisk，AR），归因危险度的计算公式为：
AR=P-P
（17-2）
归因危险度表示暴露于某危险因素的动物群中，发病风险与非暴露动物群
发病风险相比较的绝对差值，反映暴露危险因素造成发病增加的绝对量。或者
说动物群中有多少发病率可以归因于该暴露危险因素。
【例17-4】
以丹麦奶牛患子宫炎的风险因素为例，对奶牛在哺乳期内的前30天发
生子宫炎的影响因素进行队列研究。暴露于影响因素的队列构成暴露队列。
其余的为非暴露队列。再分别计算暴露队列和非暴露队列的发病率。研究
对象包含了丹麦3个地区的3366个动物群的113290头奶牛。
队列研究如同其他研究方法一样也会有各种偏倚，但在队列研究中最
值得注意的偏性是“失访”。失访是指在追踪观察的某一阶段，某些对象由
于种种原因脱离了观察，观察者无法再了解到他们的结局情况。队列研究
由于观察动物数较多，追踪观察时间较长，因此失访是很难避免的。观察
动物数越多，时间越长，失访越容易发生。
为了减少失访，应尽量选择比较稳定的动物群作为研究对象，当失访
率大于5%时，对失访可能产生的偏性影响则需作进一步的分析。对于截
尾数据可利用生存分析方法进行统计分析。观察性研究设计的区别见表
17-2。
306兽医统计学
表17-2观察性研究设计的比较
研究类型
横断面研究
病例对照研究
队列研究
描述性
分析性
分析性
单点观察，同时收集
基线确定暴露，前瞻确
观察的次数
单点观察
暴露与疫病史资料
定结局
暴露方向
不知道暴露与疫病的
回顾性收集
基线收集暴露信息，前
信息
先后
暴露信息
瞻收集结局信息
抽样调查数据
暴露和结局的原始数
数据来源/
病畜的原始数据，第二
第二手数据（全国调
据，某些设计用第二手
收集方法
手数据（医院登记记录）
查）
数据
观察单位
个体
个体
个体
危险度测量患病估计
RR
允许直接确定危险，比
通常比前瞻性研究样本
其他观察性设计提供更
能在短时间内完成，
小，快速，易操作，花
优点
强的暴露与疫病联系的
花费少
费少，费用适当，有利
证据，有利于研究罕见
于罕见病研究
暴露
不应该用于研究疫病
不能确定暴露与疫病的
研究费时，难度大，存
病因，不用于低频率
因果联系，不能直接估
不足
在选择偏倚，难以用于
疫病研究，暴露与疫
计危险，不能用于罕见
罕见疫病
病暂时不能确定
暴露，存在回忆偏倚
描述特殊疫病的发病
与死亡，提出假设，
传染病暴发调查，病因
研究慢性疫病的病因，
应用
计划干预，描述卫生
未明慢性病调查，假设
危险度估计，假设检验
问题的分布与严重性，
检验
帮助规划卫生服务
第十七章研究设计307
第二节实验研究设计
实验研究是指研究者根据研究目的人为地对实验单位设置十预措施，按照
对照、重复、随机化的基本原则控制非干预措施的影响，通过对实验结果的分
析，评价干预措施的效果。例如，研究3种抗癌药物对小白鼠肉瘤抑瘤效果的实
验，研究者将15只染有肉瘤小白鼠按体重大小配成5个区组，每个区组内3只小
白鼠随机接受3种抗癌药物，以肉瘤的重量为指标，通过分析比较3组小白鼠肉
瘤的重量来评价3种抗癌药物对小白鼠肉瘤抑瘤效果。
实验研究与观察研究的主要区别是：1.研究者能人为设置处理因素；2.实验
单位接受处理因素何种水平是经随机分配的。实验性研究的优点在于能够较好地
控制非处理因素的影响，避免人为造成的偏倚，使比较组间具有更好的均衡性。
一、实验设计基本要素
医学实验包括三个基本组成部分，即实验单位、处理因素和实验效应。例
如观察某抗生素的效果，结核小鼠为受试单位、某抗生素是处理因素，结核病
的疗效是试验效应，这三部分内容构成了实验基本要素，缺一不可。因此任何
一项实验研究在进行设计时，首先应明确这三个要素，再根据它来制订详细的
研究计划。
实验单位（experimentunit）是处理因素作用的客体，是接受处理因素的基
本单位，也称实验对象或受试对象。根据研究目的不同，实验单位或受试单位
可以是人、动物和植物，也可以是某个器官、组织、细胞、亚细胞或血清等生
物材料。根据实验对象或受试对象的不同，实验常分为以下三类：
（1）动物实验（animalexperiment），其实验对象为动物；
（2）临床试验（clinicaltrial），其受试对象通常为得病的人，即患者；
（3）现场试验（fieldtrial），其受试对象通常为自然人群。医学科研一般不
308兽医统计学
允许在人体上直接进行试验，需要先进行动物实验，在确定无害的条件下再应
用于人体。
处理因素（treatment）一般是指研究者根据研究目的施加于实验单位，在
实验中需要观察并阐明其效应的因素。因素在实验中所处的状态称为因素的水
平（level），也称处理。根据处理因素的多少，实验可分为单因素实验和多因素
实验。处理因素只有一个的实验为单因素实验，如在比较4种饲料对小白鼠体重
增加量影响的实验中，处理因素只有饲料这一个因素，它有4个水平；处理因素
不止一个的实验为多因素实验，如上述试验中，如果4种饲料是由脂肪含量和蛋
白含量两个因素复合组成，研究目的是比较4种饲料的脂肪含量高低、蛋白质含
量高低对小鼠体重的影响，此时处理因素有脂肪含量和蛋百质含量2个因素，每
个因素有2个水平。，
实验效应（experimentaleffect）是处理因素作用于实验对象或受试对象
的反应，是研究结果的最终体现，也是实验研究的核心内容。实验效应一般
通过观测指标来表达。如果指标选择不当，未能准确地反映处理因素的作用，
那么获得的研究结果就缺乏科学性，因此选择好观测指标是关系研究成败的
重要环节。对选择指标的基本要求是：指标应具有客观性、特异性、灵敏性
和精确性。
二、实验设计的基本原则
为了使实验能够较好地控制随机误差，避免系统误差，以较少的实验
对象取得较可靠的信息，达到经济高效的目的，实验设计时必须遵循对照
（control）、随机化（randomization）、重复（replication）的统计学基本原则。这
三个基本原则最早由英国统计学家R.A.Fisher提出。
1.对照原则。在确定接受处理因素的实验组时，应同时设立对照组。只有
设立了对照，才能消除非处理因素对实验结果的影响，从而把处理因素的效应
分离出来，这是控制各种已知的非处理因素产生的系统误差的基本措施。常用
的对照形式有：
第十七章研究设计309
（1）空白对照。空白对照（blankcontrol）是对照组不施加干预，即对照
组的处理因素为“空白”。例如，在某种可疑致癌物的动物诱癌实验中，设立
与实验组动物种属、窝别、性别、体重相同或相近的动物空白对照组，以排
除动物本身可能自发肿瘤的影响。空白对照主要用于无损伤、无刺激的实验
研究。
（2）标准对照。标准对照（standardcontrol）是对照组的干预采用现有标准
方法或常规方法。例如，在研究饲料中核黄素缺乏对尿中氨基氮排出量影响的
动物实验中，对照组白鼠以正常饲料喂养，实验组白鼠以核黄素缺乏饲料喂养，
这里的正常饲料组就是标准对照组。
（3）相互对照。相互对照（mutualcontrol）是不专门设立对照组，各实验
组间互为对照。例如，比较几种药物对某种疫病的疗效时，若研究的目的是比
较其疗效差别，可不必另设对照组，各实验组可以互为对照。
（4）潜在对照。潜在对照（potentialcontrol）是不专门设立对照组，而是以
过去的研究结果作为对照，又称历史对照（historicalcontrol）。例如，假若现有
一种药物能治疗狂犬病，那么过去死亡的成干上方的狂犬病患者，就是这种药
物服用者的潜在对照。
2.随机化原则。随机化是指在实验分组时，每个实验对象均有相同的概率
或机会被分配到实验组和对照组。在实际工作中，随机化分组主要通过随机数
（randomnumber）来实现。获得随机数的常用方法有两种：随机数字表（table
ofrandomnumber）和计算机（或计算器）随机数发生器。在实验设计中，常用
的随机化分组方法为：完全随机化和分层随机化。
3.重复原则。重复（replication）是指研究的实验组和对照组应有一定数
量的重复观测，即实验单位要达到一定的数量。重复的意义在于：①）它避免了
把个别情况误认为普遍情况，把偶然性或巧合的现象当成必然的规律，以致将
实验结果错误地推广到群体；②只有在同一实验条件下对同一观测指标进行多
次重复观测，才能根据重复观测结果，估计实验单位的变异情况，描述观测结
果的统计分布规律。
310兽医统计学
三、常用实验设计方法
实验设计按处理因素多少可分为单处理因素设计和多处理因素设计。单处
理因素设计只安排一种处理因素，若不安排任何配伍因素，为完全随机设计；
若安排一种配伍因素，为随机区组设计；若安排两种配伍因素，为拉丁方设计。
多处理因素设计一般安排两种或两种以上处理因素，如析因设计、正交设计、
裂区设计等。实验设计方法的选择取决于处理因素的多少、研究自的和专业要
求等。下面对常用的实验设计方法进行简单介绍。
1.完全随机设计。完全随机设计（completelyrandomizeddesign），又称
简单随机分组设计（simplerandomizeddesign），是采用完全随机化分组方法将
同质的实验单位分配到各处理组，各组分别接受不同的处理。各组样本量可以
相等，称平衡设计（balanceddesign）；也可不等，称非平衡设计（unbalanced
design）。平衡设计时检验效率较高。如将20只绵羊按照随机数字表随机分为2
组，每组10只，则为平衡设计。
完全随机设计的优点是设计简单，易于实施，出现缺失数据（missing
value）时仍可进行统计分析。缺点是小样本时，可能均衡性较差，抽样误差较
大。与随机区组设计相比，效率较低。
2.配对设计。配对设计（paireddesign）是将实验单位按一定条件配成
对子，再将每对中的两个实验单位随机分配到不同处理组。配对的因素为可
能影响实验结果的主要非处理因素。在动物实验中，常将窝别、性别、体重
等作为配对条件；在临床试验中，常将病情轻重、性别、年龄、职业等作为
配对条件。如将18头牛按身材条件大体相近配成9对，并用随机分组将他们分
为甲、乙两组。
配对设计和完全随机设计相比，其优点在于抽样误差较小、实验效率较高、
所需样本量也较小；其缺点在于当配对条件未能严格控制造成配对失败或配对
欠佳时，反而会降低效率。
3.随机区组设计。随机区组设计（randomizedblockdesign）又称随机单位
第十七章研究设计311
组设计或配伍组设计，它实际上是配对设计的扩展，通常是先将实验单位按性
质（如动物的性别、体重，病人的病情、性别、年龄等非处理因素）相同或相
近者组成区组（或称单位组、配伍组），再分别将各区组内的实验单位随机分配
到各处理或对照组。设计时应遵循“单位组间差别越大越好，单位组内差别越
小越好”的原则。如，将15只小鼠分为5个区组接受三种抗癌药物实验，先将小
鼠的体重从轻到重编号，体重相近的3只小白鼠配成一个区组，在每个区组内再
按随机数分为5组。
与完全随机设计相比，随机区组设计的特点是随机分配的次数要重复多次，
每次随机分配都对同一个区组内的实验单位进行，且各个处理组实验单位数量
相同，区组内均衡。
随机区组设计的优点是每个区组内的实验单位有较好的同质性，比完全随
机设计减少了误差，因而更容易发现处理组间的差别，提高了实验效率。缺点
是要求区组内实验单位数与处理数相等，实验结果中若有数据缺失，统计分析
较麻烦。
四、研究实例
不同的信息传播方式，对公众预防疫病的知识、态度和行为存在影响，这
也是开展风险交流的核心任务之一。为探索提升动物卫生信息风险交流效率的
方法，采用“知信行”（知识、态度与行为）调查方法，在广西隆林县，就群众
狂犬病防控知识、态度和行为情况进行了调查实验研究。研究采用讲座和给有
关实验对象（村民）发短信的方式，对实验对象进行狂犬病防治知识的健康教
育，并测试实验效果。
这类研究需要合理设计研究目的，设定有限的研究目的是成功实施研究的
基础。研究目的设定为：了解不同的传播方式干预对狂犬病风险公众狂犬病相
关知识、态度、信念和行为（KABP）影响的效果。
为了实现研究自的，采用实验性研究方法。由于研究资金、人员和时间
等的限制，不能将所有村民列为实验对象，只能随机抽取有限数量的村民。
312兽医统计学
实验中，在两个乡随机抽取400名村民作为研究对象，样本为固定样本。将
这些村民随机分成四组，每组100人。一组是短信传播组，对这100人发送
短信，每十天发送一次，每次三条短信。第二组是讲座传播组，对这组100
人再实施一次狂犬病防治知识的讲座。第三组是短信+讲座组，对这一组的
100名村民既进行短信发送也实施讲座。第四组是对照组，对这组的100名村
民不进行任何额外的知识传播。问卷由被调查者匿名填写，现场发卷，当场
收回。
为了更好地分析不同健康教育方式的效果，将研究按以下步骤实施：
（1）现状调查。在研究方案制定好后，深入现场进行当地信息知识传播现
状调查。在初步了解了当地村民对狂犬病的认识以及当地的信息媒介使用情况
之后，对调查方案进行了修改，以使方案更加符合实际情况。这种调查也属于
对实际情况定性分析的一种方式。
（2）前测。根据调查方案，对选取村名进行基线问卷调查，并进行初步的
定量分析。
（3）给予刺激。采用随机分组的方式，将村名分为实验组和对照组：分别
为讲座培训信息刺激组、短信传播信息刺激组、培训和短信刺激组以及不给予
刺激组。
（4）后测。采用与前测相同的问卷，对400名村民进行再次调查测量，分析
村民在给予信息刺激后狂犬病风险KABP情况。由于设计为固定样本，经人口
统计信息配对，确定最终样本量。
（5）对比分析。应用SPSS对村名在实验前后狂犬病风险KABP情况变化、
实验组与对照组之间的KABP分别进行对比。
问卷调查和资料收集方法：问卷主要调查四项基本内容。一是一般信息，
了解被调查者性别、年龄、文化程度、职业等。二是了解被调查者对狂犬病基
本知识的掌握，三是了解村民对防治狂犬病的态度和行为，四是村民对动物疫
病防控信息来源与需求。
第十七章研究设计
313
1.将四组干预前后的得分进行比较（总分为16分），见表17-3。
表17-3四组干预前后得分比较
组别
内容
F值
P值
短信组
短信+讲座组
讲座组
对照组
干预前
4.92±1.230
4.98±1.312
4.60±1.182
4.67±1.036
1.331
0.265
干预后
9.02±1.783
10.22±2.14
7.08±1.752
5.02±1.255
96.743
<0.001
25.002
35.692
17.156
3.590
P
<0.001
<0.001
<0.001
0.001
2.将四组干预后得分进行两两间比较，结果见表17-4。
表17-4
四组干预后得分组间比较
知识得分
态度得分
行为得分
组别1组别2
均数差标准误
P值
均数差标准误
P值
均数差标准误
P值
短信+
短信组
11.199
0.340
0.001
0.765
0.283
0.007
0.493
0.145
0.001
讲座组
短信+
讲座组3.143
0.337
100'0>
1.500
0.280
<0.001
0.784
0.143
<0.001
讲座组
短信+
对照组5.202
0.327
1000>
2.195
0.271
<0.001
1.268
0.139
<0.001
讲座组
短信组讲座组1.944
0.343
<0.001
0.735
0.285
0.011
0.292
0.146
0.047
短信组对照组4.003
0.333
<0.001
1.430
0.277
<0.001
0.775
0.142
<0.001
讲座组对照组2.059
0.330
1000>
0.695
0.274
0.012
0.484
0.140
0.001
这项研究满足了对照原则、随机化原则和重复性原则。研究过程中，将所
有400名研究对象随机分为了四组，这个研究完全是可以重复的。
第十八章
诊断试验评价与ROC分析
316兽医统计学
【例18-1】
采用聚合酶链反应（PCR）对120份牛血液样品进行牛病毒性腹泻病毒
诊断，29例PCR诊断阳性样本都证实为病毒阳性，88例PCR阴性样本病毒实
际为阴性，1例样本PCR阳性而病毒分离为阴性，2例样本PCR阴性而病毒分
离为阳性。
【问题18-1】
试计算聚合酶链反应的评价诊断试验的常用指标。
【分析】
评价诊断试验的常用指标有正确率、灵敏度、特异度、Youden指数、
阳性似然比、阴性似然比、阳性预测值、阴性预测值、优势比等，具体计
算可参照本章节。
第一节常用的诊断试验评价指标
对于诊断试验（diagnostictest）的评价，首先应知道受试者（人、动物
或影像等）的真实分类情况，即哪些属于对照组（或无病组、正常组等），哪
些属于病例组（或有病组、异常组等）。划分它们的标准就是金标准（Gold
Standard），金标准是绝对准确的试验或者是假设绝对准确的实验，可以诊断所
有被检感染动物。对于按金标准确定的二项分类总体，如病例与对照（分别记
为D，与D），采用需要评价的诊断试验进行检测，其诊断结果分别写成阳性与
阴性（记为T与T_），资料可列成如表18-1所示的四格表形式。表中有4个可能
结果，其中两个是正确的，即病例被诊断为阳性（真阳性）和对照被诊断为阴
第十八章诊断试验评价与ROC分析
317
性（真阴性）；两个是错误的，即病例被诊断为阴性（假阴性，或漏诊）和对照
被诊断为阳性（假阳性，或误诊）。
表18-1诊断资料2×2四格表
金标准（D）
诊断结果（T）
合计
病例（D）
非病例（D_）
阳性（T）
TP（真阳性）
FP（假阳性）
TP+FP
阴性（T）
FN（假阴性）
TN（真阴性）
FN+TN
合计
TP+FN
FP+TN
N
【例18-2】
采用虎红平板凝集试验（RBPT）对长期发热、关节痛的700患者进行
诊断，经证实有520例患有布鲁氏菌病，其余没有。结果见表18-2。试计算
虎红平板凝集试验的几个常用评价指标。
表18-2RBPT诊断试验的结果
布鲁氏菌病
RBPT诊断结果
合计
出现
不出现
阳性
415（TP)
10（FP)
425
阴性
105（FN)
170(TN)
275
合计
520
180
700 (N)
评价诊断试验的常用指标有正确率、灵敏度、特异度、Youden指数、阳性
似然比、阴性似然比、阳性预测值、阴性预测值、优势比等。
318兽医统计学
一、正确率
正确率（Accuracy）是病例正确诊断为阳性，且对照正确诊断为阴性的比
例。正确率的计算公式为：
TP+TN
Acc=
x100%
(18-1)
N
其标准误为：
Accx(1-Acc)
SEAcc=
（18-2)
N
其总体95%置信区间为：
Acc±1.96SEAcc
(18-3)
415+170
本例的正确率Acc=
×100%=0.8357=83.57%，其标准误
700
0.8357(1-0.8357)
SEAcc
=0.0140=1.40%，95%置信区间为0.8357±1.96×
700
0.0140，即（0.8083，0.8632）。
首先，正确率很大程度上依赖于患病率，如患病率为5%，完全无价值地诊
断所有样本为阴性，也可有95%的正确率；其次，正确率没有揭示假阴性和假
阳性错误诊断的频率，相同的正确率可能有十分不同的假阴性和假阳性；最后，
正确率还受诊断國值的限制。因此只用该指标粗略反映诊断试验的诊断效果，
更常用的诊断试验评价指标是灵敏度、特异度等。
二、灵敏度
灵敏度（sensitivity，Sen）是金标准确诊的真实患者，被试验诊断为阳性的
第十八章诊断试验评价与ROC分析319
概率，也称为真阳性率（truepositiverate，TPR），即：
Sen=P(T|D+)=TP/(TP+FN)=TPR
(18-4)
其标准误为：
Senx(1-Sen)
SEsen=
(18-5)
TP+FN
其95%置信区间为：
Sen±1.96SEsen
(18-6)
本例Sen=415/520=0.7981，即真阳性率TPR=0.7981，在出现布鲁氏菌病的患
者中，79.81%被RBPT诊断为阳性；其标准误为SEsem=√0.7981(1-0.7981)/520=
0.0176=1.76%。灵敏度的95%置信区间为0.7981±1.96×0.0176，即（0.7636，
0.8326)。
该指标只与病例组有关，反映了诊断试验检出病例的能力。
三、特异度
特异度（specificity，Spe）是金标准确诊的真实非病例，被试验诊断为阴性
的概率，即：
Spe=P(T_|D)=TN/(FP+TN)
(18-7)
其标准误为：
Spex(1-Spe)
SEspe=
FP+TN
(18-8)
其95%置信区间为：
Spe ± 1.96SE spe
(18-9)
本例Spe=170/180=0.9444，即未出现布鲁氏菌病的非病例中，95%RBPT诊
断为阴性。其标准误为SEspe=√0.9444(1-0.9444)/180=0.0171=1.71%。特异
度的95%置信区间为0.9444±1.96×0.0171，即（0.9110，0.9779）。
320兽医统计学
该指标只与非病例组有关，反映了诊断试验排除非病例的能力。
由公式（18-4）可导出漏诊率β=1-Sen=FN/（TP+FN）；由公式（18-7）可
导出误诊率a=1-Spe=FP/（FP+TN），误诊率也叫假阳性率（FalsePositiveRate，
FPR)。
0.0556，即假阳性率FPR=0.05。灵敏度、特异度、漏诊率、误诊率之间的关系
可用图18-1表示。此图中间的垂线与横轴的交点称为诊断界点（Cut-offPoint），
它是定义诊断试验为阳性与阴性的临界点。
灵敏度与特异度具有不受患病率影响的优点，所以称为固有诊断试验评价
指标。其取值范围均在（0，1）之间，其值越接近于1，说明其诊断准确性越好。
当比较两个诊断试验时，单独使用灵敏度或特异度，可能出现一个诊断试验的
灵敏度高、特异度低，而另一个诊断试验的灵敏度低、特异度高，无法判断哪
一个诊断试验更好。由此，有人提出了将灵敏度和特异度结合的诊断试验评价
指标，如Youden指数、阳性似然比、阴性似然比等。
诊断临界点
非病例组
病例组
特异度
灵敏度
（1-a）
(1-β)
漏诊率β
误诊率α
图18-1灵敏度、特异度、漏诊率、误诊率图示
四、Youden指数
真阳性率与假阳性率之差就是Youden指数（Youden'sindex），即
J=Sen+Spe-1=TPR-FPR
(18-10)
第十八章诊断试验评价与ROC分析321
其标准误为：
SE=√TP×FN/(TP+FN)3+FP×TN/(FP+TN)3
=√Sen(1-Sen)/(TP+FN)+Spe(1-Spe)/(FP+TN)
(18-11)
其95%置信区间为：
J±1.96SE,
（18-12)
本例J=0.7981-0.0556=0.7425，即Youden指数为0.7425；其标准误为：
SE;=√0.7981(1-0.7981)/520+0.9444(1-0.9444)/180=0.0245
Youden指数的95%置信区间为0.7425±1.96×0.0245，即（0.6945，0.7906）。
Youden指数的取值范围在（0，1）之间，其值越接近于1，诊断准确性越好
五、阳性似然比
真阳性率与假阳性率之比就是阳性似然比（positivelikelihoodratio，LR），
即：
LR=TPR/FPR=Sen/(1-Spe)
(18-13)
其标准误为：
1-SenSpe
SELR=exp
VTPFP
(18-14)
其95%总体LR置信区间为：
[(Sen
-SenSpe
-Sen
Spe
Sen.
±1.96
1.96
或
TP
FP
(1-Spe
TP
FP
1-Spe
(18-15)
本例LR=0.7981/0.0556=14.3654，即阳性似然比为14.3654。其标准误为：
1-0.79810.9444
SELR,=exp
1.3608
415
10
322
兽医统计学
95%总体LR置信区间为：
（0.7981
0.2019
0.9444
exp
ln
±1.96
0.0556
415
10
即（7.8533，26.2773）
LR的取值范围为（0，），其值越大，检测方法证实疾病的能力越强
六、阴性似然比
假阴性率与真阴性率之比，即漏诊率与特异度之比为阴性似然比（negative
likelihoodratio,LR_),即β：
LR_=(1-TPR)/(1-FPR)=(1-Sen)/Spe
(18-16)
其标准误为：
Sen1-Spe
SELR_=exp
VFN
TN
(18-17)
其95%总体LR_置信区间为：
Sen1-Spe
-Sen
Sen
1-Spe
1-Sen
±1.96
±1.96
或
NFNTN
Spe
VFN
TN
Spe
C
(18-18)
本例LR=0.2019/0.9444=0.2138，即阴性似然比为0.2138。其标准误为：
0.7981
0.0556
SELR=exp
=1.0931
105
170
95%总体LR置信区间为：
[1-0.7981
0.79810.0556
exp
±1.96
0.9444
105
170
即（0.1796，0.2546）
LR的取值范围为（0，），其值越小，检测方法排除疾病的能力越好。
第十八章诊断试验评价与ROC分析323
七、阳性预测值
在通常的情况下，当要作出诊断时，并不知道金标准的结果，只知道诊断
试验结果是阳性或阴性。而临床医生更想知道的是当诊断试验结果是阳性时，
受试者真正有病的概率有多大；阴性时又有多大把握排除此病。这就需要引人
阳性预测值（positivepredictivevalue，PV）与阴性预测值的概念。
试验结果是阳性时，受试者实际为病例的概率就是阳性预测值，即：
TP
PV+=P(D+|T+)=
(18-19)
TP+FP
其标准误为：
PV+×(1-PV+)
SEPV
(18-20)
TP+FP
95%置信区间为：
PV,±1.96SEpv+
(18-21)
本例PV=415/425=0.9765，即试验结果为阳性者中，有97.65%为心肌梗死
病人。其标准误为：
SEpv.=√0.9765(1-0.9765)/425=0.0074=0.74%
PV总体的95%置信区间为0.9765±1.96×0.0074，即（0.9621，0.9909）。
八、阴性预测值
当诊断试验结果是阴性时，受试者实际为非病例的概率就是阴性预测值
(negative predictive value，PV_），即：
TN
PV_=P(D_|T-)=
TN+FN
（18-22)
其标准误为：
324兽医统计学
PV_×(1-PV-)
SEPV_=
（18-23)
TN+FN
其95%置信区间为：
PV_±1.96SEpv
（18-24)
本例PV=170/275=0.6182，其标准误为0.0293，95%置信区间为（0.5608，
0.6756)。
PV和PV的取值范围在（0，1）之问；对于相同的患病率，其值越接近1，
检测方法的诊断价值越高。
九、优势比及其有关指标
优势（odds）为两互斥概率之比。
（1）先验优势（pre-testodds）
先验优势=先验概率/（1一先验概率）
（18-25)
这里，先验概率为：
TP+FN
(18-26)
TP+FN+FP+TN
本例的先验概率为0.7429，先验优势为2.8889。
（2）后验优势（post-testodds）
后验优势=先验优势×似然比
（18-27)
本例的后验优势=2.8889×14.3654=41.5000。
（3）后验概率
后验概率=后验优势/（1+后验优势）
(18-28)
（4）优势比
优势比（oddsratio，OR）反映了与非病人相比，病人的阳性优势大小。
第十八章诊断试验评价与ROC分析325
Sen/(1-Sen)TP×TN
LR
OR=
(1-Spe/Spe)FPxFN
LR
（18-29)
其标准误为：
1
SEoR=exp
1
VTPFPTNFN
(18-30)
其95%置信区间为：
(18-31)
ORxe
如果四格表有0格子，则无法计算优势比，这种情况下可将每一格子频数加0.5。
根据上述公式，本例优势比为67.1905，其标准误为1.4095，95%置信区间为
（34.2873，131.6686）。表明出现发热、关节痛者的RBPT诊断结果阳性优势是不
出现发热、关节痛的67倍。
十、Kappa
Kappa统计量用于检查两次及以上观测的一致性程度。在金标准不能达
到诊断准确率为100%的情况下，用该指标检验两个诊断试验结果是否一致。
Kappa值的理论取值在0～1范围内，Kappa值为0~0.4时说明一致性程度不理想；
Kappa值大于等于0.75时说明具有较好的一致性。
Kappa值计算公式为：
对角实际观测一致数之和对角理论期望一致数之和
总例数
总例数
1-PT
总例数
（18-32）
326兽医统计学
其标准误为：
SEKappa=
N3
（18-33)
式中，P、P分别表示实际观察一致率和理论期望一致率，N为总例数，R、C
分别为第类别的行、列合计。
Kappa总体值95%置信区间为：
Kappa ± 1.96SEkappa
（18-34)
本例中Kappa=0.6333，其标准误为0.0360，Kappa总体值95%置信区间为
（0.5627，0.7039）。注意Kappa只能反映诊断结果是否一致，而不一定能反映诊
断结果是否准确。
第二节ROC曲线
尽管前面所列的Youden指数、阳（阴）性似然比、阳（阴）性预测值、优
势比等指标综合利用了灵敏度与特异度的信息，但这些指标都与诊断临界值
（或國值）的选取有关。例如，同一项检测方法，采用不同的诊断临界值就有不
同的灵敏度与特异度。为了更全面地评价检测方法的诊断价值，必须考虑各种
可能的诊断临界值。
ROC曲线（ROCCurve）是接收者工作特征（receiveroperatingcharac
teristic，简称ROC）曲线或相对工作特征（relativeoperatingcharacteristic）曲线
的缩写。R0C分析于20世纪50年代起源于统计决策理论，后来应用于雷达信号
接收能力的评价；自从80年代起，该方法广泛应用于医学诊断试验性能的评价。
通过改变诊断临界值，获得多对灵敏度与特异度值，以灵敏度为横坐标，（1一特
异度）为纵坐标，绘制ROC曲线，计算与比较ROC曲线下面积，以此反映诊断
试验的诊断价值。
第十八章诊断试验评价与ROC分析
327
【例18-3】
假设某诊断系统的病例组和对照组分别有5个和4个受试者，其检测结
果见表18-3。试计算所有可能的TPR和FPR值。（由于样本量太少，这里只
是为了便于叙述）
表18-3假想的连续性资料
金标准
检测结果
病例组
15.90
13.35
12.87
10.22
5.01
对照组
8.29
6.24
4.61
1.77
将这9个数据从大到小排列，以前8个数（不考虑最小值1.77）分别作
为诊断界值，大于等于诊断界值者判为阳性，小于该值者判为阴性。这样，
可整理成8个四格表：
诊断界值=15.90
诊断界值=13.35
诊断界值=12.87
诊断界值=10.22
诊断结果
诊断结果
诊断结果
诊断结果
金标准
金标准
金标准
金标准
1
一
病例组
/
4
病例组
2
3
病例组
3
2
病例组
4
1
对照组
0
对照组
0
4
对照组
0
4
对照组
0
4
诊断界值=8.29
诊断界值=6.24
诊断界值=5.01
诊断界值=4.61
诊断结果
诊断结果
诊断结果
诊断结果
金标准
金标准
金标准
金标准
+
+
一
+
病例组
4
1
病例组
4
1
病例组
5
0
病例组
5
0
对照组
1
3
对照组
2
2
对照组
2
2
对照组
3
1
每个四格表可计算一对（FPR，TPR），称为ROC曲线工作点（见表18-4）。
如果有多个检测结果相同，则只保留一个值作为诊断界值。
328
3兽医统计学
表18-4表18-3资料不同诊断界值的FPR和TPR值
诊断界值
15.90
13.35
12.87
10.22
8.29
6.24
5.01
4.61
FPR
0
0
0
0
1/4
2/4
2/4
3/4
TPR
1/5
2/5
3/5
4/5
4/5
4/5
5/5
5/5
一、ROC曲线的构建
以FPR为横轴，TPR为纵轴，横轴与纵轴长度相等，形成正方形，在图中将
ROC曲线工作点标出，用直线连接各相邻两点构建未光滑的ROC曲线。
ROC曲线一定通过（0，0）和（1，1）两点，这两点分别对应于灵敏度为
0而特异度为1和灵敏度为1而特异度为0的工作点。理论上，完全无价值的诊断
有TPR=FPR，是一条从原点到右上角的对角线，这条线常称为机会线（chance
line）；ROC曲线一般位于机会线的上方，离机会线越远，说明诊断价值越高；
理想的诊断试验在图中表现为ROC曲线从原点垂直上升至左上角，然后水平到
达右上角。图18-2为未光滑的ROC曲线。
TPR1.0
0.8
0.6
0.4
0.2
0.0
0.0
0.2
0.40.6
0.8
1.0FPR
图18-2未光滑ROC曲线
第十八章诊断试验评价与ROC分析329
二、ROC曲线下面积及其标准误的计算
ROC曲线下面积（记为Az）可反映诊断试验的价值大小。这一指标取值范
围为0.5~1，完全无价值的诊断Az=0.5；完全理想的诊断Az=1。一般认为A为
0.50~0.70时，表示诊断价值较低；为0.70~0.90时表示诊断价值为中等：0.90
以上表示诊断价值较高。A及其标准误的计算方法主要有双正态模型参数法、
Hanley和McNeil非参数法、Delong和Clarke-Pearson非参数法等，其中Hanley和
McNeil非参数法计算简单，容易理解。
假设异常组有n个观察值，记为xa（i=1，2，"，na）；正常组有n个观察值，
记为x（j=1，2，，n）；观察值较大为异常。可以证明，ROC曲线下面积（Az）
就是异常组观察值大于正常组观察值的概率，用公式表示为
nannj=li=1
（18-35)
1,
ux<Dx
y（xa,xn,）={0.5,
Xa=Xn;
(0,
（18-36)
Xa<Xn
（18-36）式的意思是：异常组的某个x与正常组的某个x比较，如果前者
大于后者则得分为1，如果相等则得分为0.5，否则得分为0；（18-37）式是将
naxn次比较的得分相加，取平均即得Az（如果观察值较小为异常，则改变公式
中的大于与小于符号即可）
Az的标准误SE可采用公式（18-37）计算。
A(1-Az)+(na-1）（Q1-A²)+(nn-1）（Q2-Az²)
（18-37)
nann
其中，Q是两个随机选择的异常组观察值比一个随机选择的正常组观察值都有
更大可能被判为异常的概率。Q是一个随机选择的异常组观察值比两个随机
330兽医统计学
选择的正常组观察值都有更大可能被判为异常的概率。Q和Q的计算方法见
例18-4。
得出的ROC曲线下面积是否与从原点到右上角的那条机会线有统计学差异，
Az-0.5
可检验H：Az=0.5，统计量为标准正态离差z=
根据Az±ZSE也可
SEAz
计算A的100（1-α）%置信区间。
【例18-4】
对109只羊进行布鲁氏杆菌病的检测，其中有51只异常，58只确诊为正
常。某兽医根据自己经验去判断，详见表18-5。请回答该兽医诊断疫病的
能力。
表18-5羊只检测结果
诊断分类
金标准
合计
肯定异常
可能异常
均可能
可能正常
肯定正常
异常
26
13
7
3
2
51
正常
2
6
9
20
21
58
在SPSS中输入数据，点击：Analyze一ROCCurve，之后会生成ROC曲
线（图18-3），以及曲线下面积等指标（表18-6）
1.0-
0.8-
0.6
nsitiv
0.2-
0.0
0.0
0.2
0.4
0.6
1-Specificity
图18-3ROC曲线
第十八章诊断试验评价与ROC分析331
表18-6ROC曲线下面积等有关指标
面积
标准误
P值
渐近95%置信区间
下限
上限
0.880
0.034
0.000
0.814
0.947
结果显示，ROC曲线下面积为0.880，表示诊断准确度较好。相应的标
准误为0.034，P<0.001，95%置信区间为（0.814，0.947）。
名词术语
观察单位（observedunit）：也称研究单位（studyunit），是统计研究中最基
本的单位，可以是一个人，一头动物，也可以是某一特定的动物群体；还可以
是一个器官、一个细胞、一个采样点等。
总体（population）：是根据研究目的而确定的同质观察单位的全体，也就
是性质相同的研究对象中所有观察单位某种变量值的集合。
样本（sample）：从总体中随机抽得的部分观察单位。
变量（variable）：能表现观察单位的变异性的特征。
定量资料（quantitativedata）：又称定量资料（measurementdata）或数值变
量资料（numericalvariable），为测定每个观察单位某项指标的大小而获得的资
料。其变量值是定量的，表现为数值大小，一般有度量衡单位。
定性资料（qualitativedata）：又称定性资料或无序分类变量资料。为将观
擦单位按某种属性或类别分组计数，分组汇总各组观察单位数后而得到的资料。
其变量值是定性的，表现为互不相容的属性或类别，如试验结果的阳性阴性，
某症状的有无等。
等级资料（rankeddata）：又称半定量资料或有序分类变量资料。为将观察
单位按某种属性的不同程度分成等级后分组计数，分类汇总各组观察单位数后
而得到的资料。
随机误差（randomerror）：是一类由多种无法控制的因素引起的、不恒定
的、随机变化的误差。
系统误差（systematicerror）：是实验过程中产生的误差，它的值恒定不变，
或遵循一定的变化规律，其产生原因往往是可知的或可能掌握的。
参数（parameter）：统计学中把总体的指标称为参数。
统计量（statistic）：由观察资料计算出来的量。
患病率（prevalencerate）：指某个时间内的特定病种的新、老病例数（不包
括此时间前已经死亡或者痊愈的个体数）与同时期段内群体的平均数之比。
名词术语333
发病率（incidencerate）：表示在一定时期内某畜群中发生新病例的频率。
累计发病率（cumulativeincidence）：是指观察期开始时，无病的个体在观
察期内变为有病个体的比例。
權患率（attackrate）：与发病率均用来表示群体中在一定时期内新病例的
发生频率，是用以度量动物群体中较短时期内发生新病例频数的指标。
死亡率（mortalityrate）：是指某动物群体在一定时间内死亡总数和该群体
同期动物平均数之比。
病死率（fatalityrate）：表示一定时期内患某病的动物因病死亡的频率。
参考值范围（referencerange）：又称临床参考值范围或正常参考值范围等，
是指绝大多数正常动物的各种生理生化指标或者组织、排泄物中各种成分的含
量和各种组织、器官解剖指标等的范围。
抽样误差（samplingerror）：由于总体中个体变异的存在，从某一总体中随
机抽取一个样本，所得样本统计量与相应的总体参数往往是不同的，这种差异
称为抽样误差。
置信区间（confidencebound/confidenceinterval，CI）：又称置信区间，区
间估计是按预先给定的概率（1一α），确定包含未知总体参数的一个数量范围，
该范围称为参数的置信区间。
P值：给出原假设后，在假定原假设正确的情况下，利用样本数据，可以
计算出检验统计量，以及其对应的概率，这个概率使是P值。
I类错误（typeIerror）：统计学上将这种拒绝了正确的零假设H。（弃真）
的错误称为1类错误。
I类错误（typeⅡerror）：由样本数据计算获得的检验统计量得出不拒绝
H。（纳伪）的结论，就犯了Ⅱ类错误。
决定系数（coefficientofdetermination）：回归平方和占总离均差平方和的
比例，用以反映线性回归模型能在多大程度上解释应变量y的变异。
复相关系数（multiplecorrelationcoefficient）：表示p个自变量共同对应变量
线性相关的密切程度。
金标准（GoldStandard）：金标准是绝对准确的试验或者是假设绝对准确的
334兽医统计学
实验。
正确率（accuracy）：是病例正确诊断为阳性，且对照正确诊断为阴性的
比例。
灵敏度（sensitivity，Sen）：是金标准确诊的真实患者，被试验诊断为阳性
的概率，也称为真阳性率（TruePositiveRate，TPR）。
特异度（specificity，Spe）：是金标准确诊的真实非病例，被试验诊断为阴
性的概率。
Youden指数（Youden'sindex）：真阳性率与假阳性率之差。
阳性似然比（positivelikelihoodratio，LR，）：真阳性率与假阳性率之比。
阴性似然比（negativelikelihoodratio，LR_）：假阴性率与真阴性率之比。
阳性预测值（positivepredictivevalue，PV，）：试验结果是阳性时，受试者
实际为病例的概率。
阴性预测值（negativepredictivevalue，PV_）：当诊断试验结果是阴性时，
受试者实际为非病例的概率。
ROC曲线（ROCcurve）：接收者工作特征（receiveroperatingcharact-
eristic，简称ROC）曲线或相对工作特征（relativeoperatingcharacteristic）曲线的
缩写，以灵敏度为横坐标，（1一特异度）为纵坐标，绘制ROC曲线，计算与比
较ROC曲线下面积，以此反映诊断试验的诊断价值。
参考文献
伯纳德·罗斯纳.2005.生物统计学基础[M]孙尚拱，译.北京：科学
出版社.
陈娇.2013.狂犬病预防知识传播的方式与“知沟”效果研究一—基于广
西基隆的实验[C1：广西大学
陈平雁，2012.IBMSPSS19.0统计软件应用教程[M].北京：人民卫生
出版社.
德克·菲弗.2015.兽医流行病学概论[M].刘晓文，译.北京：中国农
业出版社
窦莲升.1979.应用正态分布特性对数量性状进行选种[J].中国畜牧兽
医杂志，5：3-7.
方积乾.2008.卫生统计学[M].北京：人民卫生出版社
方积乾.2012.卫生统计学[M].2版.北京：人民卫生出版社
方积乾.2002.现代医学统计学[M]：北京：人民卫生出版社
何艳频，孙爱峰.2007.Spearman登记相关系数计算公式及其相互关系的探讨
[J]中国现代药物应用，10：72-73
黄保续.2010.兽医流行病学[M]北京：中国农业出版社
黄守婷，何桂娟，王景伟，等，2013.非参数检验在畜牧生产中的应用及
其SPSS实现[J].安徽农业科学，41（27）：10909-10910
金不焕.2003.医用统计方法[M]北京：人民卫生出版社
李立明，叶冬青，詹思延，2011.流行病学[M]北京：人民卫生出版社
刘明廷，张建涛，祝玉卿，等.2012.健康家猫动脉血气分析正常参考值
测定[J].黑龙江畜牧兽医科技版，3（上）：147-148.
刘秀梵.1993.兽医流行病学原理[M]，北京：中国农业出版社
卢纹岱.2006.SPSSforWindows统计分析[M].北京：电子工业出版社
罗家洪，郭秀花.2011.医学统计学（案例版）[M].2版.北京：科学出
336兽医统计学
版社.
吕敏芝.2007.MSExcel在畜牧兽医统计中的应用（三）一一直线回归和
直线相关分析[J」.广东畜牧兽医科技，32（1）：27-29
吕敏芝.2007.MSExcel在畜牧兽医统计中的应用（五）一一多元线性回
归分析[J].广东畜牧兽医科技，03：16，28
吕敏芝，2007.MSExcel在畜牧兽医统计中的应用（六）一拟合直线及
常用曲线[J].广东畜牧兽医科技，32（4）：13-15
吕敏芝.2007.MSExcel在畜牧兽医统计中的应用（七）一常用概率分
布的概率计算[J].广东畜牧兽医科技，32（5）：13-15
倪大新，胡晓抒，刘光中，等，2001.猪链球菌感染性综合征流行因素病
例对照研究[J].中国人兽共患病杂志，17（2）：98-99
牛锋，张绳祖.1996.主成分分析在家畜疫病生态学中的应用J」中国
兽医科技，10
沙马黑则，敖学成，徐正刚，等.2010.应用因子分析对昭觉县畜牧业现
状的评价分析[J].草业与畜牧，06
上海市农业学校.1989.生物统计与畜牧兽医试验[M].10版.北京：中
国农业出版社
孙景林，徐长利.2010.奶牛酮病的实验室诊断及防治J」.养殖技术顾
问，05：122
孙向东，刘拥军，王幼明.2011.兽医流行病学调查与监测一抽样设计
[M]北京：中国农业出版社
孙振球，徐勇勇.2010.医学统计学[M1北京：人民卫生出版社
孙振球，徐勇勇.2012.医学统计学[M]3版.北京：人民卫生出版社
孙振球.2002.医学统计学[M]：北京：人民卫生出版社
汪海波.2013.SAS统计分析与应用[M]北京：人民邮电出版社
王洪斌，王统石.1995，犬动静脉血气和酸碱值的比较［J」中国兽医科
技，25（3）:23-24
王燕.2012.应用时间序列分析[M]3版.北京：中国人民大学出版社
参考文献337
夏志，刘小林，郭家中，等，2010.奶牛乳房炎对奶牛血清若干生化指标
的影响[J].中国乳品工业，07：32-34，64.
谢庄，贾青.2005.兽医统计学M」.北京：高等教育出版社
游士兵、2010.统计学[M].武汉：武汉大学出版社
于相业.1984.畜牧业常用的生物统计方法[J]青海畜牧兽医杂志，3：46.
于相业.1985.畜牧业常用的生物统计方法[J].青海畜牧兽医杂志，1：
76-78.
于相业.1986.兽医卡方检验与相对数分析（一）[J].青海畜牧兽医杂志，
3:018.
宇传华.2007.SPSS与统计分析[M].北京：电子工业出版社
宇传华.2014.SPSS与统计分析[M].2版.北京：电子工业出版社
袁加军.2009.Excel在非参数检验中的应用[J].中国校外教育，3
赵耐青，陈锋.2008.卫生统计学[M]北京：高等教育出版社
AvivaPetri,Paul Watson.2013.Statistics forVeterinary and Animal Science
[M].Chichester,London:John Wiley&Sons,Ltd
MichaelThrusfield.2007.VeterinaryEpidemiologyM].3rded.London
Blackwell publishing.
欢迎登陆：中国农业出版社网站
www.ccap.com.cn
兽医统计学
SHOUYI TONGJI XUE
定价：65.00元